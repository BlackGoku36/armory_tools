!function(t,e){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{},t.kha._Color=t.kha._Color||{};var i,s={},n=function(){return y.__string_rec(this,"")},b=b||{};function r(t,e){var i=Object.create(t);for(var s in e)i[s]=e[s];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}var it=function(t){if(this.lastCanvasH=0,this.lastCanvasW=0,this.lastH=0,this.lastW=0,this.hwin=Oe.global.nest(0,null),this.selectedElem=null,this.selectedFrame=0,this.gridSize=20,this.gridSnapPos=!0,this.gridSnapBounds=!1,this.filesDone=null,this.foldersOnly=!1,this.showFiles=!1,this.zoom=1,this.resizeCanvas=!1,this.dragAsset=null,this.assetNames=[""],this.dragBottom=!1,this.dragRight=!1,this.dragTop=!1,this.dragLeft=!1,this.drag=!1,this.dropPath="",0<(this.canvas=t).assets.length){var e=t.assets;t.assets=[];for(var i=0;i<e.length;){var s=e[i];++i,this.importAsset(s.file)}}ft.loadEverything(Ge(this,this.loaded))};(s.Elements=it).__name__=!0,it.get_uiw=function(){return it.windowW*nt.prefs.scaleFactor|0},it.toRelative=function(t,e){t=g.normalize(t),e=g.normalize(e);for(var i=[],s=t.split("/"),n=e.split("/"),r=0;s[r]==n[r];)++r;for(var a=0,o=n.length-r;a<o;){a++;i.push("..")}for(var l=r,h=s.length;l<h;){var u=l++;i.push(s[u])}return i.join("/")},it.toAbsolute=function(t,e){return g.normalize(e+"/"+t)},it.prototype={ui:null,cui:null,canvas:null,get_toolbarw:function(){return 60*this.ui.SCALE|0},dropPath:null,drag:null,dragLeft:null,dragTop:null,dragRight:null,dragBottom:null,assetNames:null,dragAsset:null,resizeCanvas:null,zoom:null,showFiles:null,foldersOnly:null,filesDone:null,uimodal:null,gridSnapBounds:null,gridSnapPos:null,gridSize:null,selectedFrame:null,selectedElem:null,hwin:null,lastW:null,lastH:null,lastCanvasW:null,lastCanvasH:null,loaded:function(){var e=this,t=Z.copy(We.dark);t.FILL_WINDOW_BG=!0,this.ui=new He({scaleFactor:nt.prefs.scaleFactor,font:ft.fonts.font_default,theme:t,color_wheel:ft.images.color_wheel}),this.cui=new He({scaleFactor:1,font:ft.fonts.font_default,autoNotifyInput:!0,theme:We.light}),this.uimodal=new He({font:ft.fonts.font_default,scaleFactor:nt.prefs.scaleFactor}),gt.notifyOnDropFiles(function(t){e.dropPath=at.rtrim(t),e.dropPath=it.toRelative(e.dropPath,nt.cwd)}),gt.notifyOnFrames(Ge(this,this.onFrames)),P.addTimeTask(Ge(this,this.update),0,.016666666666666666)},importAsset:function(r){var a=this,t=at.endsWith(r,".jpg")||at.endsWith(r,".png")||at.endsWith(r,".k")||at.endsWith(r,".hdr"),e=at.endsWith(r,".ttf"),i=it.toAbsolute(r,nt.cwd);i="Windows"==gt.get_systemId()?at.replace(i,"/","\\"):i,t?ft.loadImageFromPath(i,!1,function(t){var e=r.split("/"),i=e[e.length-1],s=Me.getAssetId(a.canvas),n={name:i,file:r,id:s};a.canvas.assets.push(n),Me.assetMap.h[n.id]=t,a.assetNames.push(i),a.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:123,className:"Elements",methodName:"importAsset"}):e&&ft.loadFontFromPath(i,function(t){var e=r.split("/"),i=e[e.length-1],s=Me.getAssetId(a.canvas),n={name:i,file:r,id:s};a.canvas.assets.push(n),Me.assetMap.h[n.id]=t,a.assetNames.push(i),a.hwin.redraws=2},null,{fileName:"Elements.hx",lineNumber:135,className:"Elements",methodName:"importAsset"})},unique:function(t){return t},makeElem:function(t){var e="",i=this.cui.t.ELEMENT_H;switch(t){case 0:e=this.unique("Text");break;case 1:e=this.unique("Image"),i=100;break;case 2:e=this.unique("Button");break;case 3:e=this.unique("Empty"),i=100;break;case 6:e=this.unique("Check");break;case 7:e=this.unique("Radio");break;case 8:e=this.unique("Combo");break;case 9:e=this.unique("Shape"),i=100;break;case 10:e=this.unique("Slider");break;case 11:e=this.unique("Input")}var s={id:Me.getElementId(this.canvas),type:t,name:e,event:"",x:0,y:0,width:150,height:i,rotation:0,text:"My "+e,asset:"",color:-1,anchor:0,parent:null,children:[],visible:!0};return this.canvas.elements.push(s),s},unparent:function(t){var e=this.elemById(t.parent);null!=e&&(t.x+=this.absx(e),t.y+=this.absy(e),t.parent=null,st.remove(e.children,t.id))},setParent:function(t,e){this.elemById(t.parent)!=e&&(this.unparent(t),null!=e&&(null==e.children&&(t.children=[]),e.children.push(t.id),t.parent=e.id,t.x-=this.absx(e),t.y-=this.absy(e)))},duplicateElem:function(t,e){if(null!=t){null==e&&(e=t.parent);var i={id:Me.getElementId(this.canvas),type:t.type,name:t.name,event:t.event,x:t.x+10,y:t.y+10,width:t.width,height:t.height,rotation:t.rotation,text:t.text,asset:t.asset,color:t.color,anchor:t.anchor,parent:e,children:[],visible:t.visible};if(this.canvas.elements.push(i),null!=e)this.elemById(e).children.push(i.id),t.parent!=e&&(i.x=t.x,i.y=t.y);for(var s=0,n=t.children;s<n.length;){var r=n[s];++s,this.duplicateElem(this.elemById(r),i.id)}return i}return null},getEnumTexts:function(){return 0<this.assetNames.length?this.assetNames:[""]},getAssetIndex:function(t){for(var e=0,i=this.canvas.assets.length;e<i;){var s=e++;if(t==this.canvas.assets[s].name)return s+1}return 0},resize:function(){null!=it.grid&&(it.grid.unload(),it.grid=null),null!=it.timeline&&(it.timeline.unload(),it.timeline=null)},drawGrid:function(){var t=2*this.gridSize,e=gt.windowWidth()+2*t,i=gt.windowHeight()+2*t;(it.grid=T.createRenderTarget(e,i)).get_g2().begin(!0,-14408668);for(var s=0,n=1+(i/t|0);s<n;){var r=s++;it.grid.get_g2().set_color(-14145496),it.grid.get_g2().drawLine(0,r*t,e,r*t),it.grid.get_g2().set_color(-13487566),it.grid.get_g2().drawLine(0,r*t+this.gridSize,e,r*t+this.gridSize)}for(var a=0,o=1+(e/t|0);a<o;){var l=a++;it.grid.get_g2().set_color(-14145496),it.grid.get_g2().drawLine(l*t,0,l*t,i),it.grid.get_g2().set_color(-13487566),it.grid.get_g2().drawLine(l*t+this.gridSize,0,l*t+this.gridSize,i)}it.grid.get_g2().end()},drawTimeline:function(){var t=this.ui.SCALE,e=(it.timeline=T.createRenderTarget(gt.windowWidth()-it.get_uiw()-this.get_toolbarw(),60*t|0)).get_g2();e.begin(!0,-14540254),e.set_font(ft.fonts.font_default),e.set_fontSize(16*t|0);for(var i=it.timeline.get_width()/(11*t)|0,s=0,n=1+(i/5|0);s<n;){var r=s++;e.drawString(5*r+"",55*r*t,0)}for(var a=0,o=i;a<o;){var l=a++;e.set_color(l%5==0?-12303292:-13421773),e.fillRect(11*l*t,30*t,10*t,30*t)}e.end()},onFrames:function(t){var o=this,e=t[0];""!=this.dropPath&&(this.importAsset(this.dropPath),this.dropPath=""),null==it.grid&&this.drawGrid(),null==it.timeline&&this.drawTimeline();var i=e.get_g2();if(i.begin(),i.set_color(-1),i.drawImage(it.grid,it.coffX%40-40,it.coffY%40-40),this.canvas.x=it.coffX,this.canvas.y=it.coffY,i.drawRect(this.canvas.x,this.canvas.y,this.canvas.width*this.cui.SCALE|0,this.canvas.height*this.cui.SCALE|0,1),i.drawRect(this.canvas.x+(this.canvas.width*this.cui.SCALE|0)-3,this.canvas.y+(this.canvas.height*this.cui.SCALE|0)-3,6,6,1),Me.screenW=this.canvas.width,Me.screenH=this.canvas.height,Me.draw(this.cui,this.canvas,i),null!=this.selectedElem){i.set_color(-1);var s=this.absx(this.selectedElem)*this.cui.SCALE|0,n=this.absy(this.selectedElem)*this.cui.SCALE|0,r=this.selectedElem.width*this.cui.SCALE|0,a=this.selectedElem.height*this.cui.SCALE|0;i.drawRect(this.canvas.x+s,this.canvas.y+n,r,a),i.drawRect(this.canvas.x+s-3,this.canvas.y+n-3,6,6),i.drawRect(this.canvas.x+s-3+r/2,this.canvas.y+n-3,6,6),i.drawRect(this.canvas.x+s-3+r,this.canvas.y+n-3,6,6),i.drawRect(this.canvas.x+s-3,this.canvas.y+n-3+a/2,6,6),i.drawRect(this.canvas.x+s-3+r,this.canvas.y+n-3+a/2,6,6),i.drawRect(this.canvas.x+s-3,this.canvas.y+n-3+a,6,6),i.drawRect(this.canvas.x+s-3+r/2,this.canvas.y+n-3+a,6,6),i.drawRect(this.canvas.x+s-3+r,this.canvas.y+n-3+a,6,6)}i.set_color(-1);var l=gt.windowHeight()-it.timeline.get_height();i.drawImage(it.timeline,this.get_toolbarw(),l),i.set_color(-14656100);var h=this.ui.SCALE;if(i.fillRect(this.get_toolbarw()+11*this.selectedFrame*h,l+30*h,10*h,30*h),i.end(),this.ui.begin(i),this.ui.window(Oe.global.nest(1,null),0,0,this.get_toolbarw(),gt.windowHeight())&&this.ui.tab(Oe.global.nest(2,null),"Tools")&&(this.ui._y=50,this.ui.button("Empty")&&(this.selectedElem=this.makeElem(3)),this.ui.button("Text")&&(this.selectedElem=this.makeElem(0)),this.ui.button("Shape")&&(this.selectedElem=this.makeElem(9)),this.ui.button("Image")&&(this.selectedElem=this.makeElem(1)),this.ui.button("Button")&&(this.selectedElem=this.makeElem(2)),this.ui.button("Check")&&(this.selectedElem=this.makeElem(6)),this.ui.button("Radio")&&(this.selectedElem=this.makeElem(7)),this.ui.button("Combo")&&(this.selectedElem=this.makeElem(8)),this.ui.button("Slider")&&(this.selectedElem=this.makeElem(10)),this.ui.button("Input")&&(this.selectedElem=this.makeElem(11))),this.ui.window(Oe.global.nest(3,null),this.get_toolbarw(),0,gt.windowWidth()-it.get_uiw()-this.get_toolbarw(),(this.ui.t.ELEMENT_H+2)*this.ui.SCALE|0)&&this.ui.tab(Oe.global.nest(4,null),this.canvas.name),this.ui.window(this.hwin,gt.windowWidth()-it.get_uiw(),0,it.get_uiw(),gt.windowHeight())){var u=Oe.global.nest(5,null);if(this.ui.tab(u,"Project")){if(this.ui.button("Save")){this.canvas.x=0,this.canvas.y=0,Krom.fileSaveBytes(nt.prefs.path,ut.ofString(JSON.stringify(this.canvas)).b.bufferValue);var c=st.substr(nt.prefs.path,0,nt.prefs.path.length-5);c+=".files";for(var d="",_=0,f=this.canvas.assets;_<f.length;){var g=f[_];++_,d+=g.file+"\n"}Krom.fileSaveBytes(c,ut.ofString(d).b.bufferValue),this.canvas.x=it.coffX,this.canvas.y=it.coffY}if(this.ui.panel(Oe.global.nest(6,{selected:!1}),"Canvas")){this.ui.button("New")&&(this.canvas.elements=[],this.selectedElem=null);var p=this.ui,v=Oe.global.nest(7,{text:this.canvas.name});this.canvas.name=p.textInput(v,"Name",2),this.ui.row([.5,.5]);var m=Oe.global.nest(8,{text:this.canvas.width+""}),w=Oe.global.nest(9,{text:this.canvas.height+""});m.text=this.canvas.width+"",w.text=this.canvas.height+"";var b=this.ui.textInput(m,"Width",2),S=this.ui.textInput(w,"Height",2);this.canvas.width=rt.parseInt(b),this.canvas.height=rt.parseInt(S)}if(this.ui.panel(Oe.global.nest(10,{selected:!0}),"Outliner")){var y=null;y=function(t,e){var i=!1;o.selectedElem==e&&(o.ui.g.set_color(-14656100),o.ui.g.fillRect(0,o.ui._y,o.ui._windowW,o.ui.t.ELEMENT_H*o.ui.SCALE),o.ui.g.set_color(-1));var s=o.ui.getStarted();if(s&&!o.ui.inputDownR&&(o.selectedElem=e),s&&o.ui.inputDownR&&(e==o.selectedElem?o.unparent(e):o.setParent(o.selectedElem,e)),null!=e.children&&0<e.children.length?(o.ui.row([.07692307692307693,.9230769230769231]),i=o.ui.panel(t.nest(e.id,{selected:!0}),"",0,!0),o.ui.text(e.name)):(o.ui._x+=18,o.ui.text(e.name),o.ui._x-=18),i)for(var n=e.children.length;0<n;){--n;var r=e.children[e.children.length-1-n];o.ui.indent();var a=o.elemById(r);y(t,a),o.ui.unindent()}};for(var x=0,E=this.canvas.elements.length;x<E;){var C=x++,k=this.canvas.elements[this.canvas.elements.length-1-C];if(null==k.parent){var T=Oe.global.nest(11,null);y(T,k)}}this.ui.row([.25,.25,.25,.25]);this.canvas.elements;this.ui.button("Up")&&null!=this.selectedElem&&this.moveElem(1),this.ui.button("Down")&&null!=this.selectedElem&&this.moveElem(-1),this.ui.button("Remove")&&null!=this.selectedElem&&this.removeSelectedElem(),this.ui.button("Duplicate")&&null!=this.selectedElem&&(this.selectedElem=this.duplicateElem(this.selectedElem))}if(null!=this.selectedElem){var L=this.selectedElem,B=L.id;if(this.ui.panel(Oe.global.nest(12,{selected:!0}),"Properties")){var I=null==L.visible||L.visible;L.visible=this.ui.check(Oe.global.nest(13,null).nest(B,{selected:I}),"Visible"),L.name=this.ui.textInput(Oe.global.nest(14,null).nest(B,{text:L.name}),"Name",2),L.text=this.ui.textInput(Oe.global.nest(15,null).nest(B,{text:L.text}),"Text",2),this.ui.row([.25,.25,.25,.25]);var N=L.x+"",A=Oe.global.nest(16,null).nest(B,{text:N}),R=L.y+"",P=Oe.global.nest(17,null).nest(B,{text:R});A.text=L.x+"",P.text=L.y+"";var V=this.ui.textInput(A,"X",2),D=this.ui.textInput(P,"Y",2);L.x=parseFloat(V),L.y=parseFloat(D);var O=L.width+"",M=Oe.global.nest(18,null).nest(B,{text:O}),F=L.height+"",W=Oe.global.nest(19,null).nest(B,{text:F});M.text=L.width+"",W.text=L.height+"";var H=this.ui.textInput(M,"W",2),U=this.ui.textInput(W,"H",2);L.width=0|parseFloat(H),L.height=0|parseFloat(U);var G=null==L.rotation?0:L.rotation,X=Oe.global.nest(20,null).nest(B,{value:57.29578*G});L.rotation=.0174532924*this.ui.slider(X,"Rotation",0,360,!0);var Y=this.ui.combo(Oe.global.nest(21,null).nest(B,{position:this.getAssetIndex(L.asset)}),this.getEnumTexts(),"Asset",!0,2);L.asset=this.getEnumTexts()[Y],L.color=Fe.colorWheel(this.ui,Oe.global.nest(22,null).nest(B,{color:L.color}),!0,null,!0)}this.ui.panel(Oe.global.nest(23,{selected:!1}),"Align");if(this.ui.panel(Oe.global.nest(24,{selected:!1}),"Anchor")){var z=Oe.global.nest(25,null).nest(B,{position:L.anchor});this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(z,0,"Top-Left"),this.ui.radio(z,1,"Top"),this.ui.radio(z,2,"Top-Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(z,3,"Left"),this.ui.radio(z,4,"Center"),this.ui.radio(z,5,"Right"),this.ui.row([.36363636363636365,.2727272727272727,.36363636363636365]),this.ui.radio(z,6,"Bot-Left"),this.ui.radio(z,7,"Bottom"),this.ui.radio(z,8,"Bot-Right"),L.anchor=z.position}this.ui.panel(Oe.global.nest(26,{selected:!1}),"Script")&&(L.event=this.ui.textInput(Oe.global.nest(27,null).nest(B,{text:L.event}),"Event",2));this.ui.panel(Oe.global.nest(28,{selected:!1}),"Timeline")}}if(this.ui.tab(u,"Assets"))if(this.ui.button("Import Asset")&&(this.showFiles=!0,this.foldersOnly=!1,this.filesDone=function(t){t=at.rtrim(t),t=it.toRelative(t,nt.cwd),o.importAsset(t)}),0<this.canvas.assets.length){this.ui.text("(Drag and drop assets to canvas)",1);for(var Z=this.canvas.assets.length-1;0<=Z;){var K=this.canvas.assets[Z];at.endsWith(K.name,".ttf")||1!=this.ui.image(this.getImage(K))||(this.dragAsset=K),this.ui.row([.875,.125]),K.name=this.ui.textInput(Oe.global.nest(29,null).nest(K.id,{text:K.name}),"",2),this.assetNames[Z+1]=K.name,this.ui.button("X")&&(this.getImage(K).unload(),this.canvas.assets.splice(Z,1),this.assetNames.splice(Z+1,1)),--Z}}else this.ui.text("(Drag and drop images and fonts here)",1);if(this.ui.tab(u,"Preferences")){var j=Oe.global.nest(30,{value:1});this.ui.slider(j,"UI Scale",.5,4,!0);var J=Oe.global.nest(31,{value:20});this.ui.slider(J,"Grid Size",1,128,!0,1),this.gridSnapPos=this.ui.check(Oe.global.nest(32,{selected:!0}),"Grid Snap Position"),this.gridSnapBounds=this.ui.check(Oe.global.nest(33,{selected:!1}),"Grid Snap Bounds"),this.ui.changed&&!this.ui.inputDown&&(this.gridSize=0|J.value,this.ui.setScale(j.value),it.windowW=it.defaultWindowW*j.value|0);var Q=this.ui,q=Oe.global.nest(34,{selected:!0});nt.prefs.window_vsync=Q.check(q,"VSync");this.ui.panel(Oe.global.nest(35,{selected:!0}),"Console")}}if(this.ui.end(),this.ui.changed&&!this.ui.inputDown&&this.drawGrid(),i.begin(!1),null!=this.dragAsset){var $=Math.min(128,this.getImage(this.dragAsset).get_width()),tt=$/this.getImage(this.dragAsset).get_width(),et=this.getImage(this.dragAsset).get_height()*tt;i.drawScaledImage(this.getImage(this.dragAsset),this.ui.inputX,this.ui.inputY,$,et)}i.end(),0<this.lastW&&(this.lastW!=gt.windowWidth()||this.lastH!=gt.windowHeight())?this.resize():0<this.lastCanvasW&&(this.lastCanvasW!=this.canvas.width||this.lastCanvasH!=this.canvas.height)&&this.resize(),this.lastW=gt.windowWidth(),this.lastH=gt.windowHeight(),this.lastCanvasW=this.canvas.width,this.lastCanvasH=this.canvas.height,this.showFiles&&this.renderFiles(i)},elemById:function(t){for(var e=0,i=this.canvas.elements;e<i.length;){var s=i[e];if(++e,s.id==t)return s}return null},moveElem:function(t){for(var e=this.canvas.elements,i=e.indexOf(this.selectedElem),s=this.selectedElem.parent;!((i+=t)<0||i>=e.length);)if(e[i].parent==s){st.remove(e,this.selectedElem),e.splice(i,0,this.selectedElem);break}},getImage:function(t){return Me.assetMap.h[t.id]},removeElem:function(t){if(null!=t.children)for(var e=0,i=t.children;e<i.length;){var s=i[e];++e,this.removeElem(this.elemById(s))}st.remove(this.canvas.elements,t),null!=t.parent&&(st.remove(this.elemById(t.parent).children,t.id),t.parent=null)},removeSelectedElem:function(){this.removeElem(this.selectedElem),this.selectedElem=null},acceptDrag:function(t){var e=this.makeElem(1);e.asset=this.assetNames[t+1],e.x=this.ui.inputX-this.canvas.x,e.y=this.ui.inputY-this.canvas.y,e.width=this.getImage(this.canvas.assets[t]).get_width(),e.height=this.getImage(this.canvas.assets[t]).get_height(),this.selectedElem=e},hitbox:function(t,e,i,s){return this.ui.inputX>t&&this.ui.inputX<t+i&&this.ui.inputY>e&&this.ui.inputY<e+s},update:function(){if(this.ui.inputReleased&&null!=this.dragAsset){if(this.ui.inputX<gt.windowWidth()-it.get_uiw()){for(var t=0,e=0,i=this.canvas.assets.length;e<i;){var s=e++;if(this.canvas.assets[s]==this.dragAsset){t=s;break}}this.acceptDrag(t)}this.dragAsset=null}if(null==this.dragAsset){if(this.updateCanvas(),null!=it.timeline){var n=gt.windowHeight()-it.timeline.get_height();this.ui.inputDown&&this.ui.inputY>n&&this.ui.inputX<gt.windowWidth()-it.get_uiw()&&this.ui.inputX>this.get_toolbarw()&&(this.selectedFrame=(this.ui.inputX-this.get_toolbarw())/11/this.ui.SCALE|0)}if(null!=this.selectedElem){var r=this.selectedElem,a=this.absx(r)*this.cui.SCALE|0,o=this.absy(r)*this.cui.SCALE|0,l=r.width*this.cui.SCALE|0,h=r.height*this.cui.SCALE|0;this.ui.inputStarted&&this.ui.inputDown&&this.hitbox(this.canvas.x+a-4,this.canvas.y+o-4,l+4,h+4)&&(this.drag=!0,this.dragLeft=this.dragRight=this.dragTop=this.dragBottom=!1,this.ui.inputX>this.canvas.x+a+l-4?this.dragRight=!0:this.ui.inputX<this.canvas.x+a+4&&(this.dragLeft=!0),this.ui.inputY>this.canvas.y+o+h-4?this.dragBottom=!0:this.ui.inputY<this.canvas.y+o+4&&(this.dragTop=!0)),this.ui.inputReleased&&this.drag&&(this.drag=!1,this.gridSnapBounds&&(r.width=Math.round(r.width/this.gridSize)*this.gridSize,r.height=Math.round(r.height/this.gridSize)*this.gridSize),this.gridSnapPos&&(r.x=Math.round(r.x/this.gridSize)*this.gridSize,r.y=Math.round(r.y/this.gridSize)*this.gridSize)),this.drag&&(this.hwin.redraws=2,this.dragRight?r.width+=0|this.ui.inputDX:this.dragLeft&&(r.x+=0|this.ui.inputDX,r.width-=0|this.ui.inputDX),this.dragBottom?r.height+=0|this.ui.inputDY:this.dragTop&&(r.y+=0|this.ui.inputDY,r.height-=0|this.ui.inputDY),1!=r.type&&(r.width<1&&(r.width=1),r.height<1&&(r.height=1)),this.dragLeft||this.dragRight||this.dragBottom||this.dragTop||(r.x+=this.ui.inputDX,r.y+=this.ui.inputDY)),this.ui.isKeyDown&&!this.ui.isTyping&&(37==this.ui.key&&(this.gridSnapPos?r.x-=this.gridSize:r.x--),39==this.ui.key&&(this.gridSnapPos?r.x+=this.gridSize:r.x++),38==this.ui.key&&(this.gridSnapPos?r.y-=this.gridSize:r.y--),40==this.ui.key&&(this.gridSnapPos?r.y+=this.gridSize:r.y++),8!=this.ui.key&&"x"!=this.ui.char&&46!=this.ui.key||this.removeSelectedElem(),68==this.ui.key&&(this.selectedElem=this.duplicateElem(r)),this.hwin.redraws=2)}this.updateFiles()}},updateCanvas:function(){if(!(this.showFiles||this.ui.inputX>gt.windowWidth()-it.get_uiw())){if(this.ui.inputStarted&&this.ui.inputDownR){this.canvas.elements.length;for(var t=0,e=this.canvas.elements;t<e.length;){var i=e[t];++t;var s=this.absx(i)*this.cui.SCALE|0,n=this.absy(i)*this.cui.SCALE|0,r=i.width*this.cui.SCALE|0,a=i.height*this.cui.SCALE|0;if(this.hitbox(this.canvas.x+s,this.canvas.y+n,r,a)&&this.selectedElem!=i){this.selectedElem=i;break}}}this.ui.inputDownR&&(it.coffX+=0|this.ui.inputDX,it.coffY+=0|this.ui.inputDY),0!=this.ui.inputWheelDelta&&(this.zoom+=-this.ui.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.cui.SCALE=this.cui.ops.scaleFactor*this.zoom),this.ui.inputStarted&&this.hitbox(this.canvas.x+(this.canvas.width*this.cui.SCALE|0)-3,this.canvas.y+(this.canvas.height*this.cui.SCALE|0)-3,6,6)&&(this.resizeCanvas=!0),this.ui.inputReleased&&this.resizeCanvas&&(this.resizeCanvas=!1),this.resizeCanvas&&(this.canvas.width+=0|this.ui.inputDX,this.canvas.height+=0|this.ui.inputDY,this.canvas.width<1&&(this.canvas.width=1),this.canvas.height<1&&(this.canvas.height=1))}},updateFiles:function(){if(this.showFiles&&this.ui.inputReleased){var t=gt.windowWidth(),e=gt.windowHeight(),i=t/2-it.modalRectW/2,s=t/2+it.modalRectW/2,n=e/2-it.modalRectH/2,r=e/2+it.modalRectH/2;(this.ui.inputX<i||this.ui.inputX>s||this.ui.inputY<n+it.modalHeaderH||this.ui.inputY>r)&&(this.showFiles=!1)}},renderFiles:function(t){var e=gt.windowWidth(),i=gt.windowHeight(),s=e/2-it.modalW/2,n=i/2-it.modalH/2;t.set_color(-14671840),t.fillRect(s,n,it.modalW,it.modalH);var r=e/2-it.modalRectW/2|0,a=e/2+it.modalRectW/2|0,o=i/2-it.modalRectH/2|0,l=i/2+it.modalRectH/2|0;if(o+=it.modalHeaderH,t.end(),this.uimodal.begin(t),this.uimodal.window(Oe.global.nest(36,null),r,o,it.modalRectW,it.modalRectH-100)){var h=Oe.global.nest(37,null);h.text=this.uimodal.textInput(h),it.path=Fe.fileBrowser(this.uimodal,h,this.foldersOnly)}this.uimodal.end(!1),t.begin(!1),this.uimodal.beginLayout(t,a-100,l-30,100),this.uimodal.button("OK")&&(this.showFiles=!1,this.filesDone(it.path)),this.uimodal.endLayout(!1),this.uimodal.beginLayout(t,a-200,l-30,100),this.uimodal.button("Cancel")&&(this.showFiles=!1),this.uimodal.endLayout(),t.begin(!1)},absx:function(t){return null==t?0:t.x+this.absx(this.elemById(t.parent))},absy:function(t){return null==t?0:t.y+this.absy(this.elemById(t.parent))},__class__:it};var st=function(){};(s.HxOverrides=st).__name__=!0,st.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),i=new Date;return i.setTime(0),i.setUTCHours(e[0]),i.setUTCMinutes(e[1]),i.setUTCSeconds(e[2]),i;case 10:var s=t.split("-");return new Date(s[0],s[1]-1,s[2],0,0,0);case 19:var n=t.split(" "),r=n[0].split("-"),a=n[1].split(":");return new Date(r[0],r[1]-1,r[2],a[0],a[1],a[2]);default:throw new zt("Invalid date format : "+t)}},st.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},st.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},st.remove=function(t,e){var i=t.indexOf(e);return-1!=i&&(t.splice(i,1),!0)},st.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var nt=function(){};(s.Main=nt).__name__=!0,nt.main=function(){var t=1600,e=900;t>m.get_primary().get_width()&&(t=m.get_primary().get_width()),e>m.get_primary().get_height()-30&&(e=m.get_primary().get_height()-30),gt.start(new O("Armory2D",t,e,null,null),nt.initialized)},nt.initialized=function(t){nt.prefs={path:"",scaleFactor:1};var e=Krom.getArgCount();if(4<e&&(nt.prefs.path=Krom.getArg(3)),5<e){var i=parseFloat(Krom.getArg(4));nt.prefs.scaleFactor=i}var s=nt.prefs.path.split("/");s.pop(),nt.cwd=s.join("/");var n="Windows"==gt.get_systemId()?at.replace(nt.prefs.path,"/","\\"):nt.prefs.path;ft.loadBlobFromPath(n,function(t){var e=JSON.parse(t.toString());nt.inst=new it(e)},null,{fileName:"Main.hx",lineNumber:36,className:"Main",methodName:"initialized"})},Math.__name__=!0;var Z=function(){};(s.Reflect=Z).__name__=!0,Z.field=function(t,e){try{return t[e]}catch(t){t instanceof zt&&t.val;return null}},Z.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var s in t)"__id__"!=s&&"hx__closures__"!=s&&i.call(t,s)&&e.push(s)}return e},Z.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},Z.copy=function(t){for(var e={},i=0,s=Z.fields(t);i<s.length;){var n=s[i];++i,e[n]=Z.field(t,n)}return e};var rt=function(){};(s.Std=rt).__name__=!0,rt.string=function(t){return y.__string_rec(t,"")},rt.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e};var at=function(){};(s.StringTools=at).__name__=!0,at.endsWith=function(t,e){var i=e.length,s=t.length;return i<=s&&st.substr(t,s-i,i)==e},at.isSpace=function(t,e){var i=st.cca(t,e);return 8<i&&i<14||32==i},at.rtrim=function(t){for(var e=t.length,i=0;i<e&&at.isSpace(t,e-i-1);)++i;return 0<i?st.substr(t,0,e-i):t},at.replace=function(t,e,i){return t.split(e).join(i)};var K=function(){};(s.Type=K).__name__=!0,K.createEnum=function(t,e,i){var s=Z.field(t,e);if(null==s)throw new zt("No such constructor "+e);if(Z.isFunction(s)){if(null==i)throw new zt("Constructor "+e+" need parameters");return s.apply(t,i)}if(null!=i&&0!=i.length)throw new zt("Constructor "+e+" does not need parameters");return s},K.getInstanceFields=function(t){var e=[];for(var i in t.prototype)e.push(i);return st.remove(e,"__class__"),st.remove(e,"__properties__"),e};var Vt={};(s["_UInt.UInt_Impl_"]=Vt).__name__=!0,Vt.gt=function(t,e){var i=t<0;return i!=e<0?i:e<t},Vt.gte=function(t,e){var i=t<0;return i!=e<0?i:e<=t},Vt.toFloat=function(t){return t<0?4294967296+t:t+0};var a=function(){};(s["haxe.IMap"]=a).__name__=!0;var j=function(){};(s["haxe.Log"]=j).__name__=!0,j.formatOutput=function(t,e){var i=rt.string(t);if(null==e)return i;var s=e.fileName+":"+e.lineNumber;if(null!=e&&null!=e.customParams)for(var n=0,r=e.customParams;n<r.length;){var a=r[n];++n,i+=", "+rt.string(a)}return s+": "+i},j.trace=function(t,e){var i=j.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(i)};var o=function(){};(s["haxe._Unserializer.DefaultResolver"]=o).__name__=!0,o.prototype={resolveClass:function(t){return s[t]},resolveEnum:function(t){return b[t]},__class__:o};var q=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=q.DEFAULT_RESOLVER;null==e&&(e=new o,q.DEFAULT_RESOLVER=e),this.resolver=e};(s["haxe.Unserializer"]=q).__name__=!0,q.initCodes=function(){for(var t=[],e=0,i=q.BASE64.length;e<i;){var s=e++;t[q.BASE64.charCodeAt(s)]=s}return t},q.run=function(t){return new q(t).unserialize()},q.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var s=this.buf.charCodeAt(this.pos);if(s!=s)break;if(45!=s){if(s<48||57<s)break;t=10*t+(s-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(e!=e)break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return parseFloat(st.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new zt("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new zt("Invalid object key");var i=this.unserialize();t[e]=i}this.pos++},unserializeEnum:function(t,e){if(58!=this.buf.charCodeAt(this.pos++))throw new zt("Invalid enum format");var i=this.readDigits();if(0==i)return K.createEnum(t,e);for(var s=[];0<i--;)s.push(this.unserialize());return K.createEnum(t,e,s)},unserialize:function(){switch(this.buf.charCodeAt(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new zt("Class not found "+t);return e;case 66:var i=this.unserialize(),s=this.resolver.resolveEnum(i);if(null==s)throw new zt("Enum not found "+i);return s;case 67:var n=this.unserialize(),r=this.resolver.resolveClass(n);if(null==r)throw new zt("Class not found "+n);var a=Object.create(r.prototype);if(this.cache.push(a),a.hxUnserialize(this),103!=this.buf.charCodeAt(this.pos++))throw new zt("Invalid custom data");return a;case 77:var o=new et;this.cache.push(o);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var h=this.readDigits();if(h<0||h>=this.scache.length)throw new zt("Invalid string reference");return this.scache[h];case 97:this.buf;var u=[];for(this.cache.push(u);;){var c=this.buf.charCodeAt(this.pos);if(104==c){this.pos++;break}if(117==c){this.pos++;var d=this.readDigits();u[u.length+d-1]=null}else u.push(this.unserialize())}return u;case 98:var _=new ot;this.cache.push(_);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var f=this.unserialize(),g=this.unserialize();null!=Je[f]?_.setReserved(f,g):_.h[f]=g}return this.pos++,_;case 99:var p=this.unserialize(),v=this.resolver.resolveClass(p);if(null==v)throw new zt("Class not found "+p);var m=Object.create(v.prototype);return this.cache.push(m),this.unserializeObject(m),m;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var w=this.unserialize(),b=this.resolver.resolveEnum(w);if(null==b)throw new zt("Enum not found "+w);this.pos++;var S=this.readDigits(),y=b.__constructs__.slice()[S];if(null==y)throw new zt("Unknown enum index "+w+"@"+S);var x=this.unserializeEnum(b,y);return this.cache.push(x),x;case 107:return NaN;case 108:var E=new tt;this.cache.push(E);for(this.buf;104!=this.buf.charCodeAt(this.pos);)E.add(this.unserialize());return this.pos++,E;case 109:return-1/0;case 110:return null;case 111:var C={};return this.cache.push(C),this.unserializeObject(C),C;case 112:return 1/0;case 113:var k=new $;this.cache.push(k);this.buf;for(var T=this.buf.charCodeAt(this.pos++);58==T;){var L=this.readDigits(),B=this.unserialize();k.h[L]=B,T=this.buf.charCodeAt(this.pos++)}if(104!=T)throw new zt("Invalid IntMap format");return k;case 114:var I=this.readDigits();if(I<0||I>=this.cache.length)throw new zt("Invalid reference");return this.cache[I];case 115:var N=this.readDigits(),A=this.buf;if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<N)throw new zt("Invalid bytes length");var R=q.CODES;null==R&&(R=q.initCodes(),q.CODES=R);for(var P=this.pos,V=3&N,D=P+(N-V),O=new ut(new ArrayBuffer(3*(N>>2)+(2<=V?V-1:0))),M=0;P<D;){var F=R[A.charCodeAt(P++)],W=R[A.charCodeAt(P++)];O.b[M++]=F<<2|W>>4;var H=R[A.charCodeAt(P++)];O.b[M++]=W<<4|H>>2;var U=R[A.charCodeAt(P++)];O.b[M++]=H<<6|U}if(2<=V){var G=R[A.charCodeAt(P++)],X=R[A.charCodeAt(P++)];if(O.b[M++]=G<<2|X>>4,3==V){var Y=R[A.charCodeAt(P++)];O.b[M++]=X<<4|Y>>2}}return this.pos+=N,this.cache.push(O),O;case 116:return!0;case 118:var z;return 48<=this.buf.charCodeAt(this.pos)&&this.buf.charCodeAt(this.pos)<=57&&48<=this.buf.charCodeAt(this.pos+1)&&this.buf.charCodeAt(this.pos+1)<=57&&48<=this.buf.charCodeAt(this.pos+2)&&this.buf.charCodeAt(this.pos+2)<=57&&48<=this.buf.charCodeAt(this.pos+3)&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)?(z=st.strDate(st.substr(this.buf,this.pos,19)),this.pos+=19):z=new Date(this.readFloat()),this.cache.push(z),z;case 119:var Z=this.unserialize(),K=this.resolver.resolveEnum(Z);if(null==K)throw new zt("Enum not found "+Z);var j=this.unserializeEnum(K,this.unserialize());return this.cache.push(j),j;case 120:throw zt.wrap(this.unserialize());case 121:var J=this.readDigits();if(58!=this.buf.charCodeAt(this.pos++)||this.length-this.pos<J)throw new zt("Invalid string length");var Q=st.substr(this.buf,this.pos,J);return this.pos+=J,Q=decodeURIComponent(Q.split("+").join(" ")),this.scache.push(Q),Q;case 122:return 0}throw this.pos--,new zt("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:q};var $=function(){this.h={}};(s["haxe.ds.IntMap"]=$).__name__=!0,$.__interfaces__=[a],$.prototype={h:null,__class__:$};var tt=function(){this.length=0};(s["haxe.ds.List"]=tt).__name__=!0,tt.prototype={h:null,q:null,length:null,add:function(t){var e=new l(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},__class__:tt};var l=function(t,e){this.item=t,this.next=e};(s["haxe.ds._List.ListNode"]=l).__name__=!0,l.prototype={item:null,next:null,__class__:l};var et=function(){this.h={__keys__:{}}};(s["haxe.ds.ObjectMap"]=et).__name__=!0,et.__interfaces__=[a],et.prototype={h:null,set:function(t,e){var i=t.__id__||(t.__id__=++et.count);this.h[i]=e,this.h.__keys__[i]=t},__class__:et};var ot=function(){this.h={}};(s["haxe.ds.StringMap"]=ot).__name__=!0,ot.__interfaces__=[a],ot.prototype={h:null,rh:null,setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null!=this.rh&&this.rh.hasOwnProperty("$"+t)},__class__:ot};var ut=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(s["haxe.io.Bytes"]=ut).__name__=!0,ut.ofString=function(t,e){if(e==d.RawNative){for(var i=new Uint8Array(t.length<<1),s=0,n=t.length;s<n;){var r=s++,a=t.charCodeAt(r);i[r<<1]=255&a,i[r<<1|1]=a>>8}return new ut(i.buffer)}for(var o=[],l=0;l<t.length;){var h=t.charCodeAt(l++);55296<=h&&h<=56319&&(h=h-55232<<10|1023&t.charCodeAt(l++)),h<=127?o.push(h):(h<=2047?o.push(192|h>>6):(h<=65535?o.push(224|h>>12):(o.push(240|h>>18),o.push(128|h>>12&63)),o.push(128|h>>6&63)),o.push(128|63&h))}return new ut(new Uint8Array(o).buffer)},ut.ofData=function(t){var e=t.hxBytes;return null!=e?e:new ut(t)},ut.prototype={length:null,b:null,data:null,sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new zt(_.OutsideBounds);return new ut(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},getFloat:function(t){return null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength)),this.data.getFloat32(t,!0)},getString:function(t,e,i){if(t<0||e<0||t+e>this.length)throw new zt(_.OutsideBounds);null==i&&(i=d.UTF8);var s="",n=this.b,r=t,a=t+e;switch(i._hx_index){case 0:for(;r<a;){var o=n[r++];if(o<128){if(0==o)break;s+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&n[r++];s+=String.fromCodePoint(l)}else if(o<240){var h=(31&o)<<12|(127&n[r++])<<6|127&n[r++];s+=String.fromCodePoint(h)}else{var u=(15&o)<<18|(127&n[r++])<<12|(127&n[r++])<<6|127&n[r++];s+=String.fromCodePoint(u)}}break;case 1:for(;r<a;){var c=n[r++]|n[r++]<<8;s+=String.fromCodePoint(c)}}return s},toString:function(){return this.getString(0,this.length)},__class__:ut};var h=function(){this.pos=0,this.size=0};(s["haxe.io.BytesBuffer"]=h).__name__=!0,h.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},addBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new zt(_.OutsideBounds);if(this.pos+i>this.size&&this.grow(i),0!=this.size){var s=new Uint8Array(t.b.buffer,t.b.byteOffset+e,i);this.u8.set(s,this.pos),this.pos+=i}},grow:function(t){for(var e=this.pos+t,i=0==this.size?16:this.size;i<e;)i=3*i>>1;var s=new ArrayBuffer(i),n=new Uint8Array(s);0<this.size&&n.set(this.u8),this.size=i,this.buffer=s,this.u8=n,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return new ut(new ArrayBuffer(0));var t=new ut(this.buffer);return t.length=this.pos,t},__class__:h};var u=function(){};(s["haxe.io.Input"]=u).__name__=!0,u.prototype={bigEndian:null,readByte:function(){throw new zt("Not implemented")},readBytes:function(t,e,i){var s=i,n=t.b;if(e<0||i<0||e+i>t.length)throw new zt(_.OutsideBounds);try{for(;0<s;)n[e]=this.readByte(),++e,--s}catch(t){var r=t instanceof zt?t.val:t;if(!(r instanceof S))throw t}return i-s},readFullBytes:function(t,e,i){for(;0<i;){var s=this.readBytes(t,e,i);if(0==s)throw new zt(_.Blocked);e+=s,i-=s}},read:function(t){for(var e=new ut(new ArrayBuffer(t)),i=0;0<t;){var s=this.readBytes(e,i,t);if(0==s)throw new zt(_.Blocked);i+=s,t-=s}return e},readInt32:function(){var t=this.readByte(),e=this.readByte(),i=this.readByte(),s=this.readByte();return this.bigEndian?s|i<<8|e<<16|t<<24:t|e<<8|i<<16|s<<24},readString:function(t,e){var i=new ut(new ArrayBuffer(t));return this.readFullBytes(i,0,t),i.getString(0,t,e)},__class__:u};var ct=function(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),e<0||i<0||e+i>t.length)throw new zt(_.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i};(s["haxe.io.BytesInput"]=ct).__name__=!0,ct.__super__=u,ct.prototype=r(u.prototype,{b:null,pos:null,len:null,totlen:null,set_position:function(t){return t<0?t=0:t>this.totlen&&(t=this.totlen),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new zt(new S);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new zt(_.OutsideBounds);if(0==this.len&&0<i)throw new zt(new S);this.len<i&&(i=this.len);for(var s=this.b,n=t.b,r=0,a=i;r<a;){var o=r++;n[e+o]=s[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:ct});var c=function(){};(s["haxe.io.Output"]=c).__name__=!0,c.prototype={bigEndian:null,writeByte:function(t){throw new zt("Not implemented")},writeBytes:function(t,e,i){if(e<0||i<0||e+i>t.length)throw new zt(_.OutsideBounds);for(var s=t.b,n=i;0<n;)this.writeByte(s[e]),++e,--n;return i},write:function(t){for(var e=t.length,i=0;0<e;){var s=this.writeBytes(t,i,e);if(0==s)throw new zt(_.Blocked);i+=s,e-=s}},writeFloat:function(t){this.writeInt32(f.floatToI32(t))},writeInt32:function(t){this.bigEndian?(this.writeByte(t>>>24),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)):(this.writeByte(255&t),this.writeByte(t>>8&255),this.writeByte(t>>16&255),this.writeByte(t>>>24))},__class__:c};var dt=function(){this.b=new h};(s["haxe.io.BytesOutput"]=dt).__name__=!0,dt.__super__=c,dt.prototype=r(c.prototype,{b:null,writeByte:function(t){this.b.addByte(t)},writeBytes:function(t,e,i){return this.b.addBytes(t,e,i),i},getBytes:function(){return this.b.getBytes()},__class__:dt});var d=b["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:n},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:n}},S=function(){};(s["haxe.io.Eof"]=S).__name__=!0,S.prototype={toString:function(){return"Eof"},__class__:S};var _=b["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:n},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:n},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:n},Custom:(i=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:n}},i.__params__=["e"],i)},f=function(){};(s["haxe.io.FPHelper"]=f).__name__=!0,f.floatToI32=function(t){return f.helper.setFloat32(0,t,!0),f.helper.getInt32(0,!0)};var g=function(){};(s["haxe.io.Path"]=g).__name__=!0,g.normalize=function(t){if("/"==(t=t.split("\\").join("/")))return"/";for(var e=[],i=0,s=t.split("/");i<s.length;){var n=s[i];++i,".."==n&&0<e.length&&".."!=e[e.length-1]?e.pop():""==n?(0<e.length||47==st.cca(t,0))&&e.push(n):"."!=n&&e.push(n)}for(var r=e.join("/"),a="",o=!1,l=!1,h=0,u=r.length;h<u;){var c=h++,d=r.charCodeAt(c);switch(d){case 47:if(o){var _=d;o=!1,l&&(a+="/",l=!1),a+=String.fromCodePoint(_)}else l=!0;break;case 58:a+=":",o=!0;break;default:var f=d;o=!1,l&&(a+="/",l=!1),a+=String.fromCodePoint(f)}}return a};var zt=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,zt)};(s["js._Boot.HaxeError"]=zt).__name__=!0,zt.wrap=function(t){return t instanceof Error?t:new zt(t)},zt.__super__=Error,zt.prototype=r(Error.prototype,{val:null,__class__:zt});var y=function(){};(s["js.Boot"]=y).__name__=!0,y.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var i=y.__nativeClassName(t);return null!=i?y.__resolveNativeClass(i):null},y.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var i=typeof t;switch("function"==i&&(t.__name__||t.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(t.__enum__){var s=b[t.__enum__],n=s.__constructs__[t._hx_index],r=s[n];if(r.__params__){e+="\t";for(var a=n+"(",o=[],l=0,h=r.__params__;l<h.length;){var u=h[l];++l,o.push(y.__string_rec(t[u],e))}return a+o.join(",")+")"}return n}if(t instanceof Array){var c="[";e+="\t";for(var d=0,_=t.length;d<_;){var f=d++;c+=(0<f?",":"")+y.__string_rec(t[f],e)}return c+="]"}var g;try{g=t.toString}catch(t){t instanceof zt&&t.val;return"???"}if(null!=g&&g!=Object.toString&&"function"==typeof g){var p=t.toString();if("[object Object]"!=p)return p}var v=null,m="{\n";e+="\t";var w=null!=t.hasOwnProperty;for(var v in t)w&&!t.hasOwnProperty(v)||"prototype"!=v&&"__class__"!=v&&"__super__"!=v&&"__interfaces__"!=v&&"__properties__"!=v&&(2!=m.length&&(m+=", \n"),m+=e+v+" : "+y.__string_rec(t[v],e));return m+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},y.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var s=0,n=i.length;s<n;){var r=i[s++];if(r==e||y.__interfLoop(r,e))return!0}return y.__interfLoop(t.__super__,e)},y.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case Ze:return"boolean"==typeof t;case Ye:return null!=t;case ze:return"number"==typeof t;case Xe:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(y.__interfLoop(y.getClass(t),e))return!0}else if("object"==typeof e&&y.__isNativeObj(e)&&t instanceof e)return!0;return e==Ke&&null!=t.__name__||(e==je&&null!=t.__ename__||b[t.__enum__]==e)}},y.__cast=function(t,e){if(null==t||y.__instanceof(t,e))return t;throw new zt("Cannot cast "+rt.string(t)+" to "+rt.string(e))},y.__nativeClassName=function(t){var e=y.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},y.__isNativeObj=function(t){return null!=y.__nativeClassName(t)},y.__resolveNativeClass=function(t){return e[t]};var p=function(){};(s["js.html._ArrayBuffer.ArrayBufferCompat"]=p).__name__=!0,p.sliceImpl=function(t,e){var i=new Uint8Array(this,t,null==e?null:e-t),s=new Uint8Array(i.byteLength);return s.set(i),s.buffer};var J=function(){this.names=["color_wheel"],this.color_wheelDescription={name:"color_wheel",original_height:270,original_width:360,files:["color_wheel.png"],type:"image"},this.color_wheelName="color_wheel",this.color_wheel=null};(s["kha._Assets.ImageList"]=J).__name__=!0,J.prototype={get:function(t){return Z.field(this,t)},color_wheel:null,color_wheelName:null,color_wheelDescription:null,color_wheelLoad:function(e,t){var i;if(null!=t)i=t;else{var s=j.trace,n={fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"color_wheelLoad"};i=function(t){s(t,n)}}ft.loadImage("color_wheel",function(t){e()},i,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:132,className:"kha._Assets.ImageList",methodName:"color_wheelLoad"})},color_wheelUnload:function(){this.color_wheel.unload(),this.color_wheel=null},names:null,__class__:J};var Q=function(){this.names=[]};(s["kha._Assets.SoundList"]=Q).__name__=!0,Q.prototype={get:function(t){return Z.field(this,t)},names:null,__class__:Q};var lt=function(){this.names=[]};(s["kha._Assets.BlobList"]=lt).__name__=!0,lt.prototype={get:function(t){return Z.field(this,t)},names:null,__class__:lt};var ht=function(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null};(s["kha._Assets.FontList"]=ht).__name__=!0,ht.prototype={get:function(t){return Z.field(this,t)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(e,t){var i;if(null!=t)i=t;else{var s=j.trace,n={fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"font_defaultLoad"};i=function(t){s(t,n)}}ft.loadFont("font_default",function(t){e()},i,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:144,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:ht};var _t=function(){this.names=[]};(s["kha._Assets.VideoList"]=_t).__name__=!0,_t.prototype={get:function(t){return Z.field(this,t)},names:null,__class__:_t};var ft=function(){};(s["kha.Assets"]=ft).__name__=!0,ft.loadEverything=function(t,e,i,s){for(var n=0,r=0,a=K.getInstanceFields(lt);r<a.length;){var o=a[r];++r,at.endsWith(o,"Load")&&(n+=1)}for(var l=0,h=K.getInstanceFields(J);l<h.length;){var u=h[l];++l,at.endsWith(u,"Load")&&(n+=1)}for(var c=0,d=K.getInstanceFields(Q);c<d.length;){var _=d[c];++c,at.endsWith(_,"Load")&&(n+=1)}for(var f=0,g=K.getInstanceFields(ht);f<g.length;){var p=g[f];++f,at.endsWith(p,"Load")&&(n+=1)}for(var v=0,m=K.getInstanceFields(_t);v<m.length;){var w=m[v];++v,at.endsWith(w,"Load")&&(n+=1)}if(0!=n){for(var b=n,S=function(){b-=1,ft.progress=1-b/n,0==b&&t()},y=0,x=K.getInstanceFields(lt);y<x.length;){var E=x[y];if(++y,at.endsWith(E,"Load")){var C=st.substr(E,0,E.length-4),k=Z.field(ft.blobs,C+"Description");null==e||e(k)?Z.field(ft.blobs,E)(S,function(t){if(null==s);S()}):S()}}for(var T=0,L=K.getInstanceFields(J);T<L.length;){var B=L[T];if(++T,at.endsWith(B,"Load")){var I=st.substr(B,0,B.length-4),N=Z.field(ft.images,I+"Description");null==e||e(N)?Z.field(ft.images,B)(S,function(t){if(null==s);S()}):S()}}for(var A=0,R=K.getInstanceFields(Q);A<R.length;){var P=[R[A]];if(++A,at.endsWith(P[0],"Load")){var V=st.substr(P[0],0,P[0].length-4),D=[Z.field(ft.sounds,V+"Description")];null==e||e(D[0])?Z.field(ft.sounds,P[0])(function(t,e){return function(){null==i||i(t[0])?Z.field(ft.sounds,e[0].substring(0,e[0].length-4)).uncompress(S):S()}}(D,P),null!=s?s:function(e,i){return function(t){i[0](t,e[0])}}([{fileName:"kha/Assets.hx",lineNumber:174,className:"kha.Assets",methodName:"loadEverything"}],[j.trace])):S()}}for(var O=0,M=K.getInstanceFields(ht);O<M.length;){var F=M[O];if(++O,at.endsWith(F,"Load")){var W=st.substr(F,0,F.length-4),H=Z.field(ft.fonts,W+"Description");null==e||e(H)?Z.field(ft.fonts,F)(S,function(t){if(null==s);S()}):S()}}for(var U=0,G=K.getInstanceFields(_t);U<G.length;){var X=G[U];if(++U,at.endsWith(X,"Load")){var Y=st.substr(X,0,X.length-4),z=Z.field(ft.videos,Y+"Description");null==e||e(z)?Z.field(ft.videos,X)(S,function(t){if(null==s);S()}):S()}}}else t()},ft.loadImage=function(e,i,t,s){var n,r=Z.field(ft.images,e+"Description");if(null!=t)n=t;else{var a=j.trace,o=s;n=function(t){a(t,o)}}N.loadImageFromDescription(r,function(t){ft.images[e]=t,i(t)},n)},ft.loadImageFromPath=function(t,e,i,s,n){var r,a={files:[t],readable:e};if(null!=s)r=s;else{var o=j.trace,l=n;r=function(t){o(t,l)}}N.loadImageFromDescription(a,i,r)},ft.loadBlobFromPath=function(t,e,i,s){var n,r={files:[t]};if(null!=i)n=i;else{var a=j.trace,o=s;n=function(t){a(t,o)}}N.loadBlobFromDescription(r,e,n)},ft.loadFont=function(e,i,t,s){var n,r=Z.field(ft.fonts,e+"Description");if(null!=t)n=t;else{var a=j.trace,o=s;n=function(t){a(t,o)}}N.loadFontFromDescription(r,function(t){ft.fonts[e]=t,i(t)},n)},ft.loadFontFromPath=function(t,e,i,s){var n,r={files:[t]};if(null!=i)n=i;else{var a=j.trace,o=s;n=function(t){a(t,o)}}N.loadFontFromDescription(r,e,n)};var v=function(){};(s["kha.Canvas"]=v).__name__=!0,v.prototype={get_g4:null,get_height:null,get_width:null,__class__:v};var k=t.kha._Color.Color_Impl_={};(s["kha._Color.Color_Impl_"]=k).__name__=!0,k.fromValue=function(t){return k._new(t)},k.fromBytes=function(t,e,i,s){return null==s&&(s=255),k._new(s<<24|t<<16|e<<8|i)},k.fromFloats=function(t,e,i,s){return null==s&&(s=1),k._new((255*s|0)<<24|(255*t|0)<<16|(255*e|0)<<8|255*i|0)},k.fromString=function(t){if(7!=t.length&&9!=t.length||35!=t.charCodeAt(0))throw new zt("Invalid Color string: '"+t+"'");var e=rt.parseInt("0x"+st.substr(t,1,null));return 7==t.length&&(e+=-16777216),k._new(e)},k._new=function(t){return t},k.get_value=function(t){return t},k.set_value=function(t,e){return e},k.get_Rb=function(t){return(16711680&t)>>>16},k.get_Gb=function(t){return(65280&t)>>>8},k.get_Bb=function(t){return 255&t},k.get_Ab=function(t){return t>>>24},k.set_Rb=function(t,e){return t=t>>>24<<24|e<<16|(65280&t)>>>8<<8|255&t,e},k.set_Gb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|e<<8|255&t,e},k.set_Bb=function(t,e){return t=t>>>24<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|e,e},k.set_Ab=function(t,e){return t=e<<24|(16711680&t)>>>16<<16|(65280&t)>>>8<<8|255&t,e},k.get_R=function(t){return.00392156862745098*((16711680&t)>>>16)},k.get_G=function(t){return.00392156862745098*((65280&t)>>>8)},k.get_B=function(t){return.00392156862745098*(255&t)},k.get_A=function(t){return.00392156862745098*(t>>>24)},k.set_R=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(255*e|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e},k.set_G=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(255*e|0)<<8|.00392156862745098*(255&t)*255|0,e},k.set_B=function(t,e){return t=(.00392156862745098*(t>>>24)*255|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|255*e|0,e},k.set_A=function(t,e){return t=(255*e|0)<<24|(.00392156862745098*((16711680&t)>>>16)*255|0)<<16|(.00392156862745098*((65280&t)>>>8)*255|0)<<8|.00392156862745098*(255&t)*255|0,e};var m=function(t,e){this.num=t,this.isPrimary=e};(s["kha.Display"]=m).__name__=!0,m.init=function(){for(var t=0,e=Krom.displayCount();t<e;){var i=t++;m.displays.push(new m(i,Krom.displayIsPrimary(i)))}},m.get_primary=function(){m.init();for(var t=0,e=m.displays;t<e.length;){var i=e[t];if(++t,i.isPrimary)return i}return null},m.prototype={num:null,isPrimary:null,get_width:function(){return Krom.displayWidth(this.num)},get_height:function(){return Krom.displayHeight(this.num)},get_frequency:function(){return 60},__class__:m};var w=function(){};(s["kha.DisplayMode"]=w).__name__=!0;var x=function(t,e,i,s,n){this.window=t,this.graphics1=e,this.graphics2=i,this.graphics4=s,this.graphics5=n};(s["kha.Framebuffer"]=x).__name__=!0,x.__interfaces__=[v],x.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,graphics5:null,init:function(t,e,i,s){this.graphics1=t,this.graphics2=e,this.graphics4=i,this.graphics5=s},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return gt.windowWidth(this.window)},get_height:function(){return gt.windowHeight(this.window)},__class__:x};var E=function(t,e,i,s,n,r){null==r&&(r=1),null==n&&(n=8),null==s&&(s=16),null==i&&(i=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=i,this.depthBufferBits=s,this.stencilBufferBits=n,this.samplesPerPixel=r};(s["kha.FramebufferOptions"]=E).__name__=!0,E.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:E};var C=function(){};(s["kha.Resource"]=C).__name__=!0;var T=function(t){this.texture_=t};(s["kha.Image"]=T).__name__=!0,T.__interfaces__=[C,v],T.getRenderTargetFormat=function(t){switch(t){case 0:return 0;case 1:return 5;case 2:return 3;case 3:return 4;case 4:return 1;case 5:return 2;case 6:return 6;default:return 0}},T.getDepthBufferBits=function(t){switch(t){case 0:return-1;case 1:case 2:case 3:return 24;case 4:return 32;case 5:return 16}},T.getStencilBufferBits=function(t){switch(t){case 0:case 1:return-1;case 2:case 3:case 4:return 8;case 5:return 0}},T.getTextureFormat=function(t){switch(t){case 0:return 0;case 2:return 3;case 4:return 4;case 5:return 5;case 6:return 7;default:return 1}},T._fromTexture=function(t){return new T(t)},T.create=function(t,e,i,s){null==i&&(i=0);var n=new T(null);return n.format=i,n.texture_=Krom.createTexture(t,e,T.getTextureFormat(i)),n},T.createRenderTarget=function(t,e,i,s,n,r){null==r&&(r=0),null==n&&(n=1),null==s&&(s=0),null==i&&(i=0);var a=new T(null);return a.format=i,a.renderTarget_=Krom.createRenderTarget(t,e,T.getDepthBufferBits(s),T.getRenderTargetFormat(i),T.getStencilBufferBits(s),r),a},T.get_nonPow2Supported=function(){return!0},T.prototype={texture_:null,renderTarget_:null,format:null,graphics2:null,graphics4:null,unload:function(){Krom.unloadImage(this),this.texture_=null,this.renderTarget_=null},lock:function(t){return null==t&&(t=0),ut.ofData(Krom.lockTexture(this.texture_,t))},unlock:function(){Krom.unlockTexture(this.texture_)},get_width:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.width},get_height:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.height},get_realWidth:function(){return null==this.texture_?this.renderTarget_.width:this.texture_.realWidth},get_realHeight:function(){return null==this.texture_?this.renderTarget_.height:this.texture_.realHeight},get_g2:function(){return null==this.graphics2&&(this.graphics2=new ue(this)),this.graphics2},get_g4:function(){return null==this.graphics4&&(this.graphics4=new Ne(this)),this.graphics4},__class__:T};var L=function(){};(s["kha.AlignedQuad"]=L).__name__=!0,L.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:L};var B=function(t,e,i,s,n,r,a,o){this.mySize=t,this.width=n,this.height=r,this.chars=a,this.baseline=e;for(var l=0;l<a.length;){var h=a[l];++l,h.yoff+=this.baseline}this.texture=T.create(n,r,1);for(var u=this.texture.lock(),c=0,d=0,_=r;d<_;){d++;for(var f=0,g=n;f<g;){f++;var p=o.readU8(c);u.b[c]=p,++c}}this.texture.unlock()};(s["kha.KravurImage"]=B).__name__=!0,B.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(t,e,i,s){if(e>=this.chars.length)return null;var n=1/this.width,r=1/this.height,a=this.chars[e];if(null==a)return null;var o=Math.round(i+a.xoff),l=Math.round(s+a.yoff);return t.x0=o,t.y0=l,t.x1=o+a.x1-a.x0,t.y1=l+a.y1-a.y0,t.s0=a.x0*n,t.t0=a.y0*r,t.s1=a.x1*n,t.t1=a.y1*r,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=B.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var i=1,s=B.charBlocks.length/2|0;i<s;){var n=i++,r=B.charBlocks[2*n-1],a=B.charBlocks[2*n];a-1<t&&(e+=a-1-r)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,i=0,s=t.length;i<s;){var n=i++;e+=this.getCharWidth(st.cca(t,n))}return e},__class__:B};var I=function(t){this.images=new $,this.blob=t};(s["kha.Kravur"]=I).__name__=!0,I.__interfaces__=[C],I.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t){var e=Mt.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var i=(B.charBlocks=[e[0]])[0]+1,s=1,n=e.length;s<n;){var r=s++;e[r]!=i?(B.charBlocks.push(e[r-1]),B.charBlocks.push(e[r]),i=e[r]+1):++i}B.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(!this.images.h.hasOwnProperty(a)){for(var o=64,l=32,h=new Array(e.length),u=0,c=h.length;u<c;){h[u++]=new Kt}for(var d=null,_=-1;_<=0;)l<o?l*=2:o*=2,d=Ie.alloc(o*l),_=ee.stbtt_BakeFontBitmap(this.blob,0,t,d,o,l,e,h);var f=new jt;ee.stbtt_InitFont(f,this.blob,0);var g=ee.stbtt_GetFontVMetrics(f),p=ee.stbtt_ScaleForPixelHeight(f,t),v=Math.round(g.ascent*p),m=Math.round(g.descent*p),w=Math.round(g.lineGap*p),b=new B(0|t,v,m,w,o,l,h,d);return this.images.h[a]=b}return this.images.h[a]},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},unload:function(){this.blob=null,this.images=null},__class__:I};var N=function(){};(s["kha.LoaderImpl"]=N).__name__=!0,N.loadImageFromDescription=function(t,e,i){var s=Object.prototype.hasOwnProperty.call(t,"readable")&&t.readable;e(T._fromTexture(Krom.loadImage(t.files[0],s)))},N.loadBlobFromDescription=function(t,e,i){e(new Ie(ut.ofData(Krom.loadBlob(t.files[0]))))},N.loadFontFromDescription=function(t,e,i){N.loadBlobFromDescription(t,function(t){e(new I(t))},i)};var A=function(){};(s["kha.TimeTask"]=A).__name__=!0,A.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:A};var R=function(t,e,i){this.task=t,this.priority=e,this.id=i,this.active=!0,this.paused=!1};(s["kha.FrameTask"]=R).__name__=!0,R.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:R};var P=function(){};(s["kha.Scheduler"]=P).__name__=!0,P.init=function(){P.deltas=[];for(var t=0,e=P.DIF_COUNT;t<e;){var i=t++;P.deltas[i]=0}P.stopped=!0,P.frame_tasks_sorted=!0,P.current=P.lastTime=P.realTime(),P.currentFrameTaskId=0,P.currentTimeTaskId=0,P.currentGroupId=0,P.timeTasks=[],P.pausedTimeTasks=[],P.outdatedTimeTasks=[],P.timeTasksScratchpad=[],P.frameTasks=[],P.toDeleteFrame=[]},P.start=function(t){null==t&&(t=!1),P.vsync=W.get(0).get_vSynced();var e=m.get_primary().get_frequency();57<=e&&e<=63&&(e=60),P.onedifhz=1/e,P.stopped=!1,P.resetTime(),P.lastTime=P.realTime()-P.startTime;for(var i=0,s=P.DIF_COUNT;i<s;){var n=i++;P.deltas[n]=0}if(t){for(var r=0,a=P.timeTasks;r<a.length;){var o=a[r];++r,o.paused=!1}for(var l=0,h=P.frameTasks;l<h.length;){var u=h[l];++l,u.paused=!1}}},P.executeFrame=function(){var t=P.realTime()-P.startTime-P.lastTime,e=P.current;if(0<=t){if(null==De.the())if(t>P.maxframetime)P.startTime+=t-P.maxframetime,e+=t=P.maxframetime;else if(P.vsync){for(var i=P.onedifhz;i<t-P.onedifhz;)i+=P.onedifhz;t=i;for(var s=0,n=P.DIF_COUNT-2;s<n;){var r=s++;t+=P.deltas[r],P.deltas[r]=P.deltas[r+1]}t+=P.deltas[P.DIF_COUNT-2],t/=P.DIF_COUNT,P.deltas[P.DIF_COUNT-2]=i,e+=t}else{for(var a=0,o=P.DIF_COUNT-1;a<o;){var l=a++;P.deltas[l]=P.deltas[l+1]}P.deltas[P.DIF_COUNT-1]=t;for(var h=0,u=0,c=P.DIF_COUNT;u<c;){var d=u++;h+=P.deltas[d]}e+=h/=P.DIF_COUNT}else e+=t;P.lastTime=e,P.stopped||(P.current=e);for(var _=0,f=P.pausedTimeTasks;_<f.length;){var g=f[_];++_,g.next+=t}if(P.stopped)for(var p=0,v=P.timeTasks;p<v.length;){var m=v[p];++p,m.next+=t}P.executeTimeTasks(e);for(var w=0,b=P.outdatedTimeTasks;w<b.length;){var S=b[w];++w,S.next<e-10&&P.timeTasksScratchpad.push(S)}for(var y=0,x=P.timeTasksScratchpad;y<x.length;){var E=x[y];++y,st.remove(P.outdatedTimeTasks,E)}for(;0<P.timeTasksScratchpad.length;)st.remove(P.timeTasksScratchpad,P.timeTasksScratchpad[0])}P.sortFrameTasks();for(var C=0,k=P.frameTasks;C<k.length;){var T=k[C];++C,P.stopped||T.paused||!T.active||T.task()||(T.active=!1)}for(var L=0,B=P.frameTasks;L<B.length;){var I=B[L];++L,I.active||P.toDeleteFrame.push(I)}for(;0<P.toDeleteFrame.length;)st.remove(P.frameTasks,P.toDeleteFrame.pop())},P.executeTimeTasks=function(t){for(;0<P.timeTasks.length&&(P.activeTimeTask=P.timeTasks[0],P.activeTimeTask.next<=t);)P.activeTimeTask.next+=P.activeTimeTask.period,st.remove(P.timeTasks,P.activeTimeTask),P.activeTimeTask.active&&P.activeTimeTask.task()?0<P.activeTimeTask.period&&(0==P.activeTimeTask.duration||P.activeTimeTask.duration>=P.activeTimeTask.start+P.activeTimeTask.next)?P.insertSorted(P.timeTasks,P.activeTimeTask):P.archiveTimeTask(P.activeTimeTask,t):(P.activeTimeTask.active=!1,P.archiveTimeTask(P.activeTimeTask,t));P.activeTimeTask=null},P.archiveTimeTask=function(t,e){},P.time=function(){return P.current},P.realTime=function(){return gt.get_time()},P.resetTime=function(){var t=gt.get_time(),e=t-P.startTime;P.startTime=t;for(var i=0,s=P.timeTasks;i<s.length;){var n=s[i];++i,n.start-=e,n.next-=e}for(var r=0,a=P.DIF_COUNT;r<a;){var o=r++;P.deltas[o]=0}P.current=0,P.lastTime=0},P.addBreakableTimeTaskToGroup=function(t,e,i,s,n){null==n&&(n=0),null==s&&(s=0);var r=new A;return r.active=!0,r.task=e,r.id=++P.currentTimeTaskId,r.groupId=t,r.start=P.current+i,(r.period=0)!=s&&(r.period=s),(r.duration=0)!=n&&(r.duration=r.start+n),r.next=r.start,P.insertSorted(P.timeTasks,r),r.id},P.addTimeTaskToGroup=function(t,e,i,s,n){return null==n&&(n=0),null==s&&(s=0),P.addBreakableTimeTaskToGroup(t,function(){return e(),!0},i,s,n)},P.addTimeTask=function(t,e,i,s){return null==s&&(s=0),null==i&&(i=0),P.addTimeTaskToGroup(0,t,e,i,s)},P.insertSorted=function(t,e){for(var i=0,s=t.length;i<s;){var n=i++;if(t[n].next>e.next)return void t.splice(n,0,e)}t.push(e)},P.sortFrameTasks=function(){P.frame_tasks_sorted||(P.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),P.frame_tasks_sorted=!0)};b["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:n},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:n},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:n},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:n}};var V=function(){};(s["kha.Shaders"]=V).__name__=!0,V.init=function(){var t=[],e=Z.field(V,"painter_colored_fragData0"),i=q.run(e);t.push(Ie.fromBytes(i)),V.painter_colored_frag=new se(t,["painter-colored.frag.glsl"]);var s=[],n=Z.field(V,"painter_colored_vertData0"),r=q.run(n);s.push(Ie.fromBytes(r)),V.painter_colored_vert=new be(s,["painter-colored.vert.glsl"]);var a=[],o=Z.field(V,"painter_image_fragData0"),l=q.run(o);a.push(Ie.fromBytes(l)),V.painter_image_frag=new se(a,["painter-image.frag.glsl"]);var h=[],u=Z.field(V,"painter_image_vertData0"),c=q.run(u);h.push(Ie.fromBytes(c)),V.painter_image_vert=new be(h,["painter-image.vert.glsl"]);var d=[],_=Z.field(V,"painter_text_fragData0"),f=q.run(_);d.push(Ie.fromBytes(f)),V.painter_text_frag=new se(d,["painter-text.frag.glsl"]);var g=[],p=Z.field(V,"painter_text_vertData0"),v=q.run(p);g.push(Ie.fromBytes(v)),V.painter_text_vert=new be(g,["painter-text.vert.glsl"]);var m=[],w=Z.field(V,"painter_video_fragData0"),b=q.run(w);m.push(Ie.fromBytes(b)),V.painter_video_frag=new se(m,["painter-video.frag.glsl"]);var S=[],y=Z.field(V,"painter_video_vertData0"),x=q.run(y);S.push(Ie.fromBytes(x)),V.painter_video_vert=new be(S,["painter-video.vert.glsl"])};var D=function(){this.length=0};(s["kha.Sound"]=D).__name__=!0,D.__interfaces__=[C],D.prototype={compressedData:null,uncompressedData:null,length:null,uncompress:function(t){if(null==this.uncompressedData){var e=new dt,i=mt.readAll(this.compressedData,e,!0),s=e.getBytes(),n=s.length/4|0;if(1==i.channel){this.length=n/G.samplesPerSecond;var r=new Float32Array(2*n);this.uncompressedData=r;for(var a=0,o=n;a<o;){var l=a++;this.uncompressedData[2*l]=s.getFloat(4*l),this.uncompressedData[2*l+1]=s.getFloat(4*l)}}else{this.length=n/2/G.samplesPerSecond;var h=new Float32Array(n);this.uncompressedData=h;for(var u=0,c=n;u<c;){var d=u++;this.uncompressedData[d]=s.getFloat(4*d)}}this.compressedData=null,t()}else t()},__class__:D};var O=function(t,e,i,s,n){null==i&&(i=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==s?new H(null,null,null,null,null,null,null,null,null):s,0<e?(this.window.width=e,this.width=e):this.width=this.window.width,0<i?(this.window.height=i,this.height=i):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==n?new E(null,null,null,null,null,null):n};(s["kha.SystemOptions"]=O).__name__=!0,O.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:O};var gt=function(){};(s["kha.System"]=gt).__name__=!0,gt.start=function(t,e){gt.theTitle=t.title,M.init(t,e)},gt.notifyOnFrames=function(t){gt.renderListeners.push(t)},gt.notifyOnDropFiles=function(t){gt.dropFilesListeners.push(t)},gt.notifyOnCutCopyPaste=function(t,e,i){gt.cutListener=t,gt.copyListener=e,gt.pasteListener=i},gt.render=function(t){for(var e=0,i=gt.renderListeners;e<i.length;){var s=i[e];++e,s(t)}},gt.dropFiles=function(t){for(var e=0,i=gt.dropFilesListeners;e<i.length;){var s=i[e];++e,s(t)}},gt.get_time=function(){return M.getTime()},gt.windowWidth=function(t){return null==t&&(t=0),W.get(t).get_width()},gt.windowHeight=function(t){return null==t&&(t=0),W.get_all()[t].get_height()},gt.get_systemId=function(){return M.getSystemId()};var M=function(){};(s["kha.SystemImpl"]=M).__name__=!0,M.renderCallback=function(){P.executeFrame(),gt.render([M.framebuffer])},M.dropFilesCallback=function(t){gt.dropFiles(t)},M.copyCallback=function(){return null!=gt.copyListener?gt.copyListener():null},M.cutCallback=function(){return null!=gt.cutListener?gt.cutListener():null},M.pasteCallback=function(t){null!=gt.pasteListener&&gt.pasteListener(t)},M.keyboardDownCallback=function(t){M.keyboard.sendDownEvent(t)},M.keyboardUpCallback=function(t){M.keyboard.sendUpEvent(t)},M.keyboardPressCallback=function(t){M.keyboard.sendPressEvent(String.fromCodePoint(t))},M.mouseDownCallback=function(t,e,i){M.mouse.sendDownEvent(0,t,e,i)},M.mouseUpCallback=function(t,e,i){M.mouse.sendUpEvent(0,t,e,i)},M.mouseMoveCallback=function(t,e,i,s){M.mouse.sendMoveEvent(0,t,e,i,s)},M.mouseWheelCallback=function(t){M.mouse.sendWheelEvent(0,t)},M.penDownCallback=function(t,e,i){M.pen.sendDownEvent(0,t,e,i)},M.penUpCallback=function(t,e,i){M.pen.sendUpEvent(0,t,e,i)},M.penMoveCallback=function(t,e,i){M.pen.sendMoveEvent(0,t,e,i)},M.gamepadAxisCallback=function(t,e,i){M.gamepads[t].sendAxisEvent(e,i)},M.gamepadButtonCallback=function(t,e,i){M.gamepads[t].sendButtonEvent(e,i)},M.audioCallback=function(t){var e=new Float32Array(t);M.audioOutputData=e,G._callCallback(t);for(var i=0,s=t;i<s;){var n=i++,r=G._readSample();M.audioOutputData[n]=r}for(var a=0,o=t;a<o;){var l=a++;Krom.writeAudioBuffer(M.audioOutputData[l])}},M.init=function(t,e){Krom.init(t.title,t.width,t.height,t.framebuffer.samplesPerPixel,t.framebuffer.verticalSync,t.window.mode,t.window.windowFeatures,2),M.start=Krom.getTime(),j.trace=function(t,e){var i=null!=e?e.className+":"+e.lineNumber+": "+rt.string(t):rt.string(t);Krom.log(st.substr(i,0,511))},new W(0),P.init(),V.init();var i=new Ne;M.framebuffer=new x(0,null,null,i),M.framebuffer.init(new Ft(M.framebuffer),new ue(M.framebuffer),i),Krom.setCallback(M.renderCallback),Krom.setDropFilesCallback(M.dropFilesCallback),Krom.setCutCopyPasteCallback(M.cutCallback,M.copyCallback,M.pasteCallback),M.keyboard=new Ce,M.mouse=new Te,M.pen=new Le,M.gamepads=[];for(var s=0,n=M.maxGamepads;s<n;){var r=s++;M.gamepads[r]=new xe(r)}Krom.setKeyboardDownCallback(M.keyboardDownCallback),Krom.setKeyboardUpCallback(M.keyboardUpCallback),Krom.setKeyboardPressCallback(M.keyboardPressCallback),Krom.setMouseDownCallback(M.mouseDownCallback),Krom.setMouseUpCallback(M.mouseUpCallback),Krom.setMouseMoveCallback(M.mouseMoveCallback),Krom.setMouseWheelCallback(M.mouseWheelCallback),Krom.setPenDownCallback(M.penDownCallback),Krom.setPenUpCallback(M.penUpCallback),Krom.setPenMoveCallback(M.penMoveCallback),Krom.setGamepadAxisCallback(M.gamepadAxisCallback),Krom.setGamepadButtonCallback(M.gamepadButtonCallback),G._init(),X._init(),Krom.setAudioCallback(M.audioCallback),P.start(),e(W.get(0))},M.getTime=function(){return Krom.getTime()-M.start},M.getSystemId=function(){return Krom.systemId()},M.getMouse=function(t){return M.mouse},M.getKeyboard=function(t){return M.keyboard},M.lockMouse=function(){if(!M.isMouseLocked()){Krom.lockMouse();for(var t=0,e=M.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},M.unlockMouse=function(){if(M.isMouseLocked()){Krom.unlockMouse();for(var t=0,e=M.mouseLockListeners;t<e.length;){var i=e[t];++t,i()}}},M.canLockMouse=function(){return Krom.canLockMouse()},M.isMouseLocked=function(){return Krom.isMouseLocked()},M.notifyOfMouseLockChange=function(t,e){M.canLockMouse()&&null!=t&&M.mouseLockListeners.push(t)},M.removeFromMouseLockChange=function(t,e){M.canLockMouse()&&null!=t&&st.remove(M.mouseLockListeners,t)},M.hideSystemCursor=function(){Krom.showMouse(!1)},M.showSystemCursor=function(){Krom.showMouse(!0)},M.getGamepadId=function(t){return"unkown"};var F=function(){};(s["kha.Video"]=F).__name__=!0,F.__interfaces__=[C],F.prototype={__class__:F};var W=function(t){this.num=t,W.windows.push(this)};(s["kha.Window"]=W).__name__=!0,W.get=function(t){return W.windows[t]},W.get_all=function(){return W.windows},W.prototype={num:null,get_width:function(){return Krom.windowWidth(this.num)},get_height:function(){return Krom.windowHeight(this.num)},get_vSynced:function(){return!0},__class__:W};var H=function(t,e,i,s,n,r,a,o,l){null==l&&(l=0),null==a&&(a=!0),null==n&&(n=600),null==s&&(s=800),null==i&&(i=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=null,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=i,this.width=s,this.height=n,this.display=null==r?m.get_primary():r,this.visible=a,this.windowFeatures=null==o?7:o,this.mode=l};(s["kha.WindowOptions"]=H).__name__=!0,H.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:H};var U=function(){};(s["kha.audio1.AudioChannel"]=U).__name__=!0,U.prototype={__class__:U};var G=function(){};(s["kha.audio2.Audio"]=G).__name__=!0,G._init=function(){G.buffer=new z(8192,2,44100)},G._callCallback=function(t){if(null!=G.buffer)if(null!=G.audioCallback)G.audioCallback(t,G.buffer);else for(var e=0,i=t;e<i;){e++;G.buffer.data[G.buffer.writeLocation]=0,G.buffer.writeLocation+=1,G.buffer.writeLocation>=G.buffer.size&&(G.buffer.writeLocation=0)}},G._readSample=function(){if(null==G.buffer)return 0;var t=G.buffer.data[G.buffer.readLocation];return G.buffer.readLocation+=1,G.buffer.readLocation>=G.buffer.size&&(G.buffer.readLocation=0),t};var X=function(){};(s["kha.audio2.Audio1"]=X).__name__=!0,X._init=function(){var t=new Array(16);X.soundChannels=t;var e=new Array(16);X.streamChannels=e;var i=new Array(16);X.internalSoundChannels=i;var s=new Array(16);X.internalStreamChannels=s;var n=new Float32Array(512);X.sampleCache1=n;var r=new Float32Array(512);X.sampleCache2=r,G.audioCallback=X.mix},X.mix=function(t,e){if(X.sampleCache1.length<t){var i=new Float32Array(t);X.sampleCache1=i;var s=new Float32Array(t);X.sampleCache2=s}for(var n=0,r=t;n<r;){var a=n++;X.sampleCache2[a]=0}X.internalSoundChannels[0]=X.soundChannels[0],X.internalSoundChannels[1]=X.soundChannels[1],X.internalSoundChannels[2]=X.soundChannels[2],X.internalSoundChannels[3]=X.soundChannels[3],X.internalSoundChannels[4]=X.soundChannels[4],X.internalSoundChannels[5]=X.soundChannels[5],X.internalSoundChannels[6]=X.soundChannels[6],X.internalSoundChannels[7]=X.soundChannels[7],X.internalSoundChannels[8]=X.soundChannels[8],X.internalSoundChannels[9]=X.soundChannels[9],X.internalSoundChannels[10]=X.soundChannels[10],X.internalSoundChannels[11]=X.soundChannels[11],X.internalSoundChannels[12]=X.soundChannels[12],X.internalSoundChannels[13]=X.soundChannels[13],X.internalSoundChannels[14]=X.soundChannels[14],X.internalSoundChannels[15]=X.soundChannels[15],X.internalStreamChannels[0]=X.streamChannels[0],X.internalStreamChannels[1]=X.streamChannels[1],X.internalStreamChannels[2]=X.streamChannels[2],X.internalStreamChannels[3]=X.streamChannels[3],X.internalStreamChannels[4]=X.streamChannels[4],X.internalStreamChannels[5]=X.streamChannels[5],X.internalStreamChannels[6]=X.streamChannels[6],X.internalStreamChannels[7]=X.streamChannels[7],X.internalStreamChannels[8]=X.streamChannels[8],X.internalStreamChannels[9]=X.streamChannels[9],X.internalStreamChannels[10]=X.streamChannels[10],X.internalStreamChannels[11]=X.streamChannels[11],X.internalStreamChannels[12]=X.streamChannels[12],X.internalStreamChannels[13]=X.streamChannels[13],X.internalStreamChannels[14]=X.streamChannels[14],X.internalStreamChannels[15]=X.streamChannels[15];for(var o=0,l=X.internalSoundChannels;o<l.length;){var h=l[o];if(++o,null!=h&&!h.get_finished()){h.nextSamples(X.sampleCache1,t,e.samplesPerSecond);for(var u=0,c=t;u<c;){var d=u++;X.sampleCache2[d]+=X.sampleCache1[d]*h.get_volume()}}}for(var _=0,f=X.internalStreamChannels;_<f.length;){var g=f[_];if(++_,null!=g&&!g.get_finished()){g.nextSamples(X.sampleCache1,t,e.samplesPerSecond);for(var p=0,v=t;p<v;){var m=p++;X.sampleCache2[m]+=X.sampleCache1[m]*g.get_volume()}}}for(var w=0,b=t;w<b;){var S=w++,y=X.sampleCache2[S],x=y<1?y:1;e.data[e.writeLocation]=-1<x?x:-1,e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}};var Y=function(t){this.paused=!1,this.looping=t,this.myVolume=1,this.myPosition=0};(s["kha.audio2.AudioChannel"]=Y).__name__=!0,Y.__interfaces__=[U],Y.prototype={data:null,myVolume:null,myPosition:null,paused:null,looping:null,nextSamples:function(t,e,i){if(this.paused)for(var s=0,n=e;s<n;){t[s++]=0}else{for(var r=0,a=0;r<e;){for(var o=this.data.length-this.myPosition,l=o<e-r?o:e-r;a<l;)t[r]=this.data[this.myPosition],++this.myPosition,++a,++r;if(!this.looping)break;a=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;r<e;)t[r]=0,++r}},get_volume:function(){return this.myVolume},get_finished:function(){return this.myPosition>=this.data.length},__class__:Y};var z=function(t,e,i){this.size=t;var s=new Float32Array(t);this.data=s,this.channels=e,this.samplesPerSecond=i,this.readLocation=0,this.writeLocation=0};(s["kha.audio2.Buffer"]=z).__name__=!0,z.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:z};var pt=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e,this.reader=mt.openFromBytes(t)};(s["kha.audio2.StreamChannel"]=pt).__name__=!0,pt.__interfaces__=[U],pt.prototype={reader:null,atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,i){if(this.paused)for(var s=0,n=e;s<n;){t[s++]=0}else{var r=2*this.reader.read(t,e/2|0,2,i,!0);if(r<e){this.loop?this.reader.set_currentMillisecond(0):this.atend=!0;for(var a=r,o=e;a<o;){t[a++]=0}}}},get_volume:function(){return this.myVolume},get_finished:function(){return this.atend},__class__:pt};var vt=function(){};(s["kha.audio2.ogg.tools.Crc32"]=vt).__name__=!0,vt.init=function(){if(null==vt.table){var t=new Array(256);vt.table=t;for(var e=0;e<256;){var i=e++,s=i<<24;s=(s=(s=(s=(s=(s=(s=(s=s<<1^(Vt.gte(s,1<<31)?79764919:0))<<1^(Vt.gte(s,1<<31)?79764919:0))<<1^(Vt.gte(s,1<<31)?79764919:0))<<1^(Vt.gte(s,1<<31)?79764919:0))<<1^(Vt.gte(s,1<<31)?79764919:0))<<1^(Vt.gte(s,1<<31)?79764919:0))<<1^(Vt.gte(s,1<<31)?79764919:0))<<1^(Vt.gte(s,1<<31)?79764919:0),vt.table[i]=s}}};var mt=function(t,e,i){this.seekFunc=e,this.inputLength=i,this.decoder=St.start(t),this.decoder.setupSampleNumber(e,i),this.loopStart=this.get_header().comment.get_loopStart(),this.loopLength=this.get_header().comment.get_loopLength()};(s["kha.audio2.ogg.vorbis.Reader"]=mt).__name__=!0,mt.openFromBytes=function(t){var e=new ct(t),i=e;return new mt(e,function(t){mt.seekBytes(i,t)},t.length)},mt.seekBytes=function(t,e){t.set_position(e)},mt.readAll=function(t,e,i){null==i&&(i=!1);var s=new ct(t),n=St.start(s),r=s;n.setupSampleNumber(function(t){mt.seekBytes(r,t)},t.length);for(var a=n.header,o=new Float32Array(4096*a.channel);;){for(var l=n.read(o,4096,a.channel,a.sampleRate,i),h=0,u=l*a.channel;h<u;){var c=h++;e.writeFloat(o[c])}if(0==l)break;l}return n.header},mt.prototype={decoder:null,get_header:function(){return this.decoder.header},get_currentSample:function(){return this.decoder.currentSample},set_currentSample:function(t){return this.decoder.seek(this.seekFunc,this.inputLength,t),this.decoder.currentSample},get_currentMillisecond:function(){var t=this.get_currentSample(),e=this.get_header().sampleRate;return Vt.toFloat(t)/Vt.toFloat(e)*1e3},set_currentMillisecond:function(t){return this.set_currentSample(Math.floor(Vt.toFloat(this.get_header().sampleRate)*(t/1e3))),this.get_currentMillisecond()},loopStart:null,loopLength:null,seekFunc:null,inputLength:null,read:function(t,e,i,s,n){return null==n&&(n=!1),this.decoder.ensurePosition(this.seekFunc),null==e&&(e=this.decoder.totalSample),null==i&&(i=this.get_header().channel),null==s&&(s=this.get_header().sampleRate),this.decoder.read(t,e,i,s,n)},__class__:mt};var wt=function(t){this.nextSeg=0,this.firstDecode=!1,this.bytesInSeg=0,this.validBits=0,this.input=t,this.inputPosition=0,this.page=new Rt,vt.init()};(s["kha.audio2.ogg.vorbis.VorbisDecodeState"]=wt).__name__=!0,wt.prototype={page:null,eof:null,pFirst:null,pLast:null,validBits:null,inputPosition:null,input:null,discardSamplesDeferred:null,segments:null,bytesInSeg:null,firstDecode:null,nextSeg:null,acc:null,lastSeg:null,lastSegWhich:null,endSegWithKnownLoc:null,knownLocForPacket:null,error:null,currentLoc:null,currentLocValid:null,firstAudioPageOffset:null,setup:function(t,e){this.inputPosition+=1;var i=this.input.readByte();this.inputPosition+=i;for(var s=new Array(i),n=0,r=i;n<r;){s[n++]=this.input.readByte()}if(this.segments=s,this.endSegWithKnownLoc=-2,-1!=t||-1!=e)for(var a=i-1;0<=a&&!(this.segments[a]<255);)0<=a&&(this.endSegWithKnownLoc=a,this.knownLocForPacket=t),--a;if(this.firstDecode){for(var o=0,l=new Pt,h=0,u=i;h<u;){var c=h++;o+=this.segments[c]}o+=27+i,l.pageStart=this.firstAudioPageOffset,l.pageEnd=l.pageStart+o,l.firstDecodedSample=0,l.lastDecodedSample=t,this.pFirst=l}this.nextSeg=0},clone:function(t){var e=Object.create(wt.prototype);return t(this.inputPosition),e.input=this.input,e.eof=this.eof,e.validBits=this.validBits,e.discardSamplesDeferred=this.discardSamplesDeferred,e.firstDecode=this.firstDecode,e.nextSeg=this.nextSeg,e.bytesInSeg=this.bytesInSeg,e.acc=e.acc,e.lastSeg=this.lastSeg,e.lastSegWhich=this.lastSegWhich,e.currentLoc=this.currentLoc,e.currentLocValid=this.currentLocValid,e.inputPosition=this.inputPosition,e.firstAudioPageOffset=this.firstAudioPageOffset,e.error=this.error,e.segments=this.segments,e.pFirst=this.pFirst,e.pLast=this.pLast,e.page=this.page.clone(),e},next:function(){if(this.lastSeg)return 0;if(-1==this.nextSeg){this.lastSegWhich=this.segments.length-1;try{this.page.start(this)}catch(t){var e=t instanceof zt?t.val:t;if(e instanceof Yt)return this.lastSeg=!0,this.error=e,0;throw t}if(0==(1&this.page.flag))throw new zt(new Yt(Zt.CONTINUED_PACKET_FLAG_INVALID,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:171,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"next"}))}var t=this.segments[this.nextSeg++];return t<255&&(this.lastSeg=!0,this.lastSegWhich=this.nextSeg-1),this.nextSeg>=this.segments.length&&(this.nextSeg=-1),this.bytesInSeg=t},startPacket:function(){for(;-1==this.nextSeg;)if(this.page.start(this),0!=(1&this.page.flag))throw new zt(new Yt(Zt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:193,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"startPacket"}));this.lastSeg=!1,this.validBits=0,this.bytesInSeg=0},maybeStartPacket:function(){if(-1==this.nextSeg){var e,t,i,s,n=!1;try{this.inputPosition+=1,e=this.input.readByte()}catch(t){var r=t instanceof zt?t.val:t;if(!(r instanceof S))throw t;n=!0,e=0}if(n)return!1;if(79==e?(this.inputPosition+=1,s=103!=this.input.readByte()):s=!0,s?i=!0:(this.inputPosition+=1,i=103!=this.input.readByte()),i?t=!0:(this.inputPosition+=1,t=83!=this.input.readByte()),t)throw new zt(new Yt(Zt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:218,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"maybeStartPacket"}));this.page.startWithoutCapturePattern(this)}return this.startPacket(),!0},readBits:function(t){if(this.validBits<0)return 0;if(this.validBits<t){if(24<t)return this.readBits(24)+(this.readBits(t-24)<<24);for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next())){this.validBits=-1;break}if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<t))break}if(this.validBits<0)return 0;var e=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,e}var i=this.acc&(1<<t)-1;return this.acc=this.acc>>>t,this.validBits-=t,i},firstPageValidate:function(){if(1!=this.segments.length)throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"segmentCount",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:308,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}));if(30!=this.segments[0])throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:311,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"firstPageValidate"}))},startFirstDecode:function(){this.firstAudioPageOffset=this.inputPosition,this.firstDecode=!0},prepHuffman:function(){if(this.validBits<=24)for(0==this.validBits&&(this.acc=0);;){if(0==this.bytesInSeg&&(this.lastSeg||0==this.next()))return;if(this.bytesInSeg--,this.inputPosition+=1,this.acc=this.acc+(this.input.readByte()<<this.validBits),this.validBits+=8,!(this.validBits<=24))break}},finishDecodePacket:function(t,e,i){var s=i.left.start,n=!1,r=e>>1;if(this.firstDecode)this.currentLoc=-r,this.discardSamplesDeferred=e-i.right.end,n=!0,this.firstDecode=!1;else if(0!=this.discardSamplesDeferred)i.left.start+=this.discardSamplesDeferred,s=i.left.start,this.discardSamplesDeferred=0;else;if(this.lastSegWhich==this.endSegWithKnownLoc){if(n&&0!=(4&this.page.flag)){var a=this.knownLocForPacket-(e-i.right.end);if(a<this.currentLoc+i.right.end){var o=a<this.currentLoc?0:a-this.currentLoc;return o+=i.left.start,this.currentLoc+=o,{len:o,left:s,right:i.right.start}}}this.currentLoc=this.knownLocForPacket-(r-i.left.start),n=!0}return n&&(this.currentLoc+=i.right.start-i.left.start),{len:i.right.end,left:s,right:i.right.start}},getSampleNumber:function(t,e){var i=this.inputPosition,s=Vt.gte(e,65536)&&Vt.gte(e-65536,this.firstAudioPageOffset)?e-65536:this.firstAudioPageOffset;t(this.inputPosition=s);var n=0,r=!1,a=this.findPage(t,e);switch(a._hx_index){case 0:var o=a.last;n=a.end,r=o;break;case 1:throw new zt(new Yt(Zt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}))}var l=this.inputPosition;t:for(;!r;){t(this.inputPosition=n);var h=this.findPage(t,e);switch(h._hx_index){case 0:var u=h.last;n=h.end,r=u;break;case 1:break t}s=l+1,l=this.inputPosition}t(this.inputPosition=l),this.inputPosition+=6;for(var c=new Array(6),d=0;d<6;){c[d++]=this.input.readByte()}this.inputPosition+=4;var _=this.input.readInt32();this.inputPosition+=4;var f=this.input.readInt32();if(-1==_&&-1==f||0<f)throw new zt(new Yt(Zt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:553,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"getSampleNumber"}));return this.pLast=new Pt,this.pLast.pageStart=l,this.pLast.pageEnd=n,this.pLast.lastDecodedSample=_,this.pLast.firstDecodedSample=null,this.pLast.afterPreviousPageStart=s,t(this.inputPosition=i),_},findPage:function(t,e){try{for(;;){if(this.inputPosition+=1,79==this.input.readByte()){var i,s,n=this.inputPosition;if(e<n-25)return bt.NotFound;if(this.inputPosition+=1,103==this.input.readByte()?(this.inputPosition+=1,s=103!=this.input.readByte()):s=!0,s?i=!0:(this.inputPosition+=1,i=83!=this.input.readByte()),i)continue;var r=new Array(27);if(r[0]=79,r[1]=103,r[2]=103,r[3]=83,this.inputPosition+=1,r[4]=this.input.readByte(),this.inputPosition+=1,r[5]=this.input.readByte(),this.inputPosition+=1,r[6]=this.input.readByte(),this.inputPosition+=1,r[7]=this.input.readByte(),this.inputPosition+=1,r[8]=this.input.readByte(),this.inputPosition+=1,r[9]=this.input.readByte(),this.inputPosition+=1,r[10]=this.input.readByte(),this.inputPosition+=1,r[11]=this.input.readByte(),this.inputPosition+=1,r[12]=this.input.readByte(),this.inputPosition+=1,r[13]=this.input.readByte(),this.inputPosition+=1,r[14]=this.input.readByte(),this.inputPosition+=1,r[15]=this.input.readByte(),this.inputPosition+=1,r[16]=this.input.readByte(),this.inputPosition+=1,r[17]=this.input.readByte(),this.inputPosition+=1,r[18]=this.input.readByte(),this.inputPosition+=1,r[19]=this.input.readByte(),this.inputPosition+=1,r[20]=this.input.readByte(),this.inputPosition+=1,r[21]=this.input.readByte(),this.inputPosition+=1,r[22]=this.input.readByte(),this.inputPosition+=1,r[23]=this.input.readByte(),this.inputPosition+=1,r[24]=this.input.readByte(),this.inputPosition+=1,r[25]=this.input.readByte(),this.inputPosition+=1,r[26]=this.input.readByte(),0!=r[4]){t(this.inputPosition=n);continue}var a=r[22]+(r[23]<<8)+(r[24]<<16)+(r[25]<<24);r[22]=0,r[23]=0,r[24]=0;for(var o=r[25]=0,l=0;l<27;){var h=l++;o=o<<8^vt.table[r[h]^o>>>24]}var u=0;try{for(var c=0,d=r[26];c<d;){c++;this.inputPosition+=1;var _=this.input.readByte();o=o<<8^vt.table[_^o>>>24],u+=_}for(var f=0,g=u;f<g;){f++;this.inputPosition+=1;var p=this.input.readByte();o=o<<8^vt.table[p^o>>>24]}}catch(t){var v=t instanceof zt?t.val:t;if(v instanceof S){return bt.NotFound}throw t}if(o==a){var m=this.inputPosition;return t(this.inputPosition=n-1),bt.Found(m,0!=(4&r[5]))}}}}catch(t){var w=t instanceof zt?t.val:t;if(w instanceof S){return bt.NotFound}throw t}},analyzePage:function(t,e){var i=new Pt,s=new Array(255);i.pageStart=this.inputPosition,this.inputPosition+=27;for(var n=new Array(27),r=0;r<27;){n[r++]=this.input.readByte()}var a=n,o=a[26];this.inputPosition+=o;for(var l=new Array(o),h=0,u=o;h<u;){l[h++]=this.input.readByte()}for(var c=l,d=0,_=0,f=a[26];_<f;){d+=c[_++]}if(i.pageEnd=i.pageStart+27+a[26]+d,i.lastDecodedSample=a[6]+(a[7]<<8)+(a[8]<<16)+(a[9]<<16),0!=(4&a[5]))return i.firstDecodedSample=null,t(this.inputPosition=i.pageStart),i;for(var g=0,p=0==(1&a[5]),v=e.modes.length,m=0,w=a[26];m<w;){var b=m++;if(p){if(0==c[b])return t(this.inputPosition=i.pageStart),null;this.inputPosition+=1;var S=this.input.readByte();if(0!=(1&S))return t(this.inputPosition=i.pageStart),null;S>>=1;var y=v-1,x=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(v<=(S&=(1<<(y<16384?y<16?x[y]:y<512?5+x[y>>5]:10+x[y>>10]:y<16777216?y<524288?15+x[y>>15]:20+x[y>>20]:y<536870912?25+x[y>>25]:y<-2147483648?30+x[y>>30]:0))-1))return t(this.inputPosition=i.pageStart),null;s[g++]=e.modes[S].blockflag;var E=c[b]-1;this.inputPosition+=E;for(var C=new Array(E),k=0,T=E;k<T;){C[k++]=this.input.readByte()}}else{var L=c[b];this.inputPosition+=L;for(var B=new Array(L),I=0,N=L;I<N;){B[I++]=this.input.readByte()}}p=c[b]<255}var A=0;1<g&&(A+=s[g-1]?e.blocksize1:e.blocksize0);for(var R=g-2;1<=R;)s[--R]?s[R+1]?A+=e.blocksize1>>1:A+=(e.blocksize1-e.blocksize0>>2)+(e.blocksize0>>1):A+=e.blocksize0>>1,--R;return i.firstDecodedSample=i.lastDecodedSample-A,t(this.inputPosition=i.pageStart),i},decodeScalarRaw:function(t){this.prepHuffman();var e=t.codewordLengths,i=t.codewords,s=t.sortedCodewords;if(8<t.entries?null!=s:null!=i){for(var n=this.acc,r=(n=(-16711936&(n=(-252645136&(n=(-858993460&(n=(-1431655766&n)>>>1|(1431655765&n)<<1))>>>2|(858993459&n)<<2))>>>4|(252645135&n)<<4))>>>8|(16711935&n)<<8)>>>16|n<<16,a=0,o=t.sortedEntries;1<o;){var l=a+(o>>1);Vt.gte(r,s[l])?(a=l,o-=o>>1):o>>=1}t.sparse||(a=t.sortedValues[a]);var h=e[a];return this.validBits>=h?(this.acc=this.acc>>>h,this.validBits-=h,a):(this.validBits=0,-1)}for(var u=0,c=t.entries;u<c;){var d=u++,_=e[d];if(255!=_&&i[d]==(this.acc&(1<<_)-1))return this.validBits>=_?(this.acc=this.acc>>>_,this.validBits-=_,d):(this.validBits=0,-1)}return this.error=new Yt(Zt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:847,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"decodeScalarRaw"}),this.validBits=0,-1},__class__:wt};var bt=b["kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult"]={__ename__:!0,__constructs__:["Found","NotFound"],Found:(i=function(t,e){return{_hx_index:0,end:t,last:e,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:n}},i.__params__=["end","last"],i),NotFound:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis._VorbisDecodeState.FindPageResult",toString:n}},St=function(t,e){this.header=t,this.decodeState=e,this.totalSample=null,this.currentSample=0,this.previousLength=0;var i=new Array(t.channel);this.channelBuffers=i;var s=new Array(t.channel);this.previousWindow=s;var n=new Array(t.channel);this.finalY=n;for(var r=0,a=t.channel;r<a;){var o=r++,l=this.channelBuffers,h=new Array(t.blocksize1);l[o]=h;var u=this.previousWindow,c=new Array(t.blocksize1/2|0);u[o]=c,this.finalY[o]=[]}var d=new Array(2);this.a=d;var _=new Array(2);this.b=_;var f=new Array(2);this.c=f;var g=new Array(2);this.window=g;var p=new Array(2);this.bitReverseData=p,this.initBlocksize(0,t.blocksize0),this.initBlocksize(1,t.blocksize1)};(s["kha.audio2.ogg.vorbis.VorbisDecoder"]=St).__name__=!0,St.start=function(t){var e=new wt(t),i=Lt.read(e),s=new St(i,e);return e.startFirstDecode(),s.pumpFirstFrame(),s},St.prototype={previousWindow:null,previousLength:null,finalY:null,a:null,b:null,c:null,window:null,bitReverseData:null,channelBuffers:null,channelBufferStart:null,channelBufferEnd:null,header:null,currentSample:null,totalSample:null,decodeState:null,read:function(t,e,i,s,n){var r=this.header.sampleRate;if(0!=(Vt.toFloat(s)%Vt.toFloat(r)|0))throw new zt("Unsupported sampleRate : can't convert "+rt.string(Vt.toFloat(this.header.sampleRate))+" to "+s);if(i%this.header.channel!=0)throw new zt("Unsupported channels : can't convert "+this.header.channel+" to "+i);var a=this.header.sampleRate,o=Vt.toFloat(s)/Vt.toFloat(a)|0,l=i/this.header.channel|0,h=0,u=Math.floor(e/o);null!=this.totalSample&&u>this.totalSample-this.currentSample&&(u=this.totalSample-this.currentSample);for(var c=0;h<u;){var d=this.channelBufferEnd-this.channelBufferStart;u-h<=d&&(d=u-h);for(var _=this.channelBufferStart,f=this.channelBufferStart+d;_<f;)for(var g=_++,p=0,v=o;p<v;){p++;for(var m=0,w=this.header.channel;m<w;)for(var b=m++,S=0,y=l;S<y;){S++;var x=this.channelBuffers[b][g];1<x?x=1:x<-1&&(x=-1),n&&(t[c]=x,++c)}}if(h+=d,this.channelBufferStart+=d,h==u||0==this.getFrameFloat())break}for(var E=h,C=u;E<C;){E++;for(var k=0,T=o;k<T;){k++;for(var L=0,B=this.header.channel;L<B;){L++;for(var I=0,N=l;I<N;){I++;n&&(t[c]=0,++c)}}}}return this.currentSample+=u,u*o},skipSamples:function(t){var e=0;for(null!=this.totalSample&&t>this.totalSample-this.currentSample&&(t=this.totalSample-this.currentSample);e<t;){var i=this.channelBufferEnd-this.channelBufferStart;if(t-e<=i&&(i=t-e),e+=i,this.channelBufferStart+=i,e==t||0==this.getFrameFloat())break}return this.currentSample+=t,t},setupSampleNumber:function(t,e){null==this.totalSample&&(this.totalSample=this.decodeState.getSampleNumber(t,e))},seek:function(t,e,i){if(this.currentSample!=i){if(null==this.totalSample&&(this.setupSampleNumber(t,e),0==this.totalSample))throw new zt(new Yt(Zt.CANT_FIND_LAST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:187,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));i<0&&(i=0);var s=this.decodeState.pFirst,n=this.decodeState.pLast;if(i>=n.lastDecodedSample&&(i=n.lastDecodedSample-1),i<s.lastDecodedSample)this.seekFrameFromPage(t,s.pageStart,0,i);else{for(var r=0;s.pageEnd<n.pageStart;){var a=s.pageEnd,o=n.afterPreviousPageStart,l=s.lastDecodedSample,h=n.lastDecodedSample;if(null==l||null==h)throw new zt(new Yt(Zt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:219,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));Vt.gt(o,a+4e3)&&(o-=4e3);var u=a+Math.floor(Vt.toFloat(o-a)/Vt.toFloat(h-l)*(i-l));if(4<=r){var c=a+(o-a>>>1);u=8<=r?c:Vt.gt(c,u)?u+(c-u>>>1):c+(u-c>>>1)}switch(++r,t(this.decodeState.inputPosition=u),this.decodeState.findPage(t,e)._hx_index){case 0:break;case 1:throw new zt(new Yt(Zt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:249,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}))}var d=this.decodeState.analyzePage(t,this.header);if(null==d)throw new zt(new Yt(Zt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:255,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));d.afterPreviousPageStart=u,d.pageStart!=n.pageStart?i<d.lastDecodedSample?n=d:s=d:n=d}if(!(s.lastDecodedSample<=i&&i<n.lastDecodedSample))throw new zt(new Yt(Zt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:275,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"seek"}));this.seekFrameFromPage(t,n.pageStart,s.lastDecodedSample,i)}}},seekFrameFromPage:function(t,e,i,s){var n=0,r=i;t(this.decodeState.inputPosition=e),this.decodeState.nextSeg=-1;for(var a=0,o=0,l=null,h=null;;){l=h,h=this.decodeState.clone(t);var u=this.decodeInitial();if(null==u){h=l;break}o=u.left.start,a=u.left.end;var c=0==n?a:o;if(s<r+u.right.start-c)break;for(var d=this.decodeState;0!=d.bytesInSeg||!d.lastSeg&&0!=d.next();)d.bytesInSeg--,d.inputPosition+=1,d.input.readByte();r+=u.right.start-c,++n}this.decodeState=h,t(this.decodeState.inputPosition),this.previousLength=0,this.pumpFirstFrame(),this.currentSample=r,this.skipSamples(s-r)},ensurePosition:function(t){t(this.decodeState.inputPosition)},getFrameFloat:function(){var t=this.decodePacket();if(null==t)return this.channelBufferStart=this.channelBufferEnd=0,0;var e=this.finishFrame(t);return this.channelBufferStart=t.left,this.channelBufferEnd=t.left+e,e},pumpFirstFrame:function(){this.finishFrame(this.decodePacket())},finishFrame:function(t){var e=t.len,i=t.right,s=t.left;if(0!=this.previousLength)for(var n=this.previousLength,r=this.getWindow(n),a=0,o=this.header.channel;a<o;)for(var l=a++,h=this.channelBuffers[l],u=this.previousWindow[l],c=0,d=n;c<d;){var _=c++;h[s+_]=h[s+_]*r[_]+u[_]*r[n-1-_]}var f=this.previousLength;this.previousLength=e-i;for(var g=0,p=this.header.channel;g<p;)for(var v=g++,m=this.previousWindow[v],w=this.channelBuffers[v],b=0,S=e-i;b<S;){var y=b++;m[y]=w[i+y]}return 0==f?0:(e<i&&(i=e),i-s)},getWindow:function(t){return(t<<=1)==this.header.blocksize0?this.window[0]:t==this.header.blocksize1?this.window[1]:null},initBlocksize:function(t,e){var i=e>>1,s=e>>2,n=e>>3,r=this.a,a=new Array(i);r[t]=a;var o=this.b,l=new Array(i);o[t]=l;var h=this.c,u=new Array(s);h[t]=u;var c=this.window,d=new Array(i);c[t]=d;var _=this.bitReverseData,f=new Array(n);_[t]=f,yt.computeTwiddleFactors(e,this.a[t],this.b[t],this.c[t]),yt.computeWindow(e,this.window[t]),yt.computeBitReverse(e,this.bitReverseData[t])},inverseMdct:function(t,e,i){for(var s=i?1:0,n=this.a[s],r=this.b[s],a=this.c[s],o=this.bitReverseData[s],l=e>>1,h=e>>2,u=e>>3,c=new Array(l),d=l-2,_=0,f=0,g=l;f!=g;)c[d+1]=t[f]*n[_]-t[f+2]*n[_+1],c[d]=t[f]*n[_+1]+t[f+2]*n[_],d-=2,_+=2,f+=4;for(f=l-3;0<=d;)c[d+1]=-t[f+2]*n[_]- -t[f]*n[_+1],c[d]=-t[f+2]*n[_+1]+-t[f]*n[_],d-=2,_+=2,f-=4;for(var p=t,v=c,m=l-8,w=h,b=0,S=h,y=0;0<=m;){var x=v[w+1]-v[b+1],E=v[w]-v[b];p[S+1]=v[w+1]+v[b+1],p[S]=v[w]+v[b],p[y+1]=x*n[m+4]-E*n[m+5],p[y]=E*n[m+4]+x*n[m+5],x=v[w+3]-v[b+3],E=v[w+2]-v[b+2],p[S+3]=v[w+3]+v[b+3],p[S+2]=v[w+2]+v[b+2],p[y+3]=x*n[m]-E*n[m+1],p[y+2]=E*n[m]+x*n[m+1],m-=8,S+=4,y+=4,w+=4,b+=4}for(var C=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],k=(e<16384?e<16?C[e]:e<512?5+C[e>>5]:10+C[e>>10]:e<16777216?e<524288?15+C[e>>15]:20+C[e>>20]:e<536870912?25+C[e>>25]:e<-2147483648?30+C[e>>30]:0)-1,T=l-1-0*h,L=T,B=T+-(e>>3),I=0,N=1+(e>>4>>2);0<--N;){var A=p[L]-p[B],R=p[L+-1]-p[B+-1],P=L,V=p;V[P]=V[P]+p[B];var D=L+-1,O=p;O[D]=O[D]+p[B+-1],p[B]=A*n[I]-R*n[I+1],p[B+-1]=R*n[I]+A*n[I+1],I+=8,A=p[L+-2]-p[B+-2],R=p[L+-3]-p[B+-3];var M=L+-2,F=p;F[M]=F[M]+p[B+-2];var W=L+-3,H=p;H[W]=H[W]+p[B+-3],p[B+-2]=A*n[I]-R*n[I+1],p[B+-3]=R*n[I]+A*n[I+1],I+=8,A=p[L+-4]-p[B+-4],R=p[L+-5]-p[B+-5];var U=L+-4,G=p;G[U]=G[U]+p[B+-4];var X=L+-5,Y=p;Y[X]=Y[X]+p[B+-5],p[B+-4]=A*n[I]-R*n[I+1],p[B+-5]=R*n[I]+A*n[I+1],I+=8,A=p[L+-6]-p[B+-6],R=p[L+-7]-p[B+-7];var z=L+-6,Z=p;Z[z]=Z[z]+p[B+-6];var K=L+-7,j=p;j[K]=j[K]+p[B+-7],p[B+-6]=A*n[I]-R*n[I+1],p[B+-7]=R*n[I]+A*n[I+1],I+=8,L-=8,B-=8}for(var J=l-1-h,Q=J,q=J+-(e>>3),$=0,tt=1+(e>>4>>2);0<--tt;){var et=p[Q]-p[q],it=p[Q+-1]-p[q+-1],st=Q,nt=p;nt[st]=nt[st]+p[q];var rt=Q+-1,at=p;at[rt]=at[rt]+p[q+-1],p[q]=et*n[$]-it*n[$+1],p[q+-1]=it*n[$]+et*n[$+1],$+=8,et=p[Q+-2]-p[q+-2],it=p[Q+-3]-p[q+-3];var ot=Q+-2,lt=p;lt[ot]=lt[ot]+p[q+-2];var ht=Q+-3,ut=p;ut[ht]=ut[ht]+p[q+-3],p[q+-2]=et*n[$]-it*n[$+1],p[q+-3]=it*n[$]+et*n[$+1],$+=8,et=p[Q+-4]-p[q+-4],it=p[Q+-5]-p[q+-5];var ct=Q+-4,dt=p;dt[ct]=dt[ct]+p[q+-4];var _t=Q+-5,ft=p;ft[_t]=ft[_t]+p[q+-5],p[q+-4]=et*n[$]-it*n[$+1],p[q+-5]=it*n[$]+et*n[$+1],$+=8,et=p[Q+-6]-p[q+-6],it=p[Q+-7]-p[q+-7];var gt=Q+-6,pt=p;pt[gt]=pt[gt]+p[q+-6];var vt=Q+-7,mt=p;mt[vt]=mt[vt]+p[q+-7],p[q+-6]=et*n[$]-it*n[$+1],p[q+-7]=it*n[$]+et*n[$+1],$+=8,Q-=8,q-=8}for(var wt=l-1-0*u,bt=0,St=wt,yt=wt+-(e>>4),xt=1+(e>>5>>2);0<--xt;){var Et=p[St]-p[yt],Ct=p[St+-1]-p[yt+-1],kt=St,Tt=p;Tt[kt]=Tt[kt]+p[yt];var Lt=St+-1,Bt=p;Bt[Lt]=Bt[Lt]+p[yt+-1],p[yt]=Et*n[bt]-Ct*n[bt+1],p[yt+-1]=Ct*n[bt]+Et*n[bt+1],bt+=16,Et=p[St+-2]-p[yt+-2],Ct=p[St+-3]-p[yt+-3];var It=St+-2,Nt=p;Nt[It]=Nt[It]+p[yt+-2];var At=St+-3,Rt=p;Rt[At]=Rt[At]+p[yt+-3],p[yt+-2]=Et*n[bt]-Ct*n[bt+1],p[yt+-3]=Ct*n[bt]+Et*n[bt+1],bt+=16,Et=p[St+-4]-p[yt+-4],Ct=p[St+-5]-p[yt+-5];var Pt=St+-4,Vt=p;Vt[Pt]=Vt[Pt]+p[yt+-4];var Dt=St+-5,Ot=p;Ot[Dt]=Ot[Dt]+p[yt+-5],p[yt+-4]=Et*n[bt]-Ct*n[bt+1],p[yt+-5]=Ct*n[bt]+Et*n[bt+1],bt+=16,Et=p[St+-6]-p[yt+-6],Ct=p[St+-7]-p[yt+-7];var Mt=St+-6,Ft=p;Ft[Mt]=Ft[Mt]+p[yt+-6];var Wt=St+-7,Ht=p;Ht[Wt]=Ht[Wt]+p[yt+-7],p[yt+-6]=Et*n[bt]-Ct*n[bt+1],p[yt+-7]=Ct*n[bt]+Et*n[bt+1],St-=8,yt-=8,bt+=16}for(var Ut=l-1-u,Gt=0,Xt=Ut,Yt=Ut+-(e>>4),zt=1+(e>>5>>2);0<--zt;){var Zt=p[Xt]-p[Yt],Kt=p[Xt+-1]-p[Yt+-1],jt=Xt,Jt=p;Jt[jt]=Jt[jt]+p[Yt];var Qt=Xt+-1,qt=p;qt[Qt]=qt[Qt]+p[Yt+-1],p[Yt]=Zt*n[Gt]-Kt*n[Gt+1],p[Yt+-1]=Kt*n[Gt]+Zt*n[Gt+1],Gt+=16,Zt=p[Xt+-2]-p[Yt+-2],Kt=p[Xt+-3]-p[Yt+-3];var $t=Xt+-2,te=p;te[$t]=te[$t]+p[Yt+-2];var ee=Xt+-3,ie=p;ie[ee]=ie[ee]+p[Yt+-3],p[Yt+-2]=Zt*n[Gt]-Kt*n[Gt+1],p[Yt+-3]=Kt*n[Gt]+Zt*n[Gt+1],Gt+=16,Zt=p[Xt+-4]-p[Yt+-4],Kt=p[Xt+-5]-p[Yt+-5];var se=Xt+-4,ne=p;ne[se]=ne[se]+p[Yt+-4];var re=Xt+-5,ae=p;ae[re]=ae[re]+p[Yt+-5],p[Yt+-4]=Zt*n[Gt]-Kt*n[Gt+1],p[Yt+-5]=Kt*n[Gt]+Zt*n[Gt+1],Gt+=16,Zt=p[Xt+-6]-p[Yt+-6],Kt=p[Xt+-7]-p[Yt+-7];var oe=Xt+-6,le=p;le[oe]=le[oe]+p[Yt+-6];var he=Xt+-7,ue=p;ue[he]=ue[he]+p[Yt+-7],p[Yt+-6]=Zt*n[Gt]-Kt*n[Gt+1],p[Yt+-7]=Kt*n[Gt]+Zt*n[Gt+1],Xt-=8,Yt-=8,Gt+=16}for(var ce=l-1-2*u,de=0,_e=ce,fe=ce+-(e>>4),ge=1+(e>>5>>2);0<--ge;){var pe=p[_e]-p[fe],ve=p[_e+-1]-p[fe+-1],me=_e,we=p;we[me]=we[me]+p[fe];var be=_e+-1,Se=p;Se[be]=Se[be]+p[fe+-1],p[fe]=pe*n[de]-ve*n[de+1],p[fe+-1]=ve*n[de]+pe*n[de+1],de+=16,pe=p[_e+-2]-p[fe+-2],ve=p[_e+-3]-p[fe+-3];var ye=_e+-2,xe=p;xe[ye]=xe[ye]+p[fe+-2];var Ee=_e+-3,Ce=p;Ce[Ee]=Ce[Ee]+p[fe+-3],p[fe+-2]=pe*n[de]-ve*n[de+1],p[fe+-3]=ve*n[de]+pe*n[de+1],de+=16,pe=p[_e+-4]-p[fe+-4],ve=p[_e+-5]-p[fe+-5];var ke=_e+-4,Te=p;Te[ke]=Te[ke]+p[fe+-4];var Le=_e+-5,Be=p;Be[Le]=Be[Le]+p[fe+-5],p[fe+-4]=pe*n[de]-ve*n[de+1],p[fe+-5]=ve*n[de]+pe*n[de+1],de+=16,pe=p[_e+-6]-p[fe+-6],ve=p[_e+-7]-p[fe+-7];var Ie=_e+-6,Ne=p;Ne[Ie]=Ne[Ie]+p[fe+-6];var Ae=_e+-7,Re=p;Re[Ae]=Re[Ae]+p[fe+-7],p[fe+-6]=pe*n[de]-ve*n[de+1],p[fe+-7]=ve*n[de]+pe*n[de+1],_e-=8,fe-=8,de+=16}for(var Pe=l-1-3*u,Ve=0,De=Pe,Oe=Pe+-(e>>4),Me=1+(e>>5>>2);0<--Me;){var Fe=p[De]-p[Oe],We=p[De+-1]-p[Oe+-1],He=De,Ue=p;Ue[He]=Ue[He]+p[Oe];var Ge=De+-1,Xe=p;Xe[Ge]=Xe[Ge]+p[Oe+-1],p[Oe]=Fe*n[Ve]-We*n[Ve+1],p[Oe+-1]=We*n[Ve]+Fe*n[Ve+1],Ve+=16,Fe=p[De+-2]-p[Oe+-2],We=p[De+-3]-p[Oe+-3];var Ye=De+-2,ze=p;ze[Ye]=ze[Ye]+p[Oe+-2];var Ze=De+-3,Ke=p;Ke[Ze]=Ke[Ze]+p[Oe+-3],p[Oe+-2]=Fe*n[Ve]-We*n[Ve+1],p[Oe+-3]=We*n[Ve]+Fe*n[Ve+1],Ve+=16,Fe=p[De+-4]-p[Oe+-4],We=p[De+-5]-p[Oe+-5];var je=De+-4,Je=p;Je[je]=Je[je]+p[Oe+-4];var Qe=De+-5,qe=p;qe[Qe]=qe[Qe]+p[Oe+-5],p[Oe+-4]=Fe*n[Ve]-We*n[Ve+1],p[Oe+-5]=We*n[Ve]+Fe*n[Ve+1],Ve+=16,Fe=p[De+-6]-p[Oe+-6],We=p[De+-7]-p[Oe+-7];var $e=De+-6,ti=p;ti[$e]=ti[$e]+p[Oe+-6];var ei=De+-7,ii=p;ii[ei]=ii[ei]+p[Oe+-7],p[Oe+-6]=Fe*n[Ve]-We*n[Ve+1],p[Oe+-7]=We*n[Ve]+Fe*n[Ve+1],De-=8,Oe-=8,Ve+=16}for(var si=2,ni=k-3>>1;si<ni;)for(var ri=si++,ai=e>>ri+2,oi=ai>>1,li=0,hi=1<<ri+1;li<hi;)for(var ui=l-1-ai*li++,ci=1<<ri+3,di=0,_i=ui,fi=ui+-oi,gi=1+(e>>ri+4>>2);0<--gi;){var pi=p[_i]-p[fi],vi=p[_i+-1]-p[fi+-1],mi=_i,wi=p;wi[mi]=wi[mi]+p[fi];var bi=_i+-1,Si=p;Si[bi]=Si[bi]+p[fi+-1],p[fi]=pi*n[di]-vi*n[di+1],p[fi+-1]=vi*n[di]+pi*n[di+1],di+=ci,pi=p[_i+-2]-p[fi+-2],vi=p[_i+-3]-p[fi+-3];var yi=_i+-2,xi=p;xi[yi]=xi[yi]+p[fi+-2];var Ei=_i+-3,Ci=p;Ci[Ei]=Ci[Ei]+p[fi+-3],p[fi+-2]=pi*n[di]-vi*n[di+1],p[fi+-3]=vi*n[di]+pi*n[di+1],di+=ci,pi=p[_i+-4]-p[fi+-4],vi=p[_i+-5]-p[fi+-5];var ki=_i+-4,Ti=p;Ti[ki]=Ti[ki]+p[fi+-4];var Li=_i+-5,Bi=p;Bi[Li]=Bi[Li]+p[fi+-5],p[fi+-4]=pi*n[di]-vi*n[di+1],p[fi+-5]=vi*n[di]+pi*n[di+1],di+=ci,pi=p[_i+-6]-p[fi+-6],vi=p[_i+-7]-p[fi+-7];var Ii=_i+-6,Ni=p;Ni[Ii]=Ni[Ii]+p[fi+-6];var Ai=_i+-7,Ri=p;Ri[Ai]=Ri[Ai]+p[fi+-7],p[fi+-6]=pi*n[di]-vi*n[di+1],p[fi+-7]=vi*n[di]+pi*n[di+1],_i-=8,fi-=8,di+=ci}for(var Pi=k-3>>1,Vi=k-6;Pi<Vi;)for(var Di=Pi++,Oi=e>>Di+2,Mi=1<<Di+3,Fi=Oi>>1,Wi=1<<Di+1,Hi=0,Ui=l-1,Gi=(e>>Di+6)+1;0<--Gi;){for(var Xi=n[Hi],Yi=n[Hi+1],zi=n[Hi+Mi],Zi=n[Hi+Mi+1],Ki=n[Hi+2*Mi],ji=n[Hi+2*Mi+1],Ji=n[Hi+3*Mi],Qi=n[Hi+3*Mi+1],qi=Ui,$i=Ui+-Fi,ts=Wi+1;0<--ts;){var es=p[qi]-p[$i],is=p[qi+-1]-p[$i+-1];p[qi]=p[qi]+p[$i],p[qi+-1]=p[qi+-1]+p[$i+-1],p[$i]=es*Xi-is*Yi,p[$i+-1]=is*Xi+es*Yi,es=p[qi+-2]-p[$i+-2],is=p[qi+-3]-p[$i+-3],p[qi+-2]=p[qi+-2]+p[$i+-2],p[qi+-3]=p[qi+-3]+p[$i+-3],p[$i+-2]=es*zi-is*Zi,p[$i+-3]=is*zi+es*Zi,es=p[qi+-4]-p[$i+-4],is=p[qi+-5]-p[$i+-5],p[qi+-4]=p[qi+-4]+p[$i+-4],p[qi+-5]=p[qi+-5]+p[$i+-5],p[$i+-4]=es*Ki-is*ji,p[$i+-5]=is*Ki+es*ji,es=p[qi+-6]-p[$i+-6],is=p[qi+-7]-p[$i+-7],p[qi+-6]=p[qi+-6]+p[$i+-6],p[qi+-7]=p[qi+-7]+p[$i+-7],p[$i+-6]=es*Ji-is*Qi,p[$i+-7]=is*Ji+es*Qi,qi-=Oi,$i-=Oi}Hi+=4*Mi,Ui-=8}for(var ss=l-1,ns=n[e>>3],rs=ss,as=ss-16*(e>>5);as<rs;){var os=p[rs],ls=p[rs+-8];p[rs+-8]=os-ls,p[rs]=os+ls,os=p[rs+-1],ls=p[rs+-9],p[rs+-9]=os-ls,p[rs+-1]=os+ls;var hs=(os=p[rs+-2])-(ls=p[rs+-10]);p[rs+-2]=os+ls;var us=(os=p[rs+-3])-(ls=p[rs+-11]);p[rs+-3]=os+ls,p[rs+-10]=(hs+us)*ns,p[rs+-11]=(us-hs)*ns,os=p[rs+-4],hs=(ls=p[rs+-12])-os,p[rs+-4]=os+ls,us=(os=p[rs+-5])-(ls=p[rs+-13]),p[rs+-5]=os+ls,p[rs+-12]=us,p[rs+-13]=hs,os=p[rs+-6],hs=(ls=p[rs+-14])-os,p[rs+-6]=os+ls,us=(os=p[rs+-7])-(ls=p[rs+-15]),p[rs+-7]=os+ls,p[rs+-14]=(hs+us)*ns,p[rs+-15]=(hs-us)*ns;var cs=p[rs],ds=p[rs+-4],_s=cs-ds,fs=cs+ds,gs=(cs=p[rs+-2])+(ds=p[rs+-6]),ps=cs-ds;p[rs]=fs+gs,p[rs+-2]=fs-gs;var vs=p[rs+-3]-p[rs+-7];p[rs+-4]=_s+vs,p[rs+-6]=_s-vs;var ms=(cs=p[rs+-1])-(ds=p[rs+-5]),ws=cs+ds,bs=p[rs+-3]+p[rs+-7];p[rs+-1]=ws+bs,p[rs+-3]=ws-bs,p[rs+-5]=ms-ps,p[rs+-7]=ms+ps;var Ss=rs-8,ys=p[Ss],xs=p[Ss+-4],Es=ys-xs,Cs=ys+xs,ks=(ys=p[Ss+-2])+(xs=p[Ss+-6]),Ts=ys-xs;p[Ss]=Cs+ks,p[Ss+-2]=Cs-ks;var Ls=p[Ss+-3]-p[Ss+-7];p[Ss+-4]=Es+Ls,p[Ss+-6]=Es-Ls;var Bs=(ys=p[Ss+-1])-(xs=p[Ss+-5]),Is=ys+xs,Ns=p[Ss+-3]+p[Ss+-7];p[Ss+-1]=Is+Ns,p[Ss+-3]=Is-Ns,p[Ss+-5]=Bs-Ts,p[Ss+-7]=Bs+Ts,rs-=16}for(var As=0,Rs=h-4,Ps=l-4;0<=Rs;){var Vs=o[As];v[Ps+3]=p[Vs],v[Ps+2]=p[Vs+1],v[Rs+3]=p[Vs+2],v[Rs+2]=p[Vs+3],Vs=o[As+1],v[Ps+1]=p[Vs],v[Ps]=p[Vs+1],v[Rs+1]=p[Vs+2],v[Rs]=p[Vs+3],Rs-=4,Ps-=4,As+=2}for(var Ds=0,Os=0,Ms=l-4;Os<Ms;){var Fs=v[Os]-v[Ms+2],Ws=v[Os+1]+v[Ms+3],Hs=a[Ds+1]*Fs+a[Ds]*Ws,Us=a[Ds+1]*Ws-a[Ds]*Fs,Gs=v[Os]+v[Ms+2],Xs=v[Os+1]-v[Ms+3];v[Os]=Gs+Hs,v[Os+1]=Xs+Us,v[Ms+2]=Gs-Hs,v[Ms+3]=Us-Xs,Fs=v[Os+2]-v[Ms],Ws=v[Os+3]+v[Ms+1],Hs=a[Ds+3]*Fs+a[Ds+2]*Ws,Us=a[Ds+3]*Ws-a[Ds+2]*Fs,Gs=v[Os+2]+v[Ms],Xs=v[Os+3]-v[Ms+1],v[Os+2]=Gs+Hs,v[Os+3]=Xs+Us,v[Ms]=Gs-Hs,v[Ms+1]=Us-Xs,Ds+=4,Os+=4,Ms-=4}for(var Ys=l-8,zs=l-8,Zs=0,Ks=l-4,js=l,Js=e-4;0<=zs;){var Qs=c[zs+6]*r[Ys+7]-c[zs+7]*r[Ys+6],qs=-c[zs+6]*r[Ys+6]-c[zs+7]*r[Ys+7];t[Zs]=Qs,t[Ks+3]=-Qs,t[js]=qs,t[Js+3]=qs;var $s=c[zs+4]*r[Ys+5]-c[zs+5]*r[Ys+4],tn=-c[zs+4]*r[Ys+4]-c[zs+5]*r[Ys+5];t[Zs+1]=$s,t[Ks+2]=-$s,t[js+1]=tn,t[Js+2]=tn,Qs=c[zs+2]*r[Ys+3]-c[zs+3]*r[Ys+2],qs=-c[zs+2]*r[Ys+2]-c[zs+3]*r[Ys+3],t[Zs+2]=Qs,t[Ks+1]=-Qs,t[js+2]=qs,t[Js+1]=qs,$s=c[zs]*r[Ys+1]-c[zs+1]*r[Ys],tn=-c[zs]*r[Ys]-c[zs+1]*r[Ys+1],t[Zs+3]=$s,t[Ks]=-$s,t[js+3]=tn,t[Js]=tn,Ys-=8,zs-=8,Zs+=4,js+=4,Ks-=4,Js-=4}},decodePacket:function(){var t=this.decodeInitial();return null==t?null:this.decodePacketRest(t)},decodeInitial:function(){for(this.channelBufferStart=this.channelBufferEnd=0;;){if(!this.decodeState.maybeStartPacket())return null;if(0==this.decodeState.readBits(1))break;for(;;){var t,e=this.decodeState;if(0!=e.bytesInSeg||!e.lastSeg&&0!=e.next()?(e.bytesInSeg--,e.inputPosition+=1,t=e.input.readByte()):t=-1,e.validBits=0,-1==t)break}}var i=this.header.modes.length-1,s=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],n=this.decodeState.readBits(i<16384?i<16?s[i]:i<512?5+s[i>>5]:10+s[i>>10]:i<16777216?i<524288?15+s[i>>15]:20+s[i>>20]:i<536870912?25+s[i>>25]:i<-2147483648?30+s[i>>30]:0);if(-1==n||n>=this.header.modes.length)throw new zt(new Yt(Zt.SEEK_FAILED,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:519,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodeInitial"}));var r,a,o,l=this.header.modes[n];l.blockflag?(r=this.header.blocksize1,a=this.decodeState.readBits(1),o=this.decodeState.readBits(1)):(a=o=0,r=this.header.blocksize0);var h=r>>1;return{mode:n,left:l.blockflag&&0==a?{start:r-this.header.blocksize0>>2,end:r+this.header.blocksize0>>2}:{start:0,end:h},right:l.blockflag&&0==o?{start:3*r-this.header.blocksize0>>2,end:3*r+this.header.blocksize0>>2}:{start:h,end:r}}},decodePacketRest:function(t){for(var e=this.header.modes[t.mode],i=new Array(256),s=new Array(256),n=e.blockflag?this.header.blocksize1:this.header.blocksize0,r=this.header.mapping[e.mapping],a=n>>1,o=[256,128,86,64],l=this.header.codebooks,h=0,u=this.header.channel;h<u;){var c=h++,d=r.chan[c].mux;i[c]=!1;var _=this.header.floorConfig[r.submapFloor[d]];if(0==_.type)throw new zt(new Yt(Zt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecoder.hx",lineNumber:581,className:"kha.audio2.ogg.vorbis.VorbisDecoder",methodName:"decodePacketRest"}));var f=_.floor1;if(0!=this.decodeState.readBits(1)){var g=[],p=new Array(256),v=o[f.floor1Multiplier-1],m=2,w=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];(g=this.finalY[c])[0]=this.decodeState.readBits((v<16384?v<16?w[v]:v<512?5+w[v>>5]:10+w[v>>10]:v<16777216?v<524288?15+w[v>>15]:20+w[v>>20]:v<536870912?25+w[v>>25]:v<-2147483648?30+w[v>>30]:0)-1);var b=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];g[1]=this.decodeState.readBits((v<16384?v<16?b[v]:v<512?5+b[v>>5]:10+b[v>>10]:v<16777216?v<524288?15+b[v>>15]:20+b[v>>20]:v<536870912?25+b[v>>25]:v<-2147483648?30+b[v>>30]:0)-1);for(var S=0,y=f.partitions;S<y;){var x=S++,E=f.partitionClassList[x],C=f.classDimensions[E],k=f.classSubclasses[E],T=(1<<k)-1,L=0;if(0!=k){var B=l[f.classMasterbooks[E]],I=this.decodeState;I.validBits<10&&I.prepHuffman();var N,A=B.fastHuffman[1023&I.acc];if(0<=A){var R=B.codewordLengths[A];I.acc=I.acc>>>R,I.validBits-=R,I.validBits<0?(I.validBits=0,N=-1):N=A}else N=I.decodeScalarRaw(B);B.sparse&&(N=B.sortedValues[N]),L=N}for(var P=f.subclassBooks[E],V=0,D=C;V<D;){V++;var O=P[L&T];L>>=k;var M,F=m++;if(0<=O){var W=this.decodeState,H=l[O];W.validBits<10&&W.prepHuffman();var U,G=H.fastHuffman[1023&W.acc];if(0<=G){var X=H.codewordLengths[G];W.acc=W.acc>>>X,W.validBits-=X,W.validBits<0?(W.validBits=0,U=-1):U=G}else U=W.decodeScalarRaw(H);H.sparse&&(U=H.sortedValues[U]),M=U}else M=0;g[F]=M}}if(-1==this.decodeState.validBits){i[c]=!0;continue}p[0]=p[1]=!0;for(var Y=f.neighbors,z=f.xlist,Z=2,K=f.values;Z<K;){var j=Z++,J=Y[j][0],Q=Y[j][1],q=z[J],$=g[J],tt=g[Q]-$,et=z[Q]-q,it=Math.abs(tt)*(z[j]-q)/et|0,st=tt<0?$-it:$+it,nt=g[j],rt=v-st,at=rt<st?2*rt:2*st;0!=nt?(p[J]=p[Q]=!0,p[j]=!0,g[j]=at<=nt?st<rt?nt-st+st:st-nt+rt-1:0!=(1&nt)?st-(nt+1>>1):st+(nt>>1)):(p[j]=!1,g[j]=st)}for(var ot=0,lt=f.values;ot<lt;){var ht=ot++;p[ht]||(g[ht]=-1)}}else i[c]=!0}for(var ut=0,ct=this.header.channel;ut<ct;){var dt=ut++;s[dt]=i[dt]}for(var _t=0,ft=r.couplingSteps;_t<ft;){var gt=_t++;i[r.chan[gt].magnitude]&&i[r.chan[gt].angle]||(i[r.chan[gt].magnitude]=i[r.chan[gt].angle]=!1)}for(var pt=0,vt=r.submaps;pt<vt;){for(var mt=pt++,wt=new Array(this.header.channel),bt=new Array(256),St=0,yt=0,xt=this.header.channel;yt<xt;){var Et=yt++;r.chan[Et].mux==mt&&(i[Et]?(bt[St]=!0,wt[St]=null):(bt[St]=!1,wt[St]=this.channelBuffers[Et]),++St)}var Ct=r.submapResidue[mt];this.header.residueConfig[Ct].decode(this.decodeState,this.header,wt,St,a,bt,this.channelBuffers)}for(var kt=r.couplingSteps,Tt=n>>1;0<=--kt;)for(var Lt=this.channelBuffers[r.chan[kt].magnitude],Bt=this.channelBuffers[r.chan[kt].angle],It=0,Nt=Tt;It<Nt;){var At,Rt,Pt=It++;0<Lt[Pt]?0<Bt[Pt]?(Rt=Lt[Pt],At=Lt[Pt]-Bt[Pt]):(At=Lt[Pt],Rt=Lt[Pt]+Bt[Pt]):0<Bt[Pt]?(Rt=Lt[Pt],At=Lt[Pt]+Bt[Pt]):(At=Lt[Pt],Rt=Lt[Pt]-Bt[Pt]),Lt[Pt]=Rt,Bt[Pt]=At}for(var Vt=0,Dt=this.header.channel;Vt<Dt;){var Ot=Vt++;if(s[Ot])for(var Mt=0,Ft=Tt;Mt<Ft;){var Wt=Mt++;this.channelBuffers[Ot][Wt]=0}else r.doFloor(this.header.floorConfig,Ot,n,this.channelBuffers[Ot],this.finalY[Ot],null)}for(var Ht=0,Ut=this.header.channel;Ht<Ut;){var Gt=Ht++;this.inverseMdct(this.channelBuffers[Gt],n,e.blockflag)}for(var Xt=this.decodeState;0!=Xt.bytesInSeg||!Xt.lastSeg&&0!=Xt.next();)Xt.bytesInSeg--,Xt.inputPosition+=1,Xt.input.readByte();return this.decodeState.finishDecodePacket(this.previousLength,n,t)},__class__:St};var yt=function(){};(s["kha.audio2.ogg.vorbis.VorbisTools"]=yt).__name__=!0,yt.pointCompare=function(t,e){return t.x<e.x?-1:t.x>e.x?1:0},yt.uintAsc=function(t,e){return Vt.gt(e,t)?-1:t==e?0:1},yt.lookup1Values=function(t,e){var i=0|Math.exp(Math.log(t)/e);return(0|Math.pow(i+1,e))<=t&&++i,i},yt.computeWindow=function(t,e){for(var i=t>>1,s=0,n=i;s<n;){var r=s++;e[r]=Math.sin(1.5707963267948966*yt.square(Math.sin((r+.5)/i*.5*3.141592653589793)))}},yt.square=function(t){return t*t},yt.computeBitReverse=function(t,e){for(var i=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],s=(t<16384?t<16?i[t]:t<512?5+i[t>>5]:10+i[t>>10]:t<16777216?t<524288?15+i[t>>15]:20+i[t>>20]:t<536870912?25+i[t>>25]:t<-2147483648?30+i[t>>30]:0)-1,n=0,r=t>>3;n<r;){var a=n++,o=a;o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8,e[a]=(o>>>16|o<<16)>>>32-s+3<<2}},yt.computeTwiddleFactors=function(t,e,i,s){for(var n=t>>3,r=0,a=0,o=t>>2;a<o;){var l=a++;e[r]=Math.cos(4*l*3.141592653589793/t),e[r+1]=-Math.sin(4*l*3.141592653589793/t),i[r]=.5*Math.cos(3.141592653589793*(r+1)/t/2),i[r+1]=.5*Math.sin(3.141592653589793*(r+1)/t/2),r+=2}for(var h=0,u=0,c=n;u<c;){u++;s[h]=Math.cos(2*(h+1)*3.141592653589793/t),s[h+1]=-Math.sin(2*(h+1)*3.141592653589793/t),h+=2}},yt.drawLine=function(t,e,i,s,n,r){if(null==yt.integerDivideTable){var a=new Array(32);yt.integerDivideTable=a;for(var o=0;o<32;){var l=o++,h=yt.integerDivideTable,u=new Array(64);h[l]=u;for(var c=1;c<64;){var d=c++;yt.integerDivideTable[l][d]=l/d|0}}}var _,f,g=n-i,p=s-e,v=g<0?-g:g,m=e,w=i,b=0;p<64&&v<32?f=g<0?(_=-yt.integerDivideTable[v][p])-1:(_=yt.integerDivideTable[v][p])+1:(_=g/p|0,f=g<0?_-1:_+1),v-=(_<0?-_:_)*p,r<s&&(s=r);var S=m,y=t;y[S]=y[S]*yt.INVERSE_DB_TABLE[w];for(var x=m+1,E=s;x<E;){p<=(b+=v)?(b-=p,w+=f):w+=_;var C=x++,k=t;k[C]=k[C]*yt.INVERSE_DB_TABLE[w]}};var xt=function(){};(s["kha.audio2.ogg.vorbis.data.Codebook"]=xt).__name__=!0,xt.read=function(t){var e=new xt;if(66!=t.readBits(8)||67!=t.readBits(8)||86!=t.readBits(8))throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:40,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));var i=t.readBits(8);e.dimensions=(t.readBits(8)<<8)+i;var s=t.readBits(8),n=t.readBits(8);e.entries=(t.readBits(8)<<16)+(n<<8)+s;var r=t.readBits(1);e.sparse=0==r&&0!=t.readBits(1);var a=new Array(e.entries);e.sparse||(e.codewordLengths=a);var o,l=0;if(0!=r)for(var h=0,u=t.readBits(5)+1;h<e.entries;){var c=e.entries-h,d=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4],_=t.readBits(c<16384?c<16?d[c]:c<512?5+d[c>>5]:10+d[c>>10]:c<16777216?c<524288?15+d[c>>15]:20+d[c>>20]:c<536870912?25+d[c>>25]:c<-2147483648?30+d[c>>30]:0);if(h+_>e.entries)throw new zt(new Yt(Zt.INVALID_SETUP,"codebook entrys",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));for(var f=0,g=_;f<g;){a[h+f++]=u}h+=_,++u}else for(var p=0,v=e.entries;p<v;){var m=p++;0!=(e.sparse?t.readBits(1):1)?(a[m]=t.readBits(5)+1,++l):a[m]=255}if(e.sparse&&l>=e.entries>>2&&(e.codewordLengths=a,e.sparse=!1),e.sparse)o=l;else{for(var w=0,b=0,S=e.entries;b<S;){var y=a[b++];10<y&&255!=y&&++w}o=w}e.sortedEntries=o;var x=null;if(e.sparse){if(0!=e.sortedEntries){var E=new Array(e.sortedEntries);e.codewordLengths=E;var C=new Array(e.entries);e.codewords=C,x=new Array(e.entries)}e.entries,e.sortedEntries}else{var k=new Array(e.entries);e.codewords=k}if(!e.computeCodewords(a,e.entries,x))throw new zt(new Yt(Zt.INVALID_SETUP,"compute codewords",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:120,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0!=e.sortedEntries){e.sortedCodewords=[];var T=new Array(e.sortedEntries);e.sortedValues=T,e.computeSortedHuffman(a,x)}if(e.sparse&&(x=null,a=e.codewords=null),e.computeAcceleratedHuffman(),e.lookupType=t.readBits(4),2<e.lookupType)throw new zt(new Yt(Zt.INVALID_SETUP,"codebook lookup type",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:143,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));if(0<e.lookupType){var L=t.readBits(32),B=Vt.toFloat(2097151&L),I=(2145386496&L)>>>21,N=0!=(-2147483648&L)?-B:B;e.minimumValue=N*Math.pow(2,I-788);var A=t.readBits(32),R=Vt.toFloat(2097151&A),P=(2145386496&A)>>>21,V=0!=(-2147483648&A)?-R:R;e.deltaValue=V*Math.pow(2,P-788),e.valueBits=t.readBits(4)+1,e.sequenceP=0!=t.readBits(1),1==e.lookupType?e.lookupValues=yt.lookup1Values(e.entries,e.dimensions):e.lookupValues=e.entries*e.dimensions;for(var D=new Array(e.lookupValues),O=0,M=e.lookupValues;O<M;){var F=O++,W=t.readBits(e.valueBits);if(-1==W)throw new zt(new Yt(Zt.INVALID_SETUP,"fail lookup",{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:161,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"read"}));D[F]=W}var H=new Array(e.lookupValues);e.multiplicands=H;for(var U=0,G=e.lookupValues;U<G;){var X=U++;e.multiplicands[X]=D[X]*e.deltaValue+e.minimumValue}if(2==e.lookupType&&e.sequenceP){for(var Y=1,z=e.lookupValues;Y<z;){var Z=Y++;e.multiplicands[Z]=e.multiplicands[Z-1]}e.sequenceP=!1}}return e},xt.prototype={dimensions:null,entries:null,codewordLengths:null,minimumValue:null,deltaValue:null,valueBits:null,lookupType:null,sequenceP:null,sparse:null,lookupValues:null,multiplicands:null,codewords:null,fastHuffman:null,sortedCodewords:null,sortedValues:null,sortedEntries:null,computeCodewords:function(t,e,i){var s=new Array(32);s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=0,s[16]=0,s[17]=0,s[18]=0,s[19]=0,s[20]=0,s[21]=0,s[22]=0,s[23]=0,s[24]=0,s[25]=0,s[26]=0,s[27]=0,s[28]=0,s[29]=0,s[30]=0;for(var n=s[31]=0;n<e&&!(t[n]<255);)++n;if(n==e)return!0;var r=0,a=r++;this.sparse?(this.codewords[a]=0,this.codewordLengths[a]=t[n],i[a]=n):this.codewords[n]=0;for(var o=0;++o<=t[n];)s[o]=1<<32-o;for(o=n;++o<e;){var l=t[o];if(255!=l){for(;0<l&&0==s[l];)--l;if(0==l)return!1;var h=s[l];s[l]=0;var u=h,c=(u=(-16711936&(u=(-252645136&(u=(-858993460&(u=(-1431655766&u)>>>1|(1431655765&u)<<1))>>>2|(858993459&u)<<2))>>>4|(252645135&u)<<4))>>>8|(16711935&u)<<8)>>>16|u<<16,d=r++;if(this.sparse?(this.codewords[d]=c,this.codewordLengths[d]=t[o],i[d]=o):this.codewords[o]=c,l!=t[o])for(var _=t[o];l<_;)s[_]=h+(1<<32-_),--_}}return!0},computeSortedHuffman:function(t,e){if(this.sparse)for(var i=0,s=this.sortedEntries;i<s;){var n=i++,r=this.codewords[n];r=(-16711936&(r=(-252645136&(r=(-858993460&(r=(-1431655766&r)>>>1|(1431655765&r)<<1))>>>2|(858993459&r)<<2))>>>4|(252645135&r)<<4))>>>8|(16711935&r)<<8,this.sortedCodewords[n]=r>>>16|r<<16}else for(var a=0,o=0,l=this.entries;o<l;){var h=o++,u=t[h];if(this.sparse||255!=u&&10<u){var c=this.codewords[h];c=(-16711936&(c=(-252645136&(c=(-858993460&(c=(-1431655766&c)>>>1|(1431655765&c)<<1))>>>2|(858993459&c)<<2))>>>4|(252645135&c)<<4))>>>8|(16711935&c)<<8,this.sortedCodewords[a++]=c>>>16|c<<16}}this.sortedCodewords[this.sortedEntries]=-1,this.sortedCodewords.sort(yt.uintAsc);for(var d=0,_=this.sparse?this.sortedEntries:this.entries;d<_;){var f=d++,g=this.sparse?t[e[f]]:t[f];if(this.sparse||255!=g&&10<g){for(var p=this.codewords[f],v=(p=(-16711936&(p=(-252645136&(p=(-858993460&(p=(-1431655766&p)>>>1|(1431655765&p)<<1))>>>2|(858993459&p)<<2))>>>4|(252645135&p)<<4))>>>8|(16711935&p)<<8)>>>16|p<<16,m=0,w=this.sortedEntries;1<w;){var b=m+(w>>1);Vt.gte(v,this.sortedCodewords[b])?(m=b,w-=w>>1):w>>=1}this.sparse?(this.sortedValues[m]=e[f],this.codewordLengths[m]=g):this.sortedValues[m]=f}}},computeAcceleratedHuffman:function(){var t=new Array(1024);this.fastHuffman=t,this.fastHuffman[0]=-1;for(var e=0;e<1024;){var i=e++;this.fastHuffman[i]=-1}for(var s=0,n=this.sparse?this.sortedEntries:this.entries;s<n;){var r=s++;if(this.codewordLengths[r]<=10){var a;if(this.sparse){var o=this.sortedCodewords[r];a=(o=(-16711936&(o=(-252645136&(o=(-858993460&(o=(-1431655766&o)>>>1|(1431655765&o)<<1))>>>2|(858993459&o)<<2))>>>4|(252645135&o)<<4))>>>8|(16711935&o)<<8)>>>16|o<<16}else a=this.codewords[r];for(;a<1024;)this.fastHuffman[a]=r,a+=1<<this.codewordLengths[r]}}},codebookDecode:function(t,e,i,s){t.validBits<10&&t.prepHuffman();var n,r=this.fastHuffman[1023&t.acc];if(0<=r){var a=this.codewordLengths[r];t.acc=t.acc>>>a,t.validBits-=a,t.validBits<0?(t.validBits=0,n=-1):n=r}else n=t.decodeScalarRaw(this);this.sparse&&(n=this.sortedValues[n]);var o=n,l=this.lookupValues,h=this.sequenceP,u=this.multiplicands,c=this.minimumValue;if(o<0)return!1;if(s>this.dimensions&&(s=this.dimensions),1==this.lookupType){for(var d=1,_=0,f=0,g=s;f<g;){var p=f++,v=u[Vt.toFloat(o/d|0)%Vt.toFloat(l)|0]+_,m=i+p,w=e;w[m]=w[m]+v,h&&(_=v+c),d*=l}return!0}if(o*=this.dimensions,h)for(var b=0,S=0,y=s;S<y;){var x=S++,E=u[o+x]+b,C=i+x,k=e;k[C]=k[C]+E,b=E+c}else for(var T=0,L=s;T<L;){var B=T++,I=i+B,N=e;N[I]=N[I]+(u[o+B]+0)}return!0},codebookDecodeStep:function(t,e,i,s,n){t.validBits<10&&t.prepHuffman();var r,a=this.fastHuffman[1023&t.acc];if(0<=a){var o=this.codewordLengths[a];t.acc=t.acc>>>o,t.validBits-=o,t.validBits<0?(t.validBits=0,r=-1):r=a}else r=t.decodeScalarRaw(this);this.sparse&&(r=this.sortedValues[r]);var l=r,h=0;if(l<0)return!1;s>this.dimensions&&(s=this.dimensions);var u=this.lookupValues,c=this.sequenceP,d=this.multiplicands;if(1==this.lookupType){for(var _=1,f=0,g=s;f<g;){var p=f++,v=d[Vt.toFloat(l/_|0)%Vt.toFloat(u)|0]+h,m=i+p*n,w=e;w[m]=w[m]+v,c&&(h=v),_*=u}return!0}l*=this.dimensions;for(var b=0,S=s;b<S;){var y=b++,x=d[l+y]+h,E=i+y*n,C=e;C[E]=C[E]+x,c&&(h=x)}return!0},decodeDeinterleaveRepeat:function(t,e,i,s,n,r,a){var o=this.dimensions;if(0==this.lookupType)throw new zt(new Yt(Zt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:488,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}));for(var l=this.multiplicands,h=this.sequenceP,u=this.lookupValues;0<a;){var c=0;t.validBits<10&&t.prepHuffman();var d,_=this.fastHuffman[1023&t.acc];if(0<=_){var f=this.codewordLengths[_];t.acc=t.acc>>>f,t.validBits-=f,t.validBits<0?(t.validBits=0,d=-1):d=_}else d=t.decodeScalarRaw(this);this.sparse&&(d=this.sortedValues[d]);var g=d;if(g<0){if(0==t.bytesInSeg&&t.lastSeg)return null;throw new zt(new Yt(Zt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Codebook.hx",lineNumber:503,className:"kha.audio2.ogg.vorbis.data.Codebook",methodName:"decodeDeinterleaveRepeat"}))}if(r*i<s+n*i+o&&(o=r*i-(n*i-s)),1==this.lookupType){var p=1;if(h)for(var v=0,m=o;v<m;){v++;var w=l[Vt.toFloat(g/p|0)%Vt.toFloat(u)|0]+c,b=n,S=e[s];S[b]=S[b]+w,++s==i&&(s=0,++n),c=w,p*=u}else for(var y=0,x=o;y<x;){y++;var E=l[Vt.toFloat(g/p|0)%Vt.toFloat(u)|0]+c,C=n,k=e[s];k[C]=k[C]+E,++s==i&&(s=0,++n),p*=u}}else if(g*=this.dimensions,h)for(var T=0,L=o;T<L;){var B=l[g+T++]+c,I=n,N=e[s];N[I]=N[I]+B,++s==i&&(s=0,++n),c=B}else for(var A=0,R=o;A<R;){var P=l[g+A++]+c,V=n,D=e[s];D[V]=D[V]+P,++s==i&&(s=0,++n)}a-=o}return{cInter:s,pInter:n}},residueDecode:function(t,e,i,s,n){if(0==n)for(var r=s/this.dimensions|0,a=0,o=r;a<o;){var l=a++;if(!this.codebookDecodeStep(t,e,i+l,s-i-l,r))return!1}else for(var h=0;h<s;){if(!this.codebookDecode(t,e,i,s-h))return!1;h+=this.dimensions,i+=this.dimensions}return!0},__class__:xt};var Et=function(){this.data=new ot};(s["kha.audio2.ogg.vorbis.data.Comment"]=Et).__name__=!0,Et.prototype={data:null,get_loopStart:function(){return rt.parseInt(this.getString("loopstart"))},get_loopLength:function(){return rt.parseInt(this.getString("looplength"))},add:function(t,e){t=t.toLowerCase();var i=this.data;if(null!=Je[t]?i.existsReserved(t):i.h.hasOwnProperty(t)){var s=this.data;(null!=Je[t]?s.getReserved(t):s.h[t]).push(e)}else{var n=[e],r=this.data;null!=Je[t]?r.setReserved(t,n):r.h[t]=n}},getString:function(t){t=t.toLowerCase();var e=this.data;if(null!=Je[t]?e.existsReserved(t):e.h.hasOwnProperty(t)){var i=this.data;return(null!=Je[t]?i.getReserved(t):i.h[t])[0]}return null},__class__:Et};var Ct=function(){};(s["kha.audio2.ogg.vorbis.data.Floor"]=Ct).__name__=!0,Ct.read=function(t,e){var i=new Ct;if(i.type=t.readBits(16),1<i.type)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:28,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));if(0==i.type){var s=i.floor0=new kt;s.order=t.readBits(8),s.rate=t.readBits(16),s.barkMapSize=t.readBits(16),s.amplitudeBits=t.readBits(6),s.amplitudeOffset=t.readBits(8),s.numberOfBooks=t.readBits(4)+1;for(var n=0,r=s.numberOfBooks;n<r;){var a=n++;s.bookList[a]=t.readBits(8)}throw new zt(new Yt(Zt.FEATURE_NOT_SUPPORTED,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:41,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}var o=[],l=i.floor1=new Tt,h=-1;l.partitions=t.readBits(5);var u=new Array(l.partitions);l.partitionClassList=u;for(var c=0,d=l.partitions;c<d;){var _=c++;l.partitionClassList[_]=t.readBits(4),l.partitionClassList[_]>h&&(h=l.partitionClassList[_])}var f=new Array(h+1);l.classDimensions=f;var g=new Array(h+1);l.classMasterbooks=g;var p=new Array(h+1);l.classSubclasses=p;var v=new Array(h+1);l.subclassBooks=v;for(var m=0,w=h+1;m<w;){var b=m++;if(l.classDimensions[b]=t.readBits(3)+1,l.classSubclasses[b]=t.readBits(2),0!=l.classSubclasses[b]&&(l.classMasterbooks[b]=t.readBits(8),l.classMasterbooks[b]>=e.length))throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:64,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}));var S=1<<l.classSubclasses[b],y=l.subclassBooks,x=new Array(S);y[b]=x;for(var E=0,C=S;E<C;){var k=E++;if(l.subclassBooks[b][k]=t.readBits(8)-1,l.subclassBooks[b][k]>=e.length)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Floor.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Floor",methodName:"read"}))}}l.floor1Multiplier=t.readBits(2)+1,l.rangebits=t.readBits(4);var T=new Array(250);l.xlist=T,l.xlist[0]=0,l.xlist[1]=1<<l.rangebits,l.values=2;for(var L=0,B=l.partitions;L<B;)for(var I=L++,N=l.partitionClassList[I],A=0,R=l.classDimensions[N];A<R;){A++;l.xlist[l.values]=t.readBits(l.rangebits),l.values++}for(var P=0,V=l.values;P<V;){var D=P++;o.push(new Bt),o[D].x=l.xlist[D],o[D].y=D}o.sort(yt.pointCompare);var O=new Array(l.values);l.sortedOrder=O;for(var M=0,F=l.values;M<F;){var W=M++;l.sortedOrder[W]=o[W].y}var H=new Array(l.values);l.neighbors=H;for(var U=2,G=l.values;U<G;){for(var X=U++,Y=l.xlist,z=-1,Z=65536,K=0,j=0,J=0,Q=X;J<Q;){var q=J++;Y[q]>z&&Y[q]<Y[X]&&(z=Y[K=q]),Y[q]<Z&&Y[q]>Y[X]&&(Z=Y[j=q])}var $=K,tt=j,et=l.neighbors,it=new Array(l.values);et[X]=it,l.neighbors[X][0]=$,l.neighbors[X][1]=tt}return i},Ct.prototype={floor0:null,floor1:null,type:null,__class__:Ct};var kt=function(){};(s["kha.audio2.ogg.vorbis.data.Floor0"]=kt).__name__=!0,kt.prototype={order:null,rate:null,barkMapSize:null,amplitudeBits:null,amplitudeOffset:null,numberOfBooks:null,bookList:null,__class__:kt};var Tt=function(){};(s["kha.audio2.ogg.vorbis.data.Floor1"]=Tt).__name__=!0,Tt.prototype={partitions:null,partitionClassList:null,classDimensions:null,classSubclasses:null,classMasterbooks:null,subclassBooks:null,xlist:null,sortedOrder:null,neighbors:null,floor1Multiplier:null,rangebits:null,values:null,__class__:Tt};var Lt=function(){};(s["kha.audio2.ogg.vorbis.data.Header"]=Lt).__name__=!0,Lt.read=function(t){var e=t.page;if(e.start(t),0==(2&e.flag))throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"not firstPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(4&e.flag))throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"lastPage",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(0!=(1&e.flag))throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"continuedPacket",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.firstPageValidate(),t.inputPosition+=1,1!=t.input.readByte())throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"decodeState head",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:57,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var i,s,n,r,a,o,l=new ut(new ArrayBuffer(6));if(0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,i=t.input.readByte()):i=-1,t.validBits=0,l.b[0]=i,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,s=t.input.readByte()):s=-1,t.validBits=0,l.b[1]=s,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,n=t.input.readByte()):n=-1,t.validBits=0,l.b[2]=n,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,r=t.input.readByte()):r=-1,t.validBits=0,l.b[3]=r,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,a=t.input.readByte()):a=-1,t.validBits=0,l.b[4]=a,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,o=t.input.readByte()):o=-1,t.validBits=0,l.b[5]=o,"vorbis"!=l.toString())throw new zt(new Yt(Zt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));t.inputPosition+=4;var h=t.input.readInt32();if(0!=h)throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"vorbis version : "+h,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:66,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var u=new Lt;if(t.inputPosition+=1,u.channel=t.input.readByte(),0==u.channel)throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"no channel",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:73,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(16<u.channel)throw new zt(new Yt(Zt.TOO_MANY_CHANNELS,"too many channels",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:75,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.inputPosition+=4,u.sampleRate=t.input.readInt32(),0==u.sampleRate)throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,"no sampling rate",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:80,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=4,u.maximumBitRate=t.input.readInt32(),t.inputPosition+=4,u.nominalBitRate=t.input.readInt32(),t.inputPosition+=4,u.minimumBitRate=t.input.readInt32(),t.inputPosition+=1;var c=t.input.readByte(),d=15&c,_=c>>4;if(u.blocksize0=1<<d,u.blocksize1=1<<_,d<6||13<d)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:93,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(_<6||13<_)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:96,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(_<d)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:99,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.inputPosition+=1;var f=t.input.readByte();if(0==(1&f))throw new zt(new Yt(Zt.INVALID_FIRST_PAGE,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:105,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));t.page.start(t),t.startPacket();for(var g=0,p=new dt;0!=(g=t.next());)t.inputPosition+=g,p.write(t.input.read(g)),t.bytesInSeg=0;var v=new ct(p.getBytes());v.readByte(),v.read(6);var m,w=v.readInt32();u.vendor=v.readString(w),u.comment=new Et;for(var b=0,S=v.readInt32();b<S;){b++;var y=v.readInt32(),x=v.readString(y),E=x.indexOf("=");-1!=E&&u.comment.add(x.substring(0,E),x.substring(E+1))}if(0==(1&v.readByte()))throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:141,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(t.startPacket(),0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,m=t.input.readByte()):m=-1,t.validBits=0,5!=m)throw new zt(new Yt(Zt.INVALID_SETUP,"setup packet",{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:149,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));var C,k,T,L,B,I,N=new ut(new ArrayBuffer(6));if(0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,C=t.input.readByte()):C=-1,t.validBits=0,N.b[0]=C,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,k=t.input.readByte()):k=-1,t.validBits=0,N.b[1]=k,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,T=t.input.readByte()):T=-1,t.validBits=0,N.b[2]=T,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,L=t.input.readByte()):L=-1,t.validBits=0,N.b[3]=L,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,B=t.input.readByte()):B=-1,t.validBits=0,N.b[4]=B,0!=t.bytesInSeg||!t.lastSeg&&0!=t.next()?(t.bytesInSeg--,t.inputPosition+=1,I=t.input.readByte()):I=-1,t.validBits=0,N.b[5]=I,"vorbis"!=N.toString())throw new zt(new Yt(Zt.INVALID_SETUP,"vorbis header",{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:301,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"vorbisValidate"}));var A=t.readBits(8)+1,R=new Array(A);u.codebooks=R;for(var P=0,V=A;P<V;){var D=P++;u.codebooks[D]=xt.read(t)}for(var O=0,M=f=t.readBits(6)+1;O<M;){O++;if(0!=t.readBits(16))throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:165,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var F=t.readBits(6)+1,W=new Array(F);u.floorConfig=W;for(var H=0,U=F;H<U;){var G=H++;u.floorConfig[G]=Ct.read(t,u.codebooks)}var X=t.readBits(6)+1,Y=new Array(X);u.residueConfig=Y;for(var z=0,Z=X;z<Z;){var K=z++;u.residueConfig[K]=Dt.read(t,u.codebooks)}var j=t.readBits(6)+1,J=new Array(j);u.mapping=J;for(var Q=0,q=j;Q<q;)for(var $=Q++,tt=It.read(t,u.channel),et=0,it=(u.mapping[$]=tt).submaps;et<it;){var st=et++;if(tt.submapFloor[st]>=u.floorConfig.length)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:191,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}));if(tt.submapResidue[st]>=u.residueConfig.length)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:194,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}var nt=t.readBits(6)+1,rt=new Array(nt);u.modes=rt;for(var at=0,ot=nt;at<ot;){var lt=at++,ht=At.read(t);if((u.modes[lt]=ht).mapping>=u.mapping.length)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Header.hx",lineNumber:205,className:"kha.audio2.ogg.vorbis.data.Header",methodName:"read"}))}for(;0!=t.bytesInSeg||!t.lastSeg&&0!=t.next();)t.bytesInSeg--,t.inputPosition+=1,t.input.readByte();return u},Lt.prototype={maximumBitRate:null,nominalBitRate:null,minimumBitRate:null,sampleRate:null,channel:null,blocksize0:null,blocksize1:null,codebooks:null,floorConfig:null,residueConfig:null,mapping:null,modes:null,comment:null,vendor:null,__class__:Lt};var Bt=function(){};(s["kha.audio2.ogg.vorbis.data.IntPoint"]=Bt).__name__=!0,Bt.prototype={x:null,y:null,__class__:Bt};var It=function(){};(s["kha.audio2.ogg.vorbis.data.Mapping"]=It).__name__=!0,It.read=function(t,e){var i=new It,s=t.readBits(16);if(0!=s)throw new zt(new Yt(Zt.INVALID_SETUP,"mapping type "+s,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));var n=new Array(e);i.chan=n;for(var r=0,a=e;r<a;){var o=r++;i.chan[o]=new Nt}if(0!=t.readBits(1)?i.submaps=t.readBits(4)+1:i.submaps=1,0!=t.readBits(1)){i.couplingSteps=t.readBits(8)+1;for(var l=0,h=i.couplingSteps;l<h;){var u=l++,c=e-1,d=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];i.chan[u].magnitude=t.readBits(c<16384?c<16?d[c]:c<512?5+d[c>>5]:10+d[c>>10]:c<16777216?c<524288?15+d[c>>15]:20+d[c>>20]:c<536870912?25+d[c>>25]:c<-2147483648?30+d[c>>30]:0);var _=e-1,f=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];if(i.chan[u].angle=t.readBits(_<16384?_<16?f[_]:_<512?5+f[_>>5]:10+f[_>>10]:_<16777216?_<524288?15+f[_>>15]:20+f[_>>20]:_<536870912?25+f[_>>25]:_<-2147483648?30+f[_>>30]:0),i.chan[u].magnitude>=e)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:46,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[u].angle>=e)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:49,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(i.chan[u].magnitude==i.chan[u].angle)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:52,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}}else i.couplingSteps=0;if(0!=t.readBits(2))throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:61,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}));if(1<i.submaps)for(var g=0,p=e;g<p;){var v=g++;if(i.chan[v].mux=t.readBits(4),i.chan[v].mux>=i.submaps)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:67,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"read"}))}else for(var m=0,w=e;m<w;){var b=m++;i.chan[b].mux=0}var S=new Array(i.submaps);i.submapFloor=S;var y=new Array(i.submaps);i.submapResidue=y;for(var x=0,E=i.submaps;x<E;){var C=x++;t.readBits(8),i.submapFloor[C]=t.readBits(8),i.submapResidue[C]=t.readBits(8)}return i},It.prototype={couplingSteps:null,chan:null,submaps:null,submapFloor:null,submapResidue:null,doFloor:function(t,e,i,s,n,r){var a=i>>1,o=this.chan[e].mux,l=t[this.submapFloor[o]];if(0==l.type)throw new zt(new Yt(Zt.INVALID_STREAM,null,{fileName:"kha/audio2/ogg/vorbis/data/Mapping.hx",lineNumber:94,className:"kha.audio2.ogg.vorbis.data.Mapping",methodName:"doFloor"}));for(var h=l.floor1,u=0,c=n[0]*h.floor1Multiplier,d=1,_=h.values;d<_;){var f=d++,g=h.sortedOrder[f];if(0<=n[g]){var p=n[g]*h.floor1Multiplier,v=h.xlist[g];yt.drawLine(s,u,c,v,p,a),u=v,c=p}}if(u<a)for(var m=u,w=a;m<w;){var b=m++,S=s;S[b]=S[b]*yt.INVERSE_DB_TABLE[c]}},__class__:It};var Nt=function(){};(s["kha.audio2.ogg.vorbis.data.MappingChannel"]=Nt).__name__=!0,Nt.prototype={magnitude:null,angle:null,mux:null,__class__:Nt};var At=function(){};(s["kha.audio2.ogg.vorbis.data.Mode"]=At).__name__=!0,At.read=function(t){var e=new At;if(e.blockflag=0!=t.readBits(1),e.windowtype=t.readBits(16),e.transformtype=t.readBits(16),e.mapping=t.readBits(8),0!=e.windowtype)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:22,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));if(0!=e.transformtype)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Mode.hx",lineNumber:25,className:"kha.audio2.ogg.vorbis.data.Mode",methodName:"read"}));return e},At.prototype={blockflag:null,mapping:null,windowtype:null,transformtype:null,__class__:At};var Rt=function(){};(s["kha.audio2.ogg.vorbis.data.Page"]=Rt).__name__=!0,Rt.prototype={flag:null,clone:function(){var t=new Rt;return t.flag=this.flag,t},start:function(t){var e,i,s;if(t.inputPosition+=1,79==t.input.readByte()?(t.inputPosition+=1,s=103!=t.input.readByte()):s=!0,s?i=!0:(t.inputPosition+=1,i=103!=t.input.readByte()),i?e=!0:(t.inputPosition+=1,e=83!=t.input.readByte()),e)throw new zt(new Yt(Zt.MISSING_CAPTURE_PATTERN,null,{fileName:"kha/audio2/ogg/vorbis/VorbisDecodeState.hx",lineNumber:324,className:"kha.audio2.ogg.vorbis.VorbisDecodeState",methodName:"capturePattern"}));this.startWithoutCapturePattern(t)},startWithoutCapturePattern:function(t){t.inputPosition+=1;var e=t.input.readByte();if(0!=e)throw new zt(new Yt(Zt.INVALID_STREAM_STRUCTURE_VERSION,""+e,{fileName:"kha/audio2/ogg/vorbis/data/Page.hx",lineNumber:34,className:"kha.audio2.ogg.vorbis.data.Page",methodName:"startWithoutCapturePattern"}));t.inputPosition+=1,this.flag=t.input.readByte(),t.inputPosition+=4;var i=t.input.readInt32();t.inputPosition+=4;var s=t.input.readInt32();t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.inputPosition+=4,t.input.readInt32(),t.setup(i,s)},__class__:Rt};var Pt=function(){};(s["kha.audio2.ogg.vorbis.data.ProbedPage"]=Pt).__name__=!0,Pt.prototype={pageStart:null,pageEnd:null,afterPreviousPageStart:null,firstDecodedSample:null,lastDecodedSample:null,__class__:Pt};var Yt=function(t,e,i){null==e&&(e=""),this.type=t,this.message=e,this.posInfos=i};(s["kha.audio2.ogg.vorbis.data.ReaderError"]=Yt).__name__=!0,Yt.prototype={type:null,message:null,posInfos:null,__class__:Yt};var Zt=b["kha.audio2.ogg.vorbis.data.ReaderErrorType"]={__ename__:!0,__constructs__:["NEED_MORE_DATA","INVALID_API_MIXING","OUTOFMEM","FEATURE_NOT_SUPPORTED","TOO_MANY_CHANNELS","FILE_OPEN_FAILURE","SEEK_WITHOUT_LENGTH","UNEXPECTED_EOF","SEEK_INVALID","INVALID_SETUP","INVALID_STREAM","MISSING_CAPTURE_PATTERN","INVALID_STREAM_STRUCTURE_VERSION","CONTINUED_PACKET_FLAG_INVALID","INCORRECT_STREAM_SERIAL_NUMBER","INVALID_FIRST_PAGE","BAD_PACKET_TYPE","CANT_FIND_LAST_PAGE","SEEK_FAILED","OTHER"],NEED_MORE_DATA:{_hx_index:0,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_API_MIXING:{_hx_index:1,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},OUTOFMEM:{_hx_index:2,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},FEATURE_NOT_SUPPORTED:{_hx_index:3,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},TOO_MANY_CHANNELS:{_hx_index:4,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},FILE_OPEN_FAILURE:{_hx_index:5,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_WITHOUT_LENGTH:{_hx_index:6,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},UNEXPECTED_EOF:{_hx_index:7,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_INVALID:{_hx_index:8,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_SETUP:{_hx_index:9,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_STREAM:{_hx_index:10,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},MISSING_CAPTURE_PATTERN:{_hx_index:11,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_STREAM_STRUCTURE_VERSION:{_hx_index:12,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},CONTINUED_PACKET_FLAG_INVALID:{_hx_index:13,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INCORRECT_STREAM_SERIAL_NUMBER:{_hx_index:14,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},INVALID_FIRST_PAGE:{_hx_index:15,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},BAD_PACKET_TYPE:{_hx_index:16,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},CANT_FIND_LAST_PAGE:{_hx_index:17,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},SEEK_FAILED:{_hx_index:18,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n},OTHER:{_hx_index:19,__enum__:"kha.audio2.ogg.vorbis.data.ReaderErrorType",toString:n}},Dt=function(){};(s["kha.audio2.ogg.vorbis.data.Residue"]=Dt).__name__=!0,Dt.read=function(t,e){var i=new Dt;if(i.type=t.readBits(16),2<i.type)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:29,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}));var s=new Array(64);i.begin=t.readBits(24),i.end=t.readBits(24),i.partSize=t.readBits(24)+1;var n=i.classifications=t.readBits(6)+1;i.classbook=t.readBits(8);for(var r=0,a=i.classifications;r<a;){var o=r++,l=0,h=t.readBits(3);0!=t.readBits(1)&&(l=t.readBits(5)),s[o]=8*l+h}var u=new Array(i.classifications);i.residueBooks=u;for(var c=0,d=i.classifications;c<d;){var _=c++,f=i.residueBooks,g=new Array(8);f[_]=g;for(var p=0;p<8;){var v=p++;if(0!=(s[_]&1<<v)){if(i.residueBooks[_][v]=t.readBits(8),i.residueBooks[_][v]>=e.length)throw new zt(new Yt(Zt.INVALID_SETUP,null,{fileName:"kha/audio2/ogg/vorbis/data/Residue.hx",lineNumber:55,className:"kha.audio2.ogg.vorbis.data.Residue",methodName:"read"}))}else i.residueBooks[_][v]=-1}}var m=e[i.classbook].entries,w=e[i.classbook].dimensions,b=new Array(m);i.classdata=b;for(var S=0,y=m;S<y;)for(var x=S++,E=x,C=w,k=i.classdata,T=new Array(w),L=k[x]=T;0<=--C;)L[C]=E%n,E=E/n|0;return i},Dt.prototype={begin:null,end:null,partSize:null,classifications:null,classbook:null,classdata:null,residueBooks:null,type:null,decode:function(t,e,i,s,n,r,a){for(var o=e.codebooks,l=o[this.classbook].dimensions,h=this.end-this.begin,u=this.partSize,c=Vt.toFloat(h)/Vt.toFloat(u)|0,d=new Array(e.channel*c+1),_=0,f=s;_<f;){var g=_++;if(!r[g])for(var p=i[g],v=0,m=p.length;v<m;){p[v++]=0}}if(2!=this.type||1==s)for(var w=0;w<8;)for(var b=w++,S=0;S<c;){if(0==b)for(var y=0,x=s;y<x;){var E=y++;if(!r[E]){var C=o[this.classbook];t.validBits<10&&t.prepHuffman();var k,T=C.fastHuffman[1023&t.acc];if(0<=T){var L=C.codewordLengths[T];t.acc=t.acc>>>L,t.validBits-=L,t.validBits<0?(t.validBits=0,k=-1):k=T}else k=t.decodeScalarRaw(C);C.sparse&&(k=C.sortedValues[k]);var B=k;if(-1==B)return;for(var I=l;0<=--I;)d[E*c+I+S]=B%this.classifications,B=B/this.classifications|0}}for(var N=0,A=l;N<A;){N++;if(c<=S)break;for(var R=0,P=s;R<P;){var V=R++;if(!r[V]){var D=d[V*c+S],O=this.residueBooks[D][b];if(0<=O){var M=i[V],F=this.begin+S*u,W=u;if(!o[O].residueDecode(t,M,F,W,this.type))return}}}++S}}else{for(var H=0,U=s;H<U;){var G=H++;if(!r[G])break;if(G==s-1)return}for(var X=0;X<8;){var Y=X++,z=0;if(2==s)for(;z<c;){var Z=this.begin+z*u,K=1&Z,j=Z>>>1;if(0==Y){var J=o[this.classbook];t.validBits<10&&t.prepHuffman();var Q,q=J.fastHuffman[1023&t.acc];if(0<=q){var $=J.codewordLengths[q];t.acc=t.acc>>>$,t.validBits-=$,t.validBits<0?(t.validBits=0,Q=-1):Q=q}else Q=t.decodeScalarRaw(J);J.sparse&&(Q=J.sortedValues[Q]);var tt=Q;if(-1==tt)return;for(var et=l;0<=--et;)d[et+z]=tt%this.classifications,tt=tt/this.classifications|0}for(var it=0,st=l;it<st;){it++;if(c<=z)break;var nt=this.begin+z*u,rt=d[z],at=this.residueBooks[rt][Y];if(0<=at){var ot=o[at].decodeDeinterleaveRepeat(t,i,s,K,j,n,u);if(null==ot)return;K=ot.cInter,j=ot.pInter}else K=1&(nt+=u),j=nt>>>1;++z}}else if(1==s)for(;z<c;){var lt=0,ht=this.begin+z*u;if(0==Y){var ut=o[this.classbook];t.validBits<10&&t.prepHuffman();var ct,dt=ut.fastHuffman[1023&t.acc];if(0<=dt){var _t=ut.codewordLengths[dt];t.acc=t.acc>>>_t,t.validBits-=_t,t.validBits<0?(t.validBits=0,ct=-1):ct=dt}else ct=t.decodeScalarRaw(ut);ut.sparse&&(ct=ut.sortedValues[ct]);var ft=ct;if(-1==ft)return;for(var gt=l;0<=--gt;)d[gt+z]=ft%this.classifications,ft=ft/this.classifications|0}for(var pt=0,vt=l;pt<vt;){pt++;if(c<=z)break;var mt=this.begin+z*u,wt=this.residueBooks[d[z]][Y];if(0<=wt){var bt=o[wt].decodeDeinterleaveRepeat(t,i,s,lt,ht,n,u);if(null==bt)return;lt=bt.cInter,ht=bt.pInter}else lt=0,ht=mt+=u;++z}}else for(;z<c;){var St=this.begin+z*u,yt=Vt.toFloat(St)%Vt.toFloat(s)|0,xt=Vt.toFloat(St)/Vt.toFloat(s)|0;if(0==Y){var Et=o[this.classbook];t.validBits<10&&t.prepHuffman();var Ct,kt=Et.fastHuffman[1023&t.acc];if(0<=kt){var Tt=Et.codewordLengths[kt];t.acc=t.acc>>>Tt,t.validBits-=Tt,t.validBits<0?(t.validBits=0,Ct=-1):Ct=kt}else Ct=t.decodeScalarRaw(Et);Et.sparse&&(Ct=Et.sortedValues[Ct]);var Lt=Ct;if(-1==Lt)return;for(var Bt=l;0<=--Bt;)d[Bt+z]=Lt%this.classifications,Lt=Lt/this.classifications|0}for(var It=0,Nt=l;It<Nt;){It++;if(c<=z)break;var At=this.begin+z*u,Rt=this.residueBooks[d[z]][Y];if(0<=Rt){var Pt=o[Rt].decodeDeinterleaveRepeat(t,i,s,yt,xt,n,u);if(null==Pt)return;yt=Pt.cInter,xt=Pt.pInter}else At+=u,yt=Vt.toFloat(At)%Vt.toFloat(s)|0,xt=Vt.toFloat(At)/Vt.toFloat(s)|0;++z}}}}},__class__:Dt};var Ot=function(){};(s["kha.graphics1.Graphics"]=Ot).__name__=!0;var Mt=function(){this.transformations=[],this.transformations.push(new Ae(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(s["kha.graphics2.Graphics"]=Mt).__name__=!0,Mt.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},drawImage:function(t,e,i){this.drawSubImage(t,e,i,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,i,s,n,r,a){this.drawScaledSubImage(t,s,n,r,a,e,i,r,a)},drawScaledImage:function(t,e,i,s,n){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,i,s,n)},drawScaledSubImage:function(t,e,i,s,n,r,a,o,l){},drawRect:function(t,e,i,s,n){null==n&&(n=1)},fillRect:function(t,e,i,s){},drawString:function(t,e,i){},drawLine:function(t,e,i,s,n){null==n&&(n=1)},fillTriangle:function(t,e,i,s,n,r){},set_imageScaleQuality:function(t){return Wt.High},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},pushTransformation:function(t){var e=new Ae(1,0,0,0,1,0,0,0,1);e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(e),this.transformations.push(e)},popTransformation:function(){var t=this.transformations.pop();return this.setTransformation(this.transformations[this.transformations.length-1]),t},pushRotation:function(t,e,i){var s=e,n=i,r=Math.cos(t),a=-Math.sin(t),o=Math.sin(t),l=Math.cos(t),h=1*r+0*o+0*s,u=1*a+0*l+0*s,c=0+1*s,d=0*r+1*o+0*n,_=0*a+1*l+0*n,f=0+1*n,g=0*r+0*o+0,p=0*a+0*l+0,v=-e,m=-i,w=1*h+0*u+0*c,b=0*h+1*u+0*c,S=h*v+u*m+1*c,y=1*d+0*_+0*f,x=0*d+1*_+0*f,E=d*v+_*m+1*f,C=1*g+0*p+0,k=0*g+1*p+0,T=g*v+p*m+1,L=this.transformations[this.transformations.length-1];this.pushTransformation(new Ae(w*L._00+b*L._01+S*L._02,w*L._10+b*L._11+S*L._12,w*L._20+b*L._21+S*L._22,y*L._00+x*L._01+E*L._02,y*L._10+x*L._11+E*L._12,y*L._20+x*L._21+E*L._22,C*L._00+k*L._01+T*L._02,C*L._10+k*L._11+T*L._12,C*L._20+k*L._21+T*L._22))},get_opacity:function(){return this.opacities[this.opacities.length-1]},set_opacity:function(t){return this.setOpacity(t),this.opacities[this.opacities.length-1]=t},pipe:null,transformations:null,opacities:null,myFontSize:null,setTransformation:function(t){},setOpacity:function(t){},__class__:Mt};var Ft=function(t){this.canvas=t};(s["kha.graphics2.Graphics1"]=Ft).__name__=!0,Ft.__interfaces__=[Ot],Ft.prototype={canvas:null,__class__:Ft};var Wt=b["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:n},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:n}},Ht=function(){};(s["kha.graphics2.truetype.VectorOfIntPointer"]=Ht).__name__=!0,Ht.prototype={value:null,__class__:Ht};var Ut=function(){};(s["kha.graphics2.truetype.Stbtt_temp_rect"]=Ut).__name__=!0,Ut.prototype={x0:null,y0:null,x1:null,y1:null,__class__:Ut};var Gt=function(){};(s["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=Gt).__name__=!0,Gt.prototype={advanceWidth:null,leftSideBearing:null,__class__:Gt};var Xt=function(){};(s["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=Xt).__name__=!0,Xt.prototype={ascent:null,descent:null,lineGap:null,__class__:Xt};var Kt=function(){};(s["kha.graphics2.truetype.Stbtt_bakedchar"]=Kt).__name__=!0,Kt.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:Kt};var jt=function(){};(s["kha.graphics2.truetype.Stbtt_fontinfo"]=jt).__name__=!0,jt.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:jt};var Jt=function(){};(s["kha.graphics2.truetype.Stbtt_vertex"]=Jt).__name__=!0,Jt.prototype={x:null,y:null,cx:null,cy:null,type:null,__class__:Jt};var Qt=function(){};(s["kha.graphics2.truetype.Stbtt__bitmap"]=Qt).__name__=!0,Qt.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:Qt};var qt=function(){};(s["kha.graphics2.truetype.Stbtt__edge"]=qt).__name__=!0,qt.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:qt};var $t=function(){};(s["kha.graphics2.truetype.Stbtt__active_edge"]=$t).__name__=!0,$t.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:$t};var te=function(){};(s["kha.graphics2.truetype.Stbtt__point"]=te).__name__=!0,te.prototype={x:null,y:null,__class__:te};var ee=function(){};(s["kha.graphics2.truetype.StbTruetype"]=ee).__name__=!0,ee.stbtt__find_table=function(t,e,i){for(var s=e+4,n=t.readU8(s),r=e+12,a=0,o=t.readU8(s+1)|n<<8;a<o;){var l=r+16*a++,h=st.cca(i,0),u=st.cca(i,1),c=st.cca(i,2),d=st.cca(i,3);if(t.readU8(l)==h&&t.readU8(l+1)==u&&t.readU8(l+2)==c&&t.readU8(l+3)==d){var _=l+8,f=t.readU8(_),g=t.readU8(_+1),p=t.readU8(_+2);return t.readU8(_+3)|p<<8|g<<16|f<<24}}return 0},ee.stbtt_InitFont=function(t,e,i){t.data=e,t.fontstart=i;var s=ee.stbtt__find_table(e,i,"cmap");if(t.loca=ee.stbtt__find_table(e,i,"loca"),t.head=ee.stbtt__find_table(e,i,"head"),t.glyf=ee.stbtt__find_table(e,i,"glyf"),t.hhea=ee.stbtt__find_table(e,i,"hhea"),t.hmtx=ee.stbtt__find_table(e,i,"hmtx"),t.kern=ee.stbtt__find_table(e,i,"kern"),0==s||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var n=ee.stbtt__find_table(e,i,"maxp");if(0!=n){var r=n+4,a=e.readU8(r),o=e.readU8(r+1);t.numGlyphs=o|a<<8}else t.numGlyphs=65535;for(var l=s+2,h=e.readU8(l),u=e.readU8(l+1)|h<<8,c=t.index_map=0,d=u;c<d;){var _=s+4+8*c++,f=e.readU8(_);switch(e.readU8(_+1)|f<<8){case 0:var g=_+4,p=e.readU8(g),v=e.readU8(g+1),m=e.readU8(g+2),w=e.readU8(g+3);t.index_map=s+(w|m<<8|v<<16|p<<24);break;case 3:var b=_+2,S=e.readU8(b);switch(e.readU8(b+1)|S<<8){case 1:case 10:var y=_+4,x=e.readU8(y),E=e.readU8(y+1),C=e.readU8(y+2),k=e.readU8(y+3);t.index_map=s+(k|C<<8|E<<16|x<<24)}}}if(0==t.index_map)return!1;var T=t.head+50,L=e.readU8(T),B=e.readU8(T+1);return t.indexToLocFormat=B|L<<8,!0},ee.stbtt_FindGlyphIndex=function(t,e){var i=t.data,s=t.index_map,n=i.readU8(s),r=i.readU8(s+1)|n<<8;if(0==r){var a=s+2,o=i.readU8(a);return e<(i.readU8(a+1)|o<<8)-6?i.readU8(s+6+e):0}if(6==r){var l=s+6,h=i.readU8(l),u=i.readU8(l+1)|h<<8,c=s+8,d=i.readU8(c),_=i.readU8(c+1);if(u<=e&&e<u+(_|d<<8)){var f=s+10+2*(e-u),g=i.readU8(f);return i.readU8(f+1)|g<<8}return 0}if(2==r)throw new zt("Error");if(4==r){var p=s+6,v=i.readU8(p),m=(i.readU8(p+1)|v<<8)>>1,w=s+8,b=i.readU8(w),S=(i.readU8(w+1)|b<<8)>>1,y=s+10,x=i.readU8(y),E=i.readU8(y+1)|x<<8,C=s+12,k=i.readU8(C),T=(i.readU8(C+1)|k<<8)>>1,L=s+14,B=L;if(65535<e)return 0;var I=B+2*T,N=i.readU8(I);for((i.readU8(I+1)|N<<8)<=e&&(B+=2*T),B-=2;0!=E;){var A=B+2*(S>>=1),R=i.readU8(A);(i.readU8(A+1)|R<<8)<e&&(B+=2*S),--E}var P=(B+=2)-L>>1,V=L+2*P,D=i.readU8(V);if((i.readU8(V+1)|D<<8)<e)throw new zt("Error");var O=s+14+2*m+2+2*P,M=i.readU8(O),F=i.readU8(O+1)|M<<8;if(e<F)return 0;var W=s+14+6*m+2+2*P,H=i.readU8(W),U=i.readU8(W+1)|H<<8;if(0==U){var G=s+14+4*m+2+2*P,X=i.readU8(G),Y=i.readU8(G+1)|X<<8;return e+(0!=(32768&Y)?Y-65536:Y)}var z=U+2*(e-F)+s+14+6*m+2+2*P,Z=i.readU8(z);return i.readU8(z+1)|Z<<8}if(12==r||13==r){for(var K=s+12,j=i.readU8(K),J=i.readU8(K+1),Q=i.readU8(K+2),q=0,$=i.readU8(K+3)|Q<<8|J<<16|j<<24;q<$;){var tt=q+($-q>>1),et=s+16+12*tt,it=i.readU8(et),st=i.readU8(et+1),nt=i.readU8(et+2),rt=i.readU8(et+3)|nt<<8|st<<16|it<<24,at=s+16+12*tt+4,ot=i.readU8(at),lt=i.readU8(at+1),ht=i.readU8(at+2),ut=i.readU8(at+3);if(e<rt)$=tt;else{if(!((ut|ht<<8|lt<<16|ot<<24)<e)){var ct=s+16+12*tt+8,dt=i.readU8(ct),_t=i.readU8(ct+1),ft=i.readU8(ct+2),gt=i.readU8(ct+3)|ft<<8|_t<<16|dt<<24;return 12==r?gt+e-rt:gt}q=tt+1}}return 0}throw new zt("Error")},ee.stbtt_setvertex=function(t,e,i,s,n,r){t.type=e,t.x=i,t.y=s,t.cx=n,t.cy=r},ee.stbtt__GetGlyfOffset=function(t,e){var i,s;if(e>=t.numGlyphs)return-1;if(2<=t.indexToLocFormat)return-1;if(0==t.indexToLocFormat){var n=t.glyf,r=t.data,a=t.loca+2*e,o=r.readU8(a);i=n+2*(r.readU8(a+1)|o<<8);var l=t.glyf,h=t.data,u=t.loca+2*e+2,c=h.readU8(u);s=l+2*(h.readU8(u+1)|c<<8)}else{var d=t.glyf,_=t.data,f=t.loca+4*e,g=_.readU8(f),p=_.readU8(f+1),v=_.readU8(f+2);i=d+(_.readU8(f+3)|v<<8|p<<16|g<<24);var m=t.glyf,w=t.data,b=t.loca+4*e+4,S=w.readU8(b),y=w.readU8(b+1),x=w.readU8(b+2);s=m+(w.readU8(b+3)|x<<8|y<<16|S<<24)}return i==s?-1:i},ee.stbtt_GetGlyphBox=function(t,e,i){var s=ee.stbtt__GetGlyfOffset(t,e);if(s<0)return!1;var n=t.data,r=s+2,a=n.readU8(r),o=n.readU8(r+1)|a<<8;i.x0=0!=(32768&o)?o-65536:o;var l=t.data,h=s+4,u=l.readU8(h),c=l.readU8(h+1)|u<<8;i.y0=0!=(32768&c)?c-65536:c;var d=t.data,_=s+6,f=d.readU8(_),g=d.readU8(_+1)|f<<8;i.x1=0!=(32768&g)?g-65536:g;var p=t.data,v=s+8,m=p.readU8(v),w=p.readU8(v+1)|m<<8;return i.y1=0!=(32768&w)?w-65536:w,!0},ee.stbtt__close_shape=function(t,e,i,s,n,r,a,o,l,h){return s?(i&&ee.stbtt_setvertex(t[e++],3,l+a>>1,h+o>>1,l,h),ee.stbtt_setvertex(t[e++],3,n,r,a,o)):i?ee.stbtt_setvertex(t[e++],3,n,r,l,h):ee.stbtt_setvertex(t[e++],2,n,r,0,0),e},ee.copyVertices=function(t,e,i,s){for(var n=0,r=s;n<r;){var a=n++;e[i+a]=t[a]}},ee.stbtt_GetGlyphShape=function(t,e){var i,s=t.data,n=null,r=0,a=ee.stbtt__GetGlyfOffset(t,e);if(a<0)return null;var o=s.readU8(a),l=s.readU8(a+1)|o<<8,h=0!=(32768&l)?l-65536:l;if(0<h){var u,c=0,d=0,_=0,f=!1,g=!1,p=0;i=s.sub(a+10,s.get_length()-(a+10));var v=a+10+2*h,m=s.readU8(v),w=s.readU8(v+1)|m<<8,b=s.sub(a+10+2*h+2+w,s.get_length()-(a+10+2*h+2+w)),S=2*h-2,y=i.readU8(S),x=1+(i.readU8(S+1)|y<<8),E=x+2*h;if(null==(n=new Array(E)))return null;for(var C=0,k=n.length;C<k;){n[C++]=new Jt}var T=_=0;u=E-x;for(var L=0,B=x;L<B;){var I=L++;0==T?0!=(8&(c=b.readU8(p++)))&&(T=b.readU8(p++)):--T,n[u+I].type=c}for(var N=0,A=0,R=x;A<R;){var P=A++;if(0!=(2&(c=n[u+P].type))){var V=b.readU8(p++);N+=0!=(16&c)?V:-V}else if(0==(16&c)){var D=b.readU8(p),O=b.readU8(p+1)|D<<8;N+=0!=(32768&O)?O-65536:O,p+=2}n[u+P].x=N}for(var M=0,F=0,W=x;F<W;){var H=F++;if(0!=(4&(c=n[u+H].type))){var U=b.readU8(p++);M+=0!=(32&c)?U:-U}else if(0==(32&c)){var G=b.readU8(p),X=b.readU8(p+1)|G<<8;M+=0!=(32768&X)?X-65536:X,p+=2}n[u+H].y=M}for(var Y=r=0,z=Y,Z=z,K=Z,j=K,J=j,Q=0;Q<x;){if(c=n[u+Q].type,N=n[u+Q].x,M=n[u+Q].y,_==Q){0!=Q&&(r=ee.stbtt__close_shape(n,r,f,g,J,j,z,Y,K,Z)),(g=0==(1&c))?(z=N,Y=M,0==(1&n[u+Q+1].type)?(J=N+n[u+Q+1].x>>1,j=M+n[u+Q+1].y>>1):(J=n[u+Q+1].x,j=n[u+Q+1].y,++Q)):(J=N,j=M),ee.stbtt_setvertex(n[r++],1,J,j,0,0),f=!1;var q=2*d,$=i.readU8(q);_=1+(i.readU8(q+1)|$<<8),++d}else 0==(1&c)?(f&&ee.stbtt_setvertex(n[r++],3,K+N>>1,Z+M>>1,K,Z),K=N,Z=M,f=!0):(f?ee.stbtt_setvertex(n[r++],3,N,M,K,Z):ee.stbtt_setvertex(n[r++],2,N,M,0,0),f=!1);++Q}r=ee.stbtt__close_shape(n,r,f,g,J,j,z,Y,K,Z)}else if(-1==h){var tt=1,et=s.sub(a+10,s.get_length()-(a+10)),it=0;for(r=0,n=null;0!=tt;){var st,nt,rt=null,at=1,ot=0,lt=0,ht=1,ut=0,ct=0,dt=et.readU8(it),_t=et.readU8(it+1)|dt<<8,ft=0!=(32768&_t)?_t-65536:_t;it+=2;var gt=et.readU8(it),pt=et.readU8(it+1)|gt<<8,vt=0!=(32768&pt)?pt-65536:pt;if(it+=2,0==(2&ft))throw new zt("Error");if(0!=(1&ft)){var mt=et.readU8(it),wt=et.readU8(it+1)|mt<<8;ut=0!=(32768&wt)?wt-65536:wt,it+=2;var bt=et.readU8(it),St=et.readU8(it+1)|bt<<8;ct=0!=(32768&St)?St-65536:St,it+=2}else{var yt=et.readU8(it);ut=128<=yt?yt-256:yt,++it;var xt=et.readU8(it);ct=128<=xt?xt-256:xt,++it}if(0!=(8&ft)){var Et=et.readU8(it),Ct=et.readU8(it+1)|Et<<8;at=ht=(0!=(32768&Ct)?Ct-65536:Ct)/16384,it+=2,ot=lt=0}else if(0!=(64&ft)){var kt=et.readU8(it),Tt=et.readU8(it+1)|kt<<8;at=(0!=(32768&Tt)?Tt-65536:Tt)/16384,it+=2,ot=lt=0;var Lt=et.readU8(it),Bt=et.readU8(it+1)|Lt<<8;ht=(0!=(32768&Bt)?Bt-65536:Bt)/16384,it+=2}else if(0!=(128&ft)){var It=et.readU8(it),Nt=et.readU8(it+1)|It<<8;at=(0!=(32768&Nt)?Nt-65536:Nt)/16384,it+=2;var At=et.readU8(it),Rt=et.readU8(it+1)|At<<8;ot=(0!=(32768&Rt)?Rt-65536:Rt)/16384,it+=2;var Pt=et.readU8(it),Vt=et.readU8(it+1)|Pt<<8;lt=(0!=(32768&Vt)?Vt-65536:Vt)/16384,it+=2;var Dt=et.readU8(it),Ot=et.readU8(it+1)|Dt<<8;ht=(0!=(32768&Ot)?Ot-65536:Ot)/16384,it+=2}var Mt=Math.sqrt(at*at+ot*ot),Ft=Math.sqrt(lt*lt+ht*ht);if(0<(st=null==(nt=ee.stbtt_GetGlyphShape(t,vt))?0:nt.length)){for(var Wt=0,Ht=st;Wt<Ht;){var Ut=nt[Wt++],Gt=Ut.x,Xt=Ut.y;Ut.x=Mt*(at*Gt+lt*Xt+ut)|0,Ut.y=Ft*(ot*Gt+ht*Xt+ct)|0,Gt=Ut.cx,Xt=Ut.cy,Ut.cx=Mt*(at*Gt+lt*Xt+ut)|0,Ut.cy=Ft*(ot*Gt+ht*Xt+ct)|0}if(null==(rt=new Array(r+st)))return null;0<r&&ee.copyVertices(n,rt,0,r),ee.copyVertices(nt,rt,r,st),n=rt,r+=st}tt=32&ft}}else if(h<0)throw new zt("Error");if(null==n)return null;if(n.length<r)throw new zt("Error");if(r<n.length){var Yt=new Array(r);return ee.copyVertices(n,Yt,0,r),Yt}return n},ee.stbtt_GetGlyphHMetrics=function(t,e){var i=t.data,s=t.hhea+34,n=i.readU8(s),r=i.readU8(s+1)|n<<8,a=new Gt;if(e<r){var o=t.data,l=t.hmtx+4*e,h=o.readU8(l),u=o.readU8(l+1)|h<<8;a.advanceWidth=0!=(32768&u)?u-65536:u;var c=t.data,d=t.hmtx+4*e+2,_=c.readU8(d),f=c.readU8(d+1)|_<<8;a.leftSideBearing=0!=(32768&f)?f-65536:f}else{var g=t.data,p=t.hmtx+4*(r-1),v=g.readU8(p),m=g.readU8(p+1)|v<<8;a.advanceWidth=0!=(32768&m)?m-65536:m;var w=t.data,b=t.hmtx+4*r+2*(e-r),S=w.readU8(b),y=w.readU8(b+1)|S<<8;a.leftSideBearing=0!=(32768&y)?y-65536:y}return a},ee.stbtt_GetFontVMetrics=function(t){var e=new Xt,i=t.data,s=t.hhea+4,n=i.readU8(s),r=i.readU8(s+1)|n<<8;e.ascent=0!=(32768&r)?r-65536:r;var a=t.data,o=t.hhea+6,l=a.readU8(o),h=a.readU8(o+1)|l<<8;e.descent=0!=(32768&h)?h-65536:h;var u=t.data,c=t.hhea+8,d=u.readU8(c),_=u.readU8(c+1)|d<<8;return e.lineGap=0!=(32768&_)?_-65536:_,e},ee.stbtt_ScaleForPixelHeight=function(t,e){var i=t.data,s=t.hhea+4,n=i.readU8(s),r=i.readU8(s+1)|n<<8,a=t.data,o=t.hhea+6,l=a.readU8(o),h=a.readU8(o+1)|l<<8;return e/((0!=(32768&r)?r-65536:r)-(0!=(32768&h)?h-65536:h))},ee.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,i,s,n,r){var a=new Ut;if(ee.stbtt_GetGlyphBox(t,e,a)){var o=a.x0,l=a.x1,h=a.y0,u=a.y1;a.x0=Math.floor(o*i+n),a.y0=Math.floor(-u*s+r),a.x1=Math.ceil(l*i+n),a.y1=Math.ceil(-h*s+r)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},ee.stbtt_GetGlyphBitmapBox=function(t,e,i,s){return ee.stbtt_GetGlyphBitmapBoxSubpixel(t,e,i,s,0,0)},ee.stbtt__new_active=function(t,e,i,s){var n=new $t,r=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==n||(n.fdx=r,n.fdy=0!=r?1/r:0,n.fx=t[e].x0+r*(s-t[e].y0),n.fx-=i,n.direction=t[e].invert?1:-1,n.sy=t[e].y0,n.ey=t[e].y1,n.next=null),n},ee.stbtt__handle_clipped_edge=function(t,e,i,s,n,r,a,o){if(r!=o){if(!(r<o))throw new zt("Error");if(!(s.sy<=s.ey))throw new zt("Error");if(!(r>s.ey||o<s.sy)){if(r<s.sy&&(n+=(a-n)*(s.sy-r)/(o-r),r=s.sy),o>s.ey&&(a+=(a-n)*(s.ey-o)/(o-r),o=s.ey),n==i){if(!(a<=i+1))throw new zt("Error")}else if(n==i+1){if(!(i<=a))throw new zt("Error")}else if(n<=i){if(!(a<=i))throw new zt("Error")}else if(i+1<=n){if(!(i+1<=a))throw new zt("Error")}else if(!(i<=a&&a<=i+1))throw new zt("Error");if(n<=i&&a<=i){var l=e+i,h=t;h[l]=h[l]+s.direction*(o-r)}else if(!(i+1<=n&&i+1<=a)){if(!(i<=n&&n<=i+1&&i<=a&&a<=i+1))throw new zt("Error");var u=e+i,c=t;c[u]=c[u]+s.direction*(o-r)*(1-(n-i+(a-i))/2)}}}},ee.stbtt__fill_active_edges_new=function(t,e,i,s,n,r){for(var a=r+1;null!=n;){if(!(n.ey>=r))throw new zt("Error");if(0==n.fdx){var o=n.fx;o<s&&(0<=o?(ee.stbtt__handle_clipped_edge(t,0,0|o,n,o,r,o,a),ee.stbtt__handle_clipped_edge(e,i-1,o+1|0,n,o,r,o,a)):ee.stbtt__handle_clipped_edge(e,i-1,0,n,o,r,o,a))}else{var l,h,u,c,d=n.fx,_=n.fdx,f=d+_,g=n.fdy;if(!(n.sy<=a&&n.ey>=r))throw new zt("Error");if(n.sy>r?(l=d+_*(n.sy-r),u=n.sy):(l=d,u=r),n.ey<a?(h=d+_*(n.ey-r),c=n.ey):(h=f,c=a),0<=l&&0<=h&&l<s&&h<s)if((0|l)==(0|h)){var p=0|l,v=c-u;if(!(0<=p&&p<s))throw new zt("Error");var m=p,w=t;w[m]=w[m]+n.direction*(1-(l-p+(h-p))/2)*v;var b=i+p,S=e;S[b]=S[b]+n.direction*v}else{if(h<l){var y=u=a-(u-r);u=c=a-(c-r),c=y,y=h,h=l,l=y,_=-_,g=-g,y=d,d=f,f=y}var x=0|l,E=0|h,C=(x+1-d)*g+r,k=n.direction,T=k*(C-u),L=x,B=t;B[L]=B[L]+T*(1-(l-x+(x+1-x))/2);for(var I=k*g,N=x+1,A=E;N<A;){var R=N++,P=t;P[R]=P[R]+(T+I/2),T+=I}if(C+=g*(E-(x+1)),!(Math.abs(T)<=1.01))throw new zt("Error");var V=E,D=t;D[V]=D[V]+(T+k*(1-(E-E+(h-E))/2)*(c-C));var O=i+E,M=e;M[O]=M[O]+k*(c-u)}else for(var F=0,W=s;F<W;){var H=F++,U=r,G=H,X=H+1,Y=f,z=a,Z=(H-d)/_+r,K=(H+1-d)/_+r;d<G&&X<Y?(ee.stbtt__handle_clipped_edge(t,0,H,n,d,U,G,Z),ee.stbtt__handle_clipped_edge(t,0,H,n,G,Z,X,K),ee.stbtt__handle_clipped_edge(t,0,H,n,X,K,Y,z)):Y<G&&X<d?(ee.stbtt__handle_clipped_edge(t,0,H,n,d,U,X,K),ee.stbtt__handle_clipped_edge(t,0,H,n,X,K,G,Z),ee.stbtt__handle_clipped_edge(t,0,H,n,G,Z,Y,z)):d<G&&G<Y?(ee.stbtt__handle_clipped_edge(t,0,H,n,d,U,G,Z),ee.stbtt__handle_clipped_edge(t,0,H,n,G,Z,Y,z)):Y<G&&G<d?(ee.stbtt__handle_clipped_edge(t,0,H,n,d,U,G,Z),ee.stbtt__handle_clipped_edge(t,0,H,n,G,Z,Y,z)):d<X&&X<Y?(ee.stbtt__handle_clipped_edge(t,0,H,n,d,U,X,K),ee.stbtt__handle_clipped_edge(t,0,H,n,X,K,Y,z)):Y<X&&X<d?(ee.stbtt__handle_clipped_edge(t,0,H,n,d,U,X,K),ee.stbtt__handle_clipped_edge(t,0,H,n,X,K,Y,z)):ee.stbtt__handle_clipped_edge(t,0,H,n,d,U,Y,z)}}n=n.next}},ee.stbtt__rasterize_sorted_edges=function(t,e,i,s,n,r){var a,o,l=null,h=0,u=0;64<t.w?a=new Array(2*t.w+1):a=new Array(129);var c=a;o=t.w;var d=r;for(e[u+i].y0=r+t.h+1;h<t.h;){for(var _=d+0,f=d+1,g=l,p=null,v=0,m=t.w;v<m;){a[v++]=0}for(var w=0,b=t.w+1;w<b;){c[o+w++]=0}for(;null!=g;){var S=g;if(S.ey<=_){if(null==p?l=S.next:p.next=S.next,g=S.next,0==S.direction)throw new zt("Error");S.direction=0}else g=(p=g).next}for(;e[u].y0<=f;){if(e[u].y0!=e[u].y1){var y=ee.stbtt__new_active(e,u,n,_);if(!(y.ey>=_))throw new zt("Error");y.next=l,l=y}++u}null!=l&&ee.stbtt__fill_active_edges_new(a,c,o+1,t.w,l,_);for(var x=0,E=0,C=t.w;E<C;){var k=E++;x+=c[o+k];var T=a[k]+x,L=0|(T=255*Math.abs(T)+.5);255<L&&(L=255),t.pixels.writeU8(t.pixels_offset+h*t.stride+k,L)}for(p=null,g=l;null!=g;){var B=g;B.fx+=B.fdx,g=(p=g).next}++d,++h}},ee.STBTT__COMPARE=function(t,e){return t.y0<e.y0},ee.stbtt__sort_edges_ins_sort=function(t,e){for(var i,s=1,n=e;s<n;){var r=s++,a=t[r],o=a;for(i=r;0<i;){var l=t[i-1];if(!ee.STBTT__COMPARE(o,l))break;t[i]=t[i-1],--i}r!=i&&(t[i]=a)}},ee.stbtt__sort_edges_quicksort=function(t,e,i){for(;12<i;){var s,n=i>>1,r=ee.STBTT__COMPARE(t[e],t[e+n]),a=ee.STBTT__COMPARE(t[e+n],t[e+i-1]);if(r!=a){var o=ee.STBTT__COMPARE(t[e],t[e+i-1])==a?0:i-1;s=t[e+o],t[e+o]=t[e+n],t[e+n]=s}s=t[e],t[e]=t[e+n],t[e+n]=s;for(var l=1,h=i-1;;){for(;ee.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;ee.STBTT__COMPARE(t[e],t[e+h]);)--h;if(h<=l)break;s=t[e+l],t[e+l]=t[e+h],t[e+h]=s,++l,--h}h<i-l?(ee.stbtt__sort_edges_quicksort(t,e,h),e+=l,i-=l):(ee.stbtt__sort_edges_quicksort(t,e+l,i-l),i=h)}},ee.stbtt__sort_edges=function(t,e){ee.stbtt__sort_edges_quicksort(t,0,e),ee.stbtt__sort_edges_ins_sort(t,e)},ee.stbtt__rasterize=function(t,e,i,s,n,r,a,o,l,h,u){for(var c,d=u?-r:r,_=0,f=0,g=s;f<g;){_+=i[f++]}var p=new Array(_+1);if(null!=p){for(var v=0,m=p.length;v<m;){p[v++]=new qt}for(var w=_=0,b=0,S=s;b<S;){var y=b++,x=e,E=0+w;w+=i[y],c=i[y]-1;for(var C=0,k=i[y];C<k;){var T=C++,L=T,B=c;x[E+c].y!=x[E+T].y?(p[_].invert=!1,(u?x[E+c].y>x[E+T].y:x[E+c].y<x[E+T].y)&&(p[_].invert=!0,L=c,B=T),p[_].x0=x[E+L].x*n+a,p[_].y0=1*(x[E+L].y*d+o),p[_].x1=x[E+B].x*n+a,p[_].y1=1*(x[E+B].y*d+o),++_,c=T):c=T}}ee.stbtt__sort_edges(p,_),ee.stbtt__rasterize_sorted_edges(t,p,_,1,l,h)}},ee.stbtt__add_point=function(t,e,i,s){null!=t&&(t[e].x=i,t[e].y=s)},ee.stbtt__tesselate_curve=function(t,e,i,s,n,r,a,o,l,h){var u=(i+2*n+a)/4,c=(s+2*r+o)/4,d=(i+a)/2-u,_=(s+o)/2-c;return 16<h||(l<d*d+_*_?(ee.stbtt__tesselate_curve(t,e,i,s,(i+n)/2,(s+r)/2,u,c,l,h+1),ee.stbtt__tesselate_curve(t,e,u,c,(n+a)/2,(r+o)/2,a,o,l,h+1)):(ee.stbtt__add_point(t,e.value,a,o),e.value+=1)),1},ee.stbtt_FlattenCurves=function(t,e,i,s,n){for(var r=null,a=0,o=i*i,l=0,h=0,u=0,c=e;u<c;){1==t[u++].type&&++l}if(0==(n.value=l))return null;var d=new Array(l);if(s.value=d,null==s.value)return n.value=0,null;for(var _=0;_<2;){var f=0,g=0;if(1==_++){if(null==(r=new Array(a)))return s.value=null,n.value=0,null;for(var p=0,v=r.length;p<v;){r[p++]=new te}}l=-1;for(var m=a=0,w=e;m<w;){var b=m++;switch(t[b].type){case 1:0<=l&&(s.value[l]=a-h),++l,h=a,f=t[b].x,g=t[b].y,ee.stbtt__add_point(r,a++,f,g);break;case 2:f=t[b].x,g=t[b].y,ee.stbtt__add_point(r,a++,f,g);break;case 3:var S={value:a};ee.stbtt__tesselate_curve(r,S,f,g,t[b].cx,t[b].cy,t[b].x,t[b].y,o,0),a=S.value,f=t[b].x,g=t[b].y}}s.value[l]=a-h}return r},ee.stbtt_Rasterize=function(t,e,i,s,n,r,a,o,l,h,u){var c,d=r<n?r:n,_=0,f={value:_},g=new Ht,p=ee.stbtt_FlattenCurves(i,s,e/d,g,f);_=f.value,c=g.value,null!=p&&ee.stbtt__rasterize(t,p,c,_,n,r,a,o,l,h,u)},ee.stbtt_MakeGlyphBitmapSubpixel=function(t,e,i,s,n,r,a,o,l,h,u){var c,d,_=ee.stbtt_GetGlyphShape(t,u),f=null==_?0:_.length,g=new Qt,p=ee.stbtt_GetGlyphBitmapBoxSubpixel(t,u,a,o,l,h);c=p.x0,d=p.y0,g.pixels=e,g.pixels_offset=i,g.w=s,g.h=n,g.stride=r,0!=g.w&&0!=g.h&&ee.stbtt_Rasterize(g,.35,_,f,a,o,l,h,c,d,!0)},ee.stbtt_MakeGlyphBitmap=function(t,e,i,s,n,r,a,o,l){ee.stbtt_MakeGlyphBitmapSubpixel(t,e,i,s,n,r,a,o,0,0,l)},ee.stbtt_BakeFontBitmap=function(t,e,i,s,n,r,a,o){var l=new jt;if(!ee.stbtt_InitFont(l,t,e))return-1;for(var h=0,u=n*r;h<u;){var c=h++;s.writeU8(c,0)}for(var d=1,_=d,f=1,g=ee.stbtt_ScaleForPixelHeight(l,i),p=0,v=0;v<a.length;){var m=a[v];++v;var w=ee.stbtt_FindGlyphIndex(l,m),b=ee.stbtt_GetGlyphHMetrics(l,w),S=b.advanceWidth,y=(b.leftSideBearing,ee.stbtt_GetGlyphBitmapBox(l,w,g,g)),x=y.x0,E=y.y0,C=y.x1-x,k=y.y1-E;if(n<=_+C+1&&(d=f,_=1),r<=d+k+1)return-p;if(n<=_+C)throw new zt("Error");if(r<=d+k)throw new zt("Error");ee.stbtt_MakeGlyphBitmap(l,s,_+d*n,C,k,n,g,g,w),o[p].x0=_,o[p].y0=d,o[p].x1=_+C,o[p].y1=d+k,o[p].xadvance=g*S,o[p].xoff=x,o[p].yoff=E,_=_+C+1,f<d+k+1&&(f=d+k+1),++p}return f};var ie=function(){};(s["kha.graphics4.ConstantLocation"]=ie).__name__=!0;var se=function(t,e){null!=t&&(this.shader=Krom.createFragmentShader(t[0].bytes.b.bufferValue,e[0]))};(s["kha.graphics4.FragmentShader"]=se).__name__=!0,se.prototype={shader:null,__class__:se};var ne=function(t,e){this.shader=Krom.createGeometryShader(t[0].bytes.b.bufferValue,e[0])};(s["kha.graphics4.GeometryShader"]=ne).__name__=!0,ne.prototype={shader:null,__class__:ne};var re=function(){};(s["kha.graphics4.Graphics"]=re).__name__=!0,re.prototype={begin:null,end:null,clear:null,setVertexBuffer:null,setIndexBuffer:null,setTexture:null,setTextureParameters:null,renderTargetsInvertedY:null,setPipeline:null,setMatrix:null,drawIndexedVertices:null,__class__:re};var ae=function(t){this.pipeline=t,this.projectionLocation=t.getConstantLocation("projectionMatrix"),this.textureLocation=t.getTextureUnit("tex")};(s["kha.graphics4.PipelineCache"]=ae).__name__=!0,ae.prototype={pipeline:null,projectionLocation:null,textureLocation:null,__class__:ae};var oe=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,oe.bufferIndex=0,oe.initShaders(),this.myPipeline=oe.standardImagePipeline,this.initBuffers()};(s["kha.graphics4.ImageShaderPainter"]=oe).__name__=!0,oe.initShaders=function(){if(null==oe.structure&&(oe.structure=ue.createImageVertexStructure()),null==oe.standardImagePipeline){var t=ue.createImagePipeline(oe.structure);t.compile(),oe.standardImagePipeline=new ae(t)}},oe.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==oe.rectVertexBuffer){oe.rectVertexBuffer=new me(6e3,oe.structure,1),oe.rectVertices=oe.rectVertexBuffer.lock(),oe.indexBuffer=new ce(9e3,0);for(var t=oe.indexBuffer.lock(),e=0;e<1500;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}oe.indexBuffer.unlock()}},drawBuffer:function(){oe.rectVertexBuffer.unlock(),this.g.setVertexBuffer(oe.rectVertexBuffer),this.g.setIndexBuffer(oe.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,oe.lastTexture),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,this.bilinearMipmaps?2:0),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*oe.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),oe.bufferIndex=0,oe.rectVertices=oe.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},end:function(){0<oe.bufferIndex&&this.drawBuffer(),oe.lastTexture=null},__class__:oe};var le=function(t){this.myPipeline=null,this.g=t,le.bufferIndex=0,le.triangleBufferIndex=0,le.initShaders(),this.myPipeline=le.standardColorPipeline,this.initBuffers()};(s["kha.graphics4.ColoredShaderPainter"]=le).__name__=!0,le.initShaders=function(){if(null==le.structure&&(le.structure=ue.createColoredVertexStructure()),null==le.standardColorPipeline){var t=ue.createColoredPipeline(le.structure);t.compile(),le.standardColorPipeline=new ae(t)}},le.prototype={projectionMatrix:null,g:null,myPipeline:null,setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==le.rectVertexBuffer){le.rectVertexBuffer=new me(400,le.structure,1),le.rectVertices=le.rectVertexBuffer.lock(),le.indexBuffer=new ce(600,0);for(var t=le.indexBuffer.lock(),e=0;e<100;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}le.indexBuffer.unlock(),le.triangleVertexBuffer=new me(300,le.structure,1),le.triangleVertices=le.triangleVertexBuffer.lock(),le.triangleIndexBuffer=new ce(300,0);for(var s=le.triangleIndexBuffer.lock(),n=0;n<100;){var r=n++;s[3*r]=3*r,s[3*r+1]=3*r+1,s[3*r+2]=3*r+2}le.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,i,s,n,r,a,o){var l=7*le.bufferIndex*4;le.rectVertices[l]=t,le.rectVertices[l+1]=e,le.rectVertices[l+2]=-5,le.rectVertices[l+7]=i,le.rectVertices[l+8]=s,le.rectVertices[l+9]=-5,le.rectVertices[l+14]=n,le.rectVertices[l+15]=r,le.rectVertices[l+16]=-5,le.rectVertices[l+21]=a,le.rectVertices[l+22]=o,le.rectVertices[l+23]=-5},setRectColors:function(t,e){var i=7*le.bufferIndex*4,s=t*(.00392156862745098*(e>>>24)),n=s*(.00392156862745098*((16711680&e)>>>16)),r=s*(.00392156862745098*((65280&e)>>>8)),a=s*(.00392156862745098*(255&e));le.rectVertices[i+3]=n,le.rectVertices[i+4]=r,le.rectVertices[i+5]=a,le.rectVertices[i+6]=s,le.rectVertices[i+10]=n,le.rectVertices[i+11]=r,le.rectVertices[i+12]=a,le.rectVertices[i+13]=s,le.rectVertices[i+17]=n,le.rectVertices[i+18]=r,le.rectVertices[i+19]=a,le.rectVertices[i+20]=s,le.rectVertices[i+24]=n,le.rectVertices[i+25]=r,le.rectVertices[i+26]=a,le.rectVertices[i+27]=s},setTriVertices:function(t,e,i,s,n,r){var a=7*le.triangleBufferIndex*3;le.triangleVertices[a]=t,le.triangleVertices[a+1]=e,le.triangleVertices[a+2]=-5,le.triangleVertices[a+7]=i,le.triangleVertices[a+8]=s,le.triangleVertices[a+9]=-5,le.triangleVertices[a+14]=n,le.triangleVertices[a+15]=r,le.triangleVertices[a+16]=-5},setTriColors:function(t,e){var i=7*le.triangleBufferIndex*3,s=t*(.00392156862745098*(e>>>24)),n=s*(.00392156862745098*((16711680&e)>>>16)),r=s*(.00392156862745098*((65280&e)>>>8)),a=s*(.00392156862745098*(255&e));le.triangleVertices[i+3]=n,le.triangleVertices[i+4]=r,le.triangleVertices[i+5]=a,le.triangleVertices[i+6]=s,le.triangleVertices[i+10]=n,le.triangleVertices[i+11]=r,le.triangleVertices[i+12]=a,le.triangleVertices[i+13]=s,le.triangleVertices[i+17]=n,le.triangleVertices[i+18]=r,le.triangleVertices[i+19]=a,le.triangleVertices[i+20]=s},drawBuffer:function(t){t||0<le.triangleBufferIndex&&this.drawTriBuffer(!0),le.rectVertexBuffer.unlock(),this.g.setVertexBuffer(le.rectVertexBuffer),this.g.setIndexBuffer(le.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*le.bufferIndex*3),le.bufferIndex=0,le.rectVertices=le.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||0<le.bufferIndex&&this.drawBuffer(!0),le.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(le.triangleVertexBuffer),this.g.setIndexBuffer(le.triangleIndexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*le.triangleBufferIndex),le.triangleBufferIndex=0,le.triangleVertices=le.triangleVertexBuffer.lock()},fillRect:function(t,e,i,s,n,r,a,o,l,h){0<le.triangleBufferIndex&&this.drawTriBuffer(!0),100<=le.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(i,s,n,r,a,o,l,h),++le.bufferIndex},fillTriangle:function(t,e,i,s,n,r,a,o){0<le.bufferIndex&&this.drawBuffer(!0),100<=le.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(i,s,n,r,a,o),++le.triangleBufferIndex},__class__:le};var he=function(t){this.bakedQuadCache=new L,this.bilinear=!1,this.myPipeline=null,this.g=t,he.bufferIndex=0,he.initShaders(),this.myPipeline=he.standardTextPipeline,this.initBuffers()};(s["kha.graphics4.TextShaderPainter"]=he).__name__=!0,he.initShaders=function(){if(null==he.structure&&(he.structure=ue.createTextVertexStructure()),null==he.standardTextPipeline){var t=ue.createTextPipeline(he.structure);t.compile(),he.standardTextPipeline=new ae(t)}},he.findIndex=function(t){Mt.fontGlyphs;for(var e=B.charBlocks,i=0,s=0,n=e.length/2|0;s<n;){var r=s++,a=e[2*r],o=e[2*r+1];if(a<=t&&t<=o)return i+t-a;i+=o-a+1}return 0},he.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,fontSize:null,bilinear:null,setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==he.rectVertexBuffer){he.rectVertexBuffer=new me(400,he.structure,1),he.rectVertices=he.rectVertexBuffer.lock(),he.indexBuffer=new ce(600,0);for(var t=he.indexBuffer.lock(),e=0;e<100;){var i=e++;t[3*i*2]=4*i,t[3*i*2+1]=4*i+1,t[3*i*2+2]=4*i+2,t[3*i*2+3]=4*i,t[3*i*2+4]=4*i+2,t[3*i*2+5]=4*i+3}he.indexBuffer.unlock()}},setRectVertices:function(t,e,i,s,n,r,a,o){var l=9*he.bufferIndex*4;he.rectVertices[l]=t,he.rectVertices[l+1]=e,he.rectVertices[l+2]=-5,he.rectVertices[l+9]=i,he.rectVertices[l+10]=s,he.rectVertices[l+11]=-5,he.rectVertices[l+18]=n,he.rectVertices[l+19]=r,he.rectVertices[l+20]=-5,he.rectVertices[l+27]=a,he.rectVertices[l+28]=o,he.rectVertices[l+29]=-5},setRectTexCoords:function(t,e,i,s){var n=9*he.bufferIndex*4;he.rectVertices[n+3]=t,he.rectVertices[n+4]=s,he.rectVertices[n+12]=t,he.rectVertices[n+13]=e,he.rectVertices[n+21]=i,he.rectVertices[n+22]=e,he.rectVertices[n+30]=i,he.rectVertices[n+31]=s},setRectColors:function(t,e){var i=9*he.bufferIndex*4,s=t*(.00392156862745098*(e>>>24));he.rectVertices[i+5]=.00392156862745098*((16711680&e)>>>16),he.rectVertices[i+6]=.00392156862745098*((65280&e)>>>8),he.rectVertices[i+7]=.00392156862745098*(255&e),he.rectVertices[i+8]=s,he.rectVertices[i+14]=.00392156862745098*((16711680&e)>>>16),he.rectVertices[i+15]=.00392156862745098*((65280&e)>>>8),he.rectVertices[i+16]=.00392156862745098*(255&e),he.rectVertices[i+17]=s,he.rectVertices[i+23]=.00392156862745098*((16711680&e)>>>16),he.rectVertices[i+24]=.00392156862745098*((65280&e)>>>8),he.rectVertices[i+25]=.00392156862745098*(255&e),he.rectVertices[i+26]=s,he.rectVertices[i+32]=.00392156862745098*((16711680&e)>>>16),he.rectVertices[i+33]=.00392156862745098*((65280&e)>>>8),he.rectVertices[i+34]=.00392156862745098*(255&e),he.rectVertices[i+35]=s},drawBuffer:function(){he.rectVertexBuffer.unlock(),this.g.setVertexBuffer(he.rectVertexBuffer),this.g.setIndexBuffer(he.indexBuffer),this.g.setPipeline(this.myPipeline.pipeline),this.g.setTexture(this.myPipeline.textureLocation,he.lastTexture),this.g.setMatrix(this.myPipeline.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.myPipeline.textureLocation,2,2,this.bilinear?1:0,this.bilinear?1:0,0),this.g.drawIndexedVertices(0,2*he.bufferIndex*3),this.g.setTexture(this.myPipeline.textureLocation,null),he.bufferIndex=0,he.rectVertices=he.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=y.__cast(t,I)},text:null,startString:function(t){this.text=t},charCodeAt:function(t){return st.cca(this.text,t)},stringLength:function(){return this.text.length},endString:function(){this.text=null},bakedQuadCache:null,drawString:function(t,e,i,s,n,r){var a=this.font._get(this.fontSize),o=a.getTexture();null!=he.lastTexture&&o!=he.lastTexture&&this.drawBuffer(),he.lastTexture=o;var l=s,h=n;this.startString(t);for(var u=0,c=this.stringLength();u<c;){var d=u++,_=a.getBakedQuad(this.bakedQuadCache,he.findIndex(this.charCodeAt(d)),l,h);if(null!=_){100<=he.bufferIndex+1&&this.drawBuffer(),this.setRectColors(e,i),this.setRectTexCoords(_.s0*o.get_width()/o.get_realWidth(),_.t0*o.get_height()/o.get_realHeight(),_.s1*o.get_width()/o.get_realWidth(),_.t1*o.get_height()/o.get_realHeight());var f=_.x0,g=_.y1,p=r._02*f+r._12*g+r._22,v=(r._00*f+r._10*g+r._20)/p,m=(r._01*f+r._11*g+r._21)/p,w=_.x0,b=_.y0,S=r._02*w+r._12*b+r._22,y=(r._00*w+r._10*b+r._20)/S,x=(r._01*w+r._11*b+r._21)/S,E=_.x1,C=_.y0,k=r._02*E+r._12*C+r._22,T=(r._00*E+r._10*C+r._20)/k,L=(r._01*E+r._11*C+r._21)/k,B=_.x1,I=_.y1,N=r._02*B+r._12*I+r._22,A=(r._00*B+r._10*I+r._20)/N,R=(r._01*B+r._11*I+r._21)/N;this.setRectVertices(v,m,y,x,T,L,A,R),l+=_.xadvance,++he.bufferIndex}}this.endString()},end:function(){0<he.bufferIndex&&this.drawBuffer(),he.lastTexture=null},__class__:he};var ue=function(t){this.myImageScaleQuality=Wt.High,Mt.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new oe(this.g),this.coloredPainter=new le(this.g),this.textPainter=new he(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new Re(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==ue.videoPipeline&&(ue.videoPipeline=ue.createImagePipeline(ue.createImageVertexStructure()),ue.videoPipeline.fragmentShader=V.painter_video_frag,ue.videoPipeline.vertexShader=V.painter_video_vert,ue.videoPipeline.compile())};(s["kha.graphics4.Graphics2"]=ue).__name__=!0,ue.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},ue.createImageVertexStructure=function(){var t=new Se;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},ue.createImagePipeline=function(t){var e=new _e;return e.fragmentShader=V.painter_image_frag,e.vertexShader=V.painter_image_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},ue.createColoredVertexStructure=function(){var t=new Se;return t.add("vertexPosition",2),t.add("vertexColor",3),t},ue.createColoredPipeline=function(t){var e=new _e;return e.fragmentShader=V.painter_colored_frag,e.vertexShader=V.painter_colored_vert,e.inputLayout=[t],e.blendSource=1,e.blendDestination=5,e.alphaBlendSource=1,e.alphaBlendDestination=5,e},ue.createTextVertexStructure=function(){var t=new Se;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},ue.createTextPipeline=function(t){var e=new _e;return e.fragmentShader=V.painter_text_frag,e.vertexShader=V.painter_text_vert,e.inputLayout=[t],e.blendSource=3,e.blendDestination=5,e.alphaBlendSource=3,e.alphaBlendDestination=5,e},ue.__super__=Mt,ue.prototype=r(Mt.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof x){var i=this.projectionMatrix,s=2/t,n=-t/t,r=2/(0-e),a=-e/(0-e);i._00=s,i._10=0,i._20=0,i._30=n,i._01=0,i._11=r,i._21=0,i._31=a,i._02=0,i._12=0,i._22=-.002000200020002,i._32=-1.0002000200020003,i._03=0,i._13=0,i._23=0,i._33=1}else if(T.get_nonPow2Supported()||(t=ue.upperPowerOfTwo(t),e=ue.upperPowerOfTwo(e)),this.g.renderTargetsInvertedY()){var o=this.projectionMatrix,l=2/t,h=-t/t,u=2/e,c=-e/e;o._00=l,o._10=0,o._20=0,o._30=h,o._01=0,o._11=u,o._21=0,o._31=c,o._02=0,o._12=0,o._22=-.002000200020002,o._32=-1.0002000200020003,o._03=0,o._13=0,o._23=0,o._33=1}else{var d=this.projectionMatrix,_=2/t,f=-t/t,g=2/(0-e),p=-e/(0-e);d._00=_,d._10=0,d._20=0,d._30=f,d._01=0,d._11=g,d._21=0,d._31=p,d._02=0,d._12=0,d._22=-.002000200020002,d._32=-1.0002000200020003,d._03=0,d._13=0,d._23=0,d._33=1}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,i){var s=this.coloredPainter;0<le.triangleBufferIndex&&s.drawTriBuffer(!1),0<le.bufferIndex&&s.drawBuffer(!1),this.textPainter.end();var n=e+t.get_width(),r=i+t.get_height(),a=this.transformations[this.transformations.length-1],o=e,l=r,h=a._02*o+a._12*l+a._22,u=(a._00*o+a._10*l+a._20)/h,c=(a._01*o+a._11*l+a._21)/h,d=this.transformations[this.transformations.length-1],_=e,f=i,g=d._02*_+d._12*f+d._22,p=(d._00*_+d._10*f+d._20)/g,v=(d._01*_+d._11*f+d._21)/g,m=this.transformations[this.transformations.length-1],w=n,b=i,S=m._02*w+m._12*b+m._22,y=(m._00*w+m._10*b+m._20)/S,x=(m._01*w+m._11*b+m._21)/S,E=this.transformations[this.transformations.length-1],C=n,k=r,T=E._02*C+E._12*k+E._22,L=(E._00*C+E._10*k+E._20)/T,B=(E._01*C+E._11*k+E._21)/T,I=this.imagePainter,N=this.get_opacity(),A=this.get_color(),R=t;(1500<=oe.bufferIndex+1||null!=oe.lastTexture&&R!=oe.lastTexture)&&I.drawBuffer();var P=.00392156862745098*((16711680&A)>>>16),V=.00392156862745098*((65280&A)>>>8),D=.00392156862745098*(255&A),O=.00392156862745098*(A>>>24)*N,M=9*oe.bufferIndex*4;oe.rectVertices[M+5]=P,oe.rectVertices[M+6]=V,oe.rectVertices[M+7]=D,oe.rectVertices[M+8]=O,oe.rectVertices[M+14]=P,oe.rectVertices[M+15]=V,oe.rectVertices[M+16]=D,oe.rectVertices[M+17]=O,oe.rectVertices[M+23]=P,oe.rectVertices[M+24]=V,oe.rectVertices[M+25]=D,oe.rectVertices[M+26]=O,oe.rectVertices[M+32]=P,oe.rectVertices[M+33]=V,oe.rectVertices[M+34]=D,oe.rectVertices[M+35]=O;var F=R.get_width()/R.get_realWidth(),W=R.get_height()/R.get_realHeight(),H=9*oe.bufferIndex*4;oe.rectVertices[H+3]=0,oe.rectVertices[H+4]=W,oe.rectVertices[H+12]=0,oe.rectVertices[H+13]=0,oe.rectVertices[H+21]=F,oe.rectVertices[H+22]=0,oe.rectVertices[H+30]=F,oe.rectVertices[H+31]=W;var U=9*oe.bufferIndex*4;oe.rectVertices[U]=u,oe.rectVertices[U+1]=c,oe.rectVertices[U+2]=-5,oe.rectVertices[U+9]=p,oe.rectVertices[U+10]=v,oe.rectVertices[U+11]=-5,oe.rectVertices[U+18]=y,oe.rectVertices[U+19]=x,oe.rectVertices[U+20]=-5,oe.rectVertices[U+27]=L,oe.rectVertices[U+28]=B,oe.rectVertices[U+29]=-5,++oe.bufferIndex,oe.lastTexture=R},drawScaledSubImage:function(t,e,i,s,n,r,a,o,l){var h=this.coloredPainter;0<le.triangleBufferIndex&&h.drawTriBuffer(!1),0<le.bufferIndex&&h.drawBuffer(!1),this.textPainter.end();var u=this.transformations[this.transformations.length-1],c=r,d=a+l,_=u._02*c+u._12*d+u._22,f=(u._00*c+u._10*d+u._20)/_,g=(u._01*c+u._11*d+u._21)/_,p=this.transformations[this.transformations.length-1],v=r,m=a,w=p._02*v+p._12*m+p._22,b=(p._00*v+p._10*m+p._20)/w,S=(p._01*v+p._11*m+p._21)/w,y=this.transformations[this.transformations.length-1],x=r+o,E=a,C=y._02*x+y._12*E+y._22,k=(y._00*x+y._10*E+y._20)/C,T=(y._01*x+y._11*E+y._21)/C,L=this.transformations[this.transformations.length-1],B=r+o,I=a+l,N=L._02*B+L._12*I+L._22,A=(L._00*B+L._10*I+L._20)/N,R=(L._01*B+L._11*I+L._21)/N,P=this.imagePainter,V=this.get_opacity(),D=this.get_color(),O=t;(1500<=oe.bufferIndex+1||null!=oe.lastTexture&&O!=oe.lastTexture)&&P.drawBuffer();var M=e/O.get_realWidth(),F=i/O.get_realHeight(),W=(e+s)/O.get_realWidth(),H=(i+n)/O.get_realHeight(),U=9*oe.bufferIndex*4;oe.rectVertices[U+3]=M,oe.rectVertices[U+4]=H,oe.rectVertices[U+12]=M,oe.rectVertices[U+13]=F,oe.rectVertices[U+21]=W,oe.rectVertices[U+22]=F,oe.rectVertices[U+30]=W,oe.rectVertices[U+31]=H;var G=.00392156862745098*((16711680&D)>>>16),X=.00392156862745098*((65280&D)>>>8),Y=.00392156862745098*(255&D),z=.00392156862745098*(D>>>24)*V,Z=9*oe.bufferIndex*4;oe.rectVertices[Z+5]=G,oe.rectVertices[Z+6]=X,oe.rectVertices[Z+7]=Y,oe.rectVertices[Z+8]=z,oe.rectVertices[Z+14]=G,oe.rectVertices[Z+15]=X,oe.rectVertices[Z+16]=Y,oe.rectVertices[Z+17]=z,oe.rectVertices[Z+23]=G,oe.rectVertices[Z+24]=X,oe.rectVertices[Z+25]=Y,oe.rectVertices[Z+26]=z,oe.rectVertices[Z+32]=G,oe.rectVertices[Z+33]=X,oe.rectVertices[Z+34]=Y,oe.rectVertices[Z+35]=z;var K=9*oe.bufferIndex*4;oe.rectVertices[K]=f,oe.rectVertices[K+1]=g,oe.rectVertices[K+2]=-5,oe.rectVertices[K+9]=b,oe.rectVertices[K+10]=S,oe.rectVertices[K+11]=-5,oe.rectVertices[K+18]=k,oe.rectVertices[K+19]=T,oe.rectVertices[K+20]=-5,oe.rectVertices[K+27]=A,oe.rectVertices[K+28]=R,oe.rectVertices[K+29]=-5,++oe.bufferIndex,oe.lastTexture=O},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,i,s,n){null==n&&(n=1),this.imagePainter.end(),this.textPainter.end();var r=this.transformations[this.transformations.length-1],a=t-n/2,o=e+n/2,l=r._02*a+r._12*o+r._22,h=(r._00*a+r._10*o+r._20)/l,u=(r._01*a+r._11*o+r._21)/l,c=new Pe(h,u),d=this.transformations[this.transformations.length-1],_=t-n/2,f=e-n/2,g=d._02*_+d._12*f+d._22,p=(d._00*_+d._10*f+d._20)/g,v=(d._01*_+d._11*f+d._21)/g,m=new Pe(p,v),w=this.transformations[this.transformations.length-1],b=t+i+n/2,S=e-n/2,y=w._02*b+w._12*S+w._22,x=(w._00*b+w._10*S+w._20)/y,E=(w._01*b+w._11*S+w._21)/y,C=new Pe(x,E),k=this.transformations[this.transformations.length-1],T=t+i+n/2,L=e+n/2,B=k._02*T+k._12*L+k._22,I=(k._00*T+k._10*L+k._20)/B,N=(k._01*T+k._11*L+k._21)/B,A=new Pe(I,N);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,m.x,m.y,C.x,C.y,A.x,A.y);var R=this.transformations[this.transformations.length-1],P=t-n/2,V=e+s-n/2,D=R._02*P+R._12*V+R._22,O=(R._00*P+R._10*V+R._20)/D,M=(R._01*P+R._11*V+R._21)/D;c=new Pe(O,M);var F=this.transformations[this.transformations.length-1],W=t-n/2,H=e+n/2,U=F._02*W+F._12*H+F._22,G=(F._00*W+F._10*H+F._20)/U,X=(F._01*W+F._11*H+F._21)/U;m=new Pe(G,X);var Y=this.transformations[this.transformations.length-1],z=t+n/2,Z=e+n/2,K=Y._02*z+Y._12*Z+Y._22,j=(Y._00*z+Y._10*Z+Y._20)/K,J=(Y._01*z+Y._11*Z+Y._21)/K;C=new Pe(j,J);var Q=this.transformations[this.transformations.length-1],q=t+n/2,$=e+s-n/2,tt=Q._02*q+Q._12*$+Q._22,et=(Q._00*q+Q._10*$+Q._20)/tt,it=(Q._01*q+Q._11*$+Q._21)/tt;A=new Pe(et,it),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,m.x,m.y,C.x,C.y,A.x,A.y);var st=this.transformations[this.transformations.length-1],nt=t-n/2,rt=e+s+n/2,at=st._02*nt+st._12*rt+st._22,ot=(st._00*nt+st._10*rt+st._20)/at,lt=(st._01*nt+st._11*rt+st._21)/at;c=new Pe(ot,lt);var ht=this.transformations[this.transformations.length-1],ut=t-n/2,ct=e+s-n/2,dt=ht._02*ut+ht._12*ct+ht._22,_t=(ht._00*ut+ht._10*ct+ht._20)/dt,ft=(ht._01*ut+ht._11*ct+ht._21)/dt;m=new Pe(_t,ft);var gt=this.transformations[this.transformations.length-1],pt=t+i+n/2,vt=e+s-n/2,mt=gt._02*pt+gt._12*vt+gt._22,wt=(gt._00*pt+gt._10*vt+gt._20)/mt,bt=(gt._01*pt+gt._11*vt+gt._21)/mt;C=new Pe(wt,bt);var St=this.transformations[this.transformations.length-1],yt=t+i+n/2,xt=e+s+n/2,Et=St._02*yt+St._12*xt+St._22,Ct=(St._00*yt+St._10*xt+St._20)/Et,kt=(St._01*yt+St._11*xt+St._21)/Et;A=new Pe(Ct,kt),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,m.x,m.y,C.x,C.y,A.x,A.y);var Tt=this.transformations[this.transformations.length-1],Lt=t+i-n/2,Bt=e+s-n/2,It=Tt._02*Lt+Tt._12*Bt+Tt._22,Nt=(Tt._00*Lt+Tt._10*Bt+Tt._20)/It,At=(Tt._01*Lt+Tt._11*Bt+Tt._21)/It;c=new Pe(Nt,At);var Rt=this.transformations[this.transformations.length-1],Pt=t+i-n/2,Vt=e+n/2,Dt=Rt._02*Pt+Rt._12*Vt+Rt._22,Ot=(Rt._00*Pt+Rt._10*Vt+Rt._20)/Dt,Mt=(Rt._01*Pt+Rt._11*Vt+Rt._21)/Dt;m=new Pe(Ot,Mt);var Ft=this.transformations[this.transformations.length-1],Wt=t+i+n/2,Ht=e+n/2,Ut=Ft._02*Wt+Ft._12*Ht+Ft._22,Gt=(Ft._00*Wt+Ft._10*Ht+Ft._20)/Ut,Xt=(Ft._01*Wt+Ft._11*Ht+Ft._21)/Ut;C=new Pe(Gt,Xt);var Yt=this.transformations[this.transformations.length-1],zt=t+i+n/2,Zt=e+s-n/2,Kt=Yt._02*zt+Yt._12*Zt+Yt._22,jt=(Yt._00*zt+Yt._10*Zt+Yt._20)/Kt,Jt=(Yt._01*zt+Yt._11*Zt+Yt._21)/Kt;A=new Pe(jt,Jt),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),c.x,c.y,m.x,m.y,C.x,C.y,A.x,A.y)},fillRect:function(t,e,i,s){this.imagePainter.end(),this.textPainter.end();var n=this.transformations[this.transformations.length-1],r=t,a=e+s,o=n._02*r+n._12*a+n._22,l=(n._00*r+n._10*a+n._20)/o,h=(n._01*r+n._11*a+n._21)/o,u=this.transformations[this.transformations.length-1],c=t,d=e,_=u._02*c+u._12*d+u._22,f=(u._00*c+u._10*d+u._20)/_,g=(u._01*c+u._11*d+u._21)/_,p=this.transformations[this.transformations.length-1],v=t+i,m=e,w=p._02*v+p._12*m+p._22,b=(p._00*v+p._10*m+p._20)/w,S=(p._01*v+p._11*m+p._21)/w,y=this.transformations[this.transformations.length-1],x=t+i,E=e+s,C=y._02*x+y._12*E+y._22,k=(y._00*x+y._10*E+y._20)/C,T=(y._01*x+y._11*E+y._21)/C;this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),l,h,f,g,b,S,k,T)},drawString:function(t,e,i){this.imagePainter.end();var s=this.coloredPainter;0<le.triangleBufferIndex&&s.drawTriBuffer(!1),0<le.bufferIndex&&s.drawBuffer(!1),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,i,this.transformations[this.transformations.length-1])},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return Mt.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,i,s,n){var r;null==n&&(n=1),this.imagePainter.end(),this.textPainter.end(),(r=s==e?new Pe(0,-1):new Pe(1,-(i-t)/(s-e))).set_length(n);var a=new Pe(t+.5*r.x,e+.5*r.y),o=new Pe(i+.5*r.x,s+.5*r.y),l=new Pe(a.x-r.x,a.y-r.y),h=new Pe(o.x-r.x,o.y-r.y),u=this.transformations[this.transformations.length-1],c=u._02*a.x+u._12*a.y+u._22,d=(u._00*a.x+u._10*a.y+u._20)/c,_=(u._01*a.x+u._11*a.y+u._21)/c;a=new Pe(d,_);var f=this.transformations[this.transformations.length-1],g=f._02*o.x+f._12*o.y+f._22,p=(f._00*o.x+f._10*o.y+f._20)/g,v=(f._01*o.x+f._11*o.y+f._21)/g;o=new Pe(p,v);var m=this.transformations[this.transformations.length-1],w=m._02*l.x+m._12*l.y+m._22,b=(m._00*l.x+m._10*l.y+m._20)/w,S=(m._01*l.x+m._11*l.y+m._21)/w;l=new Pe(b,S);var y=this.transformations[this.transformations.length-1],x=y._02*h.x+y._12*h.y+y._22,E=(y._00*h.x+y._10*h.y+y._20)/x,C=(y._01*h.x+y._11*h.y+y._21)/x;h=new Pe(E,C),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),a.x,a.y,o.x,o.y,l.x,l.y),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),l.x,l.y,o.x,o.y,h.x,h.y)},fillTriangle:function(t,e,i,s,n,r){this.imagePainter.end(),this.textPainter.end();var a=this.transformations[this.transformations.length-1],o=t,l=e,h=a._02*o+a._12*l+a._22,u=(a._00*o+a._10*l+a._20)/h,c=(a._01*o+a._11*l+a._21)/h,d=this.transformations[this.transformations.length-1],_=i,f=s,g=d._02*_+d._12*f+d._22,p=(d._00*_+d._10*f+d._20)/g,v=(d._01*_+d._11*f+d._21)/g,m=this.transformations[this.transformations.length-1],w=n,b=r,S=m._02*w+m._12*b+m._22,y=(m._00*w+m._10*b+m._20)/S,x=(m._01*w+m._11*b+m._21)/S;this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),u,c,p,v,y,x)},myImageScaleQuality:null,set_imageScaleQuality:function(t){return this.imagePainter.setBilinearFilter(t==Wt.High),this.textPainter.setBilinearFilter(t==Wt.High),this.myImageScaleQuality=t},begin:function(t,e){if(null==t&&(t=!0),null!=ue.current)throw new zt("End before you begin");(ue.current=this).g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end();var t=this.coloredPainter;0<le.triangleBufferIndex&&t.drawTriBuffer(!1),0<le.bufferIndex&&t.drawBuffer(!1)},end:function(){if(this.flush(),this.g.end(),ue.current!=this)throw new zt("Begin before you end");ue.current=null},__class__:ue});var ce=function(t,e,i){null==i&&(i=!1),this.indexCount=t,this.buffer=Krom.createIndexBuffer(t)};(s["kha.graphics4.IndexBuffer"]=ce).__name__=!0,ce.prototype={buffer:null,_data:null,indexCount:null,lock:function(t,e){return this._data=Krom.lockIndexBuffer(this.buffer),null==t&&(t=0),null==e&&(e=this.indexCount),this._data.subarray(t,t+e)},unlock:function(){Krom.unlockIndexBuffer(this.buffer)},set:function(){Krom.setIndexBuffer(this.buffer)},__class__:ce};var de=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=2,this.depthWrite=!1,this.depthMode=0,this.stencilMode=0,this.stencilBothPass=0,this.stencilDepthFail=0,this.stencilFail=0,this.stencilReferenceValue=fe.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=1,this.blendDestination=2,this.blendOperation=0,this.alphaBlendSource=1,this.alphaBlendDestination=2,this.alphaBlendOperation=0,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};(s["kha.graphics4.PipelineStateBase"]=de).__name__=!0,de.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,conservativeRasterization:null,__class__:de};var _e=function(){de.call(this),this.pipeline=Krom.createPipeline()};(s["kha.graphics4.PipelineState"]=_e).__name__=!0,_e.convertCullMode=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2}},_e.convertCompareMode=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7}},_e.convertStencilAction=function(t){switch(t){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 7}},_e.convertBlendingFactor=function(t){switch(t){case 0:case 1:return 0;case 2:return 1;case 3:return 2;case 4:return 3;case 5:return 4;case 6:return 5;case 7:return 6;case 8:return 7;case 9:return 8;case 10:return 9}},_e.__super__=de,_e.prototype=r(de.prototype,{pipeline:null,compile:function(){var t=0<this.inputLayout.length?this.inputLayout[0]:null,e=1<this.inputLayout.length?this.inputLayout[1]:null,i=2<this.inputLayout.length?this.inputLayout[2]:null,s=3<this.inputLayout.length?this.inputLayout[3]:null,n=null!=this.geometryShader?this.geometryShader.shader:null,r=null!=this.tessellationControlShader?this.tessellationControlShader.shader:null,a=null!=this.tessellationEvaluationShader?this.tessellationEvaluationShader.shader:null,o=0,l=this.stencilReferenceValue;1==l._hx_index&&(o=l.value);Krom.compilePipeline(this.pipeline,t,e,i,s,this.inputLayout.length,this.vertexShader.shader,this.fragmentShader.shader,n,r,a,{cullMode:_e.convertCullMode(this.cullMode),depthWrite:this.depthWrite,depthMode:_e.convertCompareMode(this.depthMode),stencilMode:_e.convertCompareMode(this.stencilMode),stencilBothPass:_e.convertStencilAction(this.stencilBothPass),stencilDepthFail:_e.convertStencilAction(this.stencilDepthFail),stencilFail:_e.convertStencilAction(this.stencilFail),stencilReferenceValue:o,stencilReadMask:this.stencilReadMask,stencilWriteMask:this.stencilWriteMask,blendSource:_e.convertBlendingFactor(this.blendSource),blendDestination:_e.convertBlendingFactor(this.blendDestination),alphaBlendSource:_e.convertBlendingFactor(this.alphaBlendSource),alphaBlendDestination:_e.convertBlendingFactor(this.alphaBlendDestination),colorWriteMaskRed:this.colorWriteMasksRed,colorWriteMaskGreen:this.colorWriteMasksGreen,colorWriteMaskBlue:this.colorWriteMasksBlue,colorWriteMaskAlpha:this.colorWriteMasksAlpha,conservativeRasterization:this.conservativeRasterization})},set:function(){Krom.setPipeline(this.pipeline)},getConstantLocation:function(t){return Krom.getConstantLocation(this.pipeline,t)},getTextureUnit:function(t){return Krom.getTextureUnit(this.pipeline,t)},__class__:_e});var fe=b["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:n},Static:(i=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:n}},i.__params__=["value"],i)},ge=function(t,e){this.shader=Krom.createTessellationControlShader(t[0].bytes.b.bufferValue,e[0])};(s["kha.graphics4.TessellationControlShader"]=ge).__name__=!0,ge.prototype={shader:null,__class__:ge};var pe=function(t,e){this.shader=Krom.createTessellationEvaluationShader(t[0].bytes.b.bufferValue,e[0])};(s["kha.graphics4.TessellationEvaluationShader"]=pe).__name__=!0,pe.prototype={shader:null,__class__:pe};var ve=function(){};(s["kha.graphics4.TextureUnit"]=ve).__name__=!0;var me=function(t,e,i,s,n){null==n&&(n=!1),null==s&&(s=0),this.vertexCount=t,this.structure=e,this.buffer=Krom.createVertexBuffer(t,e.elements,i,s)};(s["kha.graphics4.VertexBuffer"]=me).__name__=!0,me.prototype={buffer:null,_data:null,vertexCount:null,structure:null,lock:function(t,e){return this._data=Krom.lockVertexBuffer(this.buffer),this._data},unlock:function(){Krom.unlockVertexBuffer(this.buffer)},set:function(t){return Krom.setVertexBuffer(this.buffer),0},__class__:me};var we=function(t,e){this.name=t,this.data=e};(s["kha.graphics4.VertexElement"]=we).__name__=!0,we.prototype={name:null,data:null,__class__:we};var be=function(t,e){null!=t&&(this.shader=Krom.createVertexShader(t[0].bytes.b.bufferValue,e[0]))};(s["kha.graphics4.VertexShader"]=be).__name__=!0,be.prototype={shader:null,__class__:be};var Se=function(){this.elements=[],this.instanced=!1};(s["kha.graphics4.VertexStructure"]=Se).__name__=!0,Se.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new we(t,e))},size:function(){return this.elements.length},get:function(t){return this.elements[t]},__class__:Se};var ye=function(){};(s["kha.graphics5.Graphics"]=ye).__name__=!0;var xe=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],xe.instances[t]=this};(s["kha.input.Gamepad"]=xe).__name__=!0,xe.get=function(t){return null==t&&(t=0),t>=xe.instances.length?null:xe.instances[t]},xe.notifyOnConnect=function(t,e){null!=t&&xe.connectListeners.push(t),null!=e&&xe.disconnectListeners.push(e)},xe.removeConnect=function(t,e){null!=t&&st.remove(xe.connectListeners,t),null!=e&&st.remove(xe.disconnectListeners,e)},xe.sendConnectEvent=function(t){xe.instances[t].connected=!0;for(var e=0,i=xe.connectListeners;e<i.length;){var s=i[e];++e,s(t)}},xe.sendDisconnectEvent=function(t){xe.instances[t].connected=!1;for(var e=0,i=xe.disconnectListeners;e<i.length;){var s=i[e];++e,s(t)}},xe.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},remove:function(t,e){null!=t&&st.remove(this.axisListeners,t),null!=e&&st.remove(this.buttonListeners,e)},axisListeners:null,buttonListeners:null,id:null,connected:null,get_id:function(){return M.getGamepadId(this.index)},sendAxisEvent:function(t,e){for(var i=0,s=this.axisListeners;i<s.length;){var n=s[i];++i,n(t,e)}},sendButtonEvent:function(t,e){for(var i=0,s=this.buttonListeners;i<s.length;){var n=s[i];++i,n(t,e)}},__class__:xe};var Ee=function(){this.__id=Ve.nextId++,this._inputBuffer=new ut(new ArrayBuffer(1))};(s["kha.netsync.Controller"]=Ee).__name__=!0,Ee.prototype={__id:null,_inputBuffer:null,__class__:Ee};var Ce=t.kha.input.Keyboard=function(){Ee.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Ce.instance=this};(s["kha.input.Keyboard"]=Ce).__name__=!0,Ce.get=function(t){return null==t&&(t=0),M.getKeyboard(t)},Ce.__super__=Ee,Ce.prototype=r(Ee.prototype,{notify:function(t,e,i){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=i&&this.pressListeners.push(i)},remove:function(t,e,i){null!=t&&st.remove(this.downListeners,t),null!=e&&st.remove(this.upListeners,e),null!=i&&st.remove(this.pressListeners,i)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){for(var e=0,i=this.downListeners;e<i.length;){var s=i[e];++e,s(t)}},sendUpEvent:function(t){for(var e=0,i=this.upListeners;e<i.length;){var s=i[e];++e,s(t)}},sendPressEvent:function(t){for(var e=0,i=this.pressListeners;e<i.length;){var s=i[e];++e,s(t)}},_receive:function(t){},__class__:Ce});var ke=t.kha.input.Mouse=function(){Ee.call(this),ke.instance=this};(s["kha.input.Mouse"]=ke).__name__=!0,ke.get=function(t){return null==t&&(t=0),M.getMouse(t)},ke.__super__=Ee,ke.prototype=r(Ee.prototype,{notify:function(t,e,i,s,n){this.notifyWindowed(0,t,e,i,s,n)},remove:function(t,e,i,s,n){this.removeWindowed(0,t,e,i,s,n)},notifyWindowed:function(t,e,i,s,n,r){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=i){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(i)}if(null!=s){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(s)}if(null!=n){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(n)}if(null!=r){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(r)}},removeWindowed:function(t,e,i,s,n,r){null!=e&&(null!=this.windowDownListeners?t<this.windowDownListeners.length?st.remove(this.windowDownListeners[t],e):j.trace('no downListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:110,className:"kha.input.Mouse",methodName:"removeWindowed"}):j.trace("no downListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:114,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=i&&(null!=this.windowUpListeners?t<this.windowUpListeners.length?st.remove(this.windowUpListeners[t],i):j.trace('no upListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:124,className:"kha.input.Mouse",methodName:"removeWindowed"}):j.trace("no upListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:128,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=s&&(null!=this.windowMoveListeners?t<this.windowMoveListeners.length?st.remove(this.windowMoveListeners[t],s):j.trace('no moveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:138,className:"kha.input.Mouse",methodName:"removeWindowed"}):j.trace("no moveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:142,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=n&&(null!=this.windowWheelListeners?t<this.windowWheelListeners.length?st.remove(this.windowWheelListeners[t],n):j.trace('no wheelListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:152,className:"kha.input.Mouse",methodName:"removeWindowed"}):j.trace("no wheelListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:156,className:"kha.input.Mouse",methodName:"removeWindowed"})),null!=r&&(null!=this.windowLeaveListeners?t<this.windowLeaveListeners.length?st.remove(this.windowLeaveListeners[t],r):j.trace('no leaveListeners for window "'+t+'" are registered',{fileName:"kha/input/Mouse.hx",lineNumber:166,className:"kha.input.Mouse",methodName:"removeWindowed"}):j.trace("no leaveListeners were ever registered",{fileName:"kha/input/Mouse.hx",lineNumber:170,className:"kha.input.Mouse",methodName:"removeWindowed"}))},lock:function(){},unlock:function(){},canLock:function(){return!1},isLocked:function(){return!1},notifyOnLockChange:function(t,e){},removeFromLockChange:function(t,e){},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=this.windowLeaveListeners)for(var e=0,i=this.windowLeaveListeners[t];e<i.length;){var s=i[e];++e,s()}},sendDownEvent:function(t,e,i,s){if(null!=this.windowDownListeners)for(var n=0,r=this.windowDownListeners[t];n<r.length;){var a=r[n];++n,a(e,i,s)}},sendUpEvent:function(t,e,i,s){if(null!=this.windowUpListeners)for(var n=0,r=this.windowUpListeners[t];n<r.length;){var a=r[n];++n,a(e,i,s)}},sendMoveEvent:function(t,e,i,s,n){if(null!=this.windowMoveListeners)for(var r=0,a=this.windowMoveListeners[t];r<a.length;){var o=a[r];++r,o(e,i,s,n)}},sendWheelEvent:function(t,e){if(null!=this.windowWheelListeners)for(var i=0,s=this.windowWheelListeners[t];i<s.length;){var n=s[i];++i,n(e)}},_receive:function(t){},__class__:ke});var Te=function(){ke.call(this)};(s["kha.input.MouseImpl"]=Te).__name__=!0,Te.__super__=ke,Te.prototype=r(ke.prototype,{lock:function(){M.lockMouse()},unlock:function(){M.unlockMouse()},canLock:function(){return M.canLockMouse()},isLocked:function(){return M.isMouseLocked()},notifyOnLockChange:function(t,e){M.notifyOfMouseLockChange(t,e)},removeFromLockChange:function(t,e){M.removeFromMouseLockChange(t,e)},hideSystemCursor:function(){M.hideSystemCursor()},showSystemCursor:function(){M.showSystemCursor()},_receive:function(t){},__class__:Te});var Le=function(){Le.instance=this};(s["kha.input.Pen"]=Le).__name__=!0,Le.prototype={windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,sendDownEvent:function(t,e,i,s){if(null!=this.windowDownListeners)for(var n=0,r=this.windowDownListeners[t];n<r.length;){var a=r[n];++n,a(e,i,s)}},sendUpEvent:function(t,e,i,s){if(null!=this.windowUpListeners)for(var n=0,r=this.windowUpListeners[t];n<r.length;){var a=r[n];++n,a(e,i,s)}},sendMoveEvent:function(t,e,i,s){if(null!=this.windowMoveListeners)for(var n=0,r=this.windowMoveListeners[t];n<r.length;){var a=r[n];++n,a(e,i,s)}},__class__:Le};var Be=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],Be.instance=this};(s["kha.input.Surface"]=Be).__name__=!0,Be.get=function(t){return null==t&&(t=0),0!=t?null:Be.instance},Be.prototype={notify:function(t,e,i){null!=t&&this.touchStartListeners.push(t),null!=e&&this.touchEndListeners.push(e),null!=i&&this.moveListeners.push(i)},remove:function(t,e,i){null!=t&&st.remove(this.touchStartListeners,t),null!=e&&st.remove(this.touchEndListeners,e),null!=i&&this.moveListeners.push(i)},touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,i){for(var s=0,n=this.touchStartListeners;s<n.length;){var r=n[s];++s,r(t,e,i)}},sendTouchEndEvent:function(t,e,i){for(var s=0,n=this.touchEndListeners;s<n.length;){var r=n[s];++s,r(t,e,i)}},sendMoveEvent:function(t,e,i){for(var s=0,n=this.moveListeners;s<n.length;){var r=n[s];++s,r(t,e,i)}},__class__:Be};var Ie=function(t){this.bytes=t};(s["kha.internal.BytesBlob"]=Ie).__name__=!0,Ie.__interfaces__=[C],Ie.fromBytes=function(t){return new Ie(t)},Ie.alloc=function(t){return new Ie(new ut(new ArrayBuffer(t)))},Ie.prototype={bytes:null,sub:function(t,e){return new Ie(this.bytes.sub(t,e))},get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.b[t]=e},readU8:function(t){var e=this.bytes.b[t];return++t,e},toString:function(){return this.bytes.toString()},__class__:Ie};var Ne=function(t){this.renderTarget=t};(s["kha.krom.Graphics"]=Ne).__name__=!0,Ne.__interfaces__=[re],Ne.prototype={renderTarget:null,begin:function(t){Krom.begin(this.renderTarget,t)},end:function(){Krom.end()},clear:function(t,e,i){var s=0;null!=t&&(s|=1),null!=e&&(s|=2),null!=i&&(s|=4),Krom.clear(s,null==t?0:t,e,i)},setVertexBuffer:function(t){t.set(0)},setIndexBuffer:function(t){t.set()},setTexture:function(t,e){null!=e&&(null!=e.texture_?Krom.setTexture(t,e.texture_):Krom.setRenderTarget(t,e.renderTarget_))},setTextureParameters:function(t,e,i,s,n,r){Krom.setTextureParameters(t,e,i,s,n,r)},setPipeline:function(t){t.set()},setMatrix:function(t,e){Ne.mat[0]=e._00,Ne.mat[1]=e._01,Ne.mat[2]=e._02,Ne.mat[3]=e._03,Ne.mat[4]=e._10,Ne.mat[5]=e._11,Ne.mat[6]=e._12,Ne.mat[7]=e._13,Ne.mat[8]=e._20,Ne.mat[9]=e._21,Ne.mat[10]=e._22,Ne.mat[11]=e._23,Ne.mat[12]=e._30,Ne.mat[13]=e._31,Ne.mat[14]=e._32,Ne.mat[15]=e._33,Krom.setMatrix(t,Ne.mat.buffer)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0),Krom.drawIndexedVertices(t,e)},renderTargetsInvertedY:function(){return Krom.renderTargetsInvertedY()},__class__:Ne};var Ae=function(t,e,i,s,n,r,a,o,l){this._00=t,this._10=e,this._20=i,this._01=s,this._11=n,this._21=r,this._02=a,this._12=o,this._22=l};(s["kha.math.FastMatrix3"]=Ae).__name__=!0,Ae.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:Ae};var Re=function(t,e,i,s,n,r,a,o,l,h,u,c,d,_,f,g){this._00=t,this._10=e,this._20=i,this._30=s,this._01=n,this._11=r,this._21=a,this._31=o,this._02=l,this._12=h,this._22=u,this._32=c,this._03=d,this._13=_,this._23=f,this._33=g};(s["kha.math.FastMatrix4"]=Re).__name__=!0,Re.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:Re};var Pe=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};(s["kha.math.FastVector2"]=Pe).__name__=!0,Pe.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=this.get_length();if(0==e)return 0;var i=t/e;return this.x*=i,this.y*=i,t},__class__:Pe};var Ve=function(){};(s["kha.netsync.ControllerBuilder"]=Ve).__name__=!0;var De=function(){};(s["kha.netsync.Session"]=De).__name__=!0,De.the=function(){return De.instance};var Oe=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.dragging=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.scrolling=!1,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};(s["zui.Handle"]=Oe).__name__=!0,Oe.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrolling:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragging:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(t,e){for(null==this.children&&(this.children=[]);this.children.length<=t;)this.children.push(null);return null==this.children[t]&&(this.children[t]=new Oe(e)),this.children[t]},__class__:Oe};var Me=function(){};(s["zui.Canvas"]=Me).__name__=!0,Me.draw=function(t,e,i){-1==Me.screenW&&(Me.screenW=gt.windowWidth(),Me.screenH=gt.windowHeight()),Me.events=[],(Me._ui=t).begin(i),t.g=i;for(var s=0,n=e.elements;s<n.length;){var r=n[s];++s,null==r.parent&&Me.drawElement(t,e,r)}return t.end(),Me.events},Me.drawElement=function(t,e,i,s,n){if(null==n&&(n=0),null==s&&(s=0),null!=i&&0!=i.visible){t._x=e.x+(i.x*Me._ui.SCALE|0)+(s*Me._ui.SCALE|0),t._y=e.y+(i.y*Me._ui.SCALE|0)+(n*Me._ui.SCALE|0),t._w=i.width*Me._ui.SCALE|0;var r=e.width*Me._ui.SCALE|0,a=e.height*Me._ui.SCALE|0;switch(i.anchor){case 1:t._x-=(r-Me.screenW)/2;break;case 2:t._x-=r-Me.screenW;break;case 3:t._y-=(a-Me.screenH)/2;break;case 4:t._x-=(r-Me.screenW)/2,t._y-=(a-Me.screenH)/2;break;case 5:t._x-=r-Me.screenW,t._y-=(a-Me.screenH)/2;break;case 6:t._y-=a-Me.screenH;break;case 7:t._x-=(r-Me.screenW)/2,t._y-=a-Me.screenH;break;case 8:t._x-=r-Me.screenW,t._y-=a-Me.screenH}var o=null!=i.rotation&&0!=i.rotation;switch(o&&t.g.pushRotation(i.rotation,t._x+(i.width*Me._ui.SCALE|0)/2,t._y+(i.height*Me._ui.SCALE|0)/2),i.type){case 0:var l=t.ops.font,h=t.fontSize,u=t.t.TEXT_COL;null!=i.asset&&at.endsWith(i.asset,".ttf")&&(t.ops.font=Me.getAsset(e,i.asset)),t.fontSize=i.height*Me._ui.SCALE|0,t.t.TEXT_COL=i.color,t.text(i.text),t.ops.font=l,t.fontSize=h,t.t.TEXT_COL=u;break;case 1:var c=Me.getAsset(e,i.asset),d=null!=i.asset&&at.endsWith(i.asset,".ttf");if(null!=c&&!d){t.imageScrollAlign=!1;var _=null!=i.color?i.color:-1;if(3==t.image(c,_,i.height*Me._ui.SCALE|0)){var f=i.event;null!=f&&""!=f&&Me.events.push(f)}t.imageScrollAlign=!0}break;case 2:var g=t.t.BUTTON_H;if(t.t.BUTTON_H=i.height*Me._ui.SCALE|0,t.button(i.text)){var p=i.event;null!=p&&""!=p&&Me.events.push(p)}t.t.BUTTON_H=g;break;case 3:break;case 6:t.check(Me.h.nest(i.id),i.text);break;case 7:t.inlineRadio(Me.h.nest(i.id),i.text.split(";"));break;case 8:t.combo(Me.h.nest(i.id),i.text.split(";"));break;case 9:var v=t.g.get_color();t.g.set_color(i.color),t.g.fillRect(t._x,t._y,t._w,i.height*Me._ui.SCALE|0),t.g.set_color(v);break;case 10:t.slider(Me.h.nest(i.id),i.text,0,1,!0);break;case 11:t.textInput(Me.h.nest(i.id),i.text)}if(null!=i.children)for(var m=0,w=i.children;m<w.length;){var b=w[m];++m,Me.drawElement(t,e,Me.elemById(e,b),i.x+s,i.y+n)}o&&t.g.popTransformation()}},Me.getAsset=function(t,e){for(var i=0,s=t.assets;i<s.length;){var n=s[i];if(++i,n.name==e)return Me.assetMap.h[n.id]}return null},Me.getElementId=function(t){if(-1==Me.elemId)for(var e=0,i=t.elements;e<i.length;){var s=i[e];++e,Me.elemId<s.id&&(Me.elemId=s.id)}return++Me.elemId},Me.getAssetId=function(t){if(-1==Me.assetId)for(var e=0,i=t.assets;e<i.length;){var s=i[e];++e,Me.assetId<s.id&&(Me.assetId=s.id)}return++Me.assetId},Me.elemById=function(t,e){for(var i=0,s=t.elements;i<s.length;){var n=s[i];if(++i,n.id==e)return n}return null};var Fe=function(){};(s["zui.Ext"]=Fe).__name__=!0,Fe.initPath=function(t,e){t.text="Windows"==e?"C:\\Users":"/"},Fe.fileBrowser=function(t,e,i){null==i&&(i=!1);var s="/",n="ls ",r=gt.get_systemId();"Windows"==r&&(n="dir /b ",i&&(n+="/ad "),s="\\",e.text=at.replace(e.text,"\\\\","\\"),e.text=at.replace(e.text,"\r","")),""==e.text&&Fe.initPath(e,r);var a="Windows"==r?Krom.savePath():"/tmp";a+=s+"dir.txt",e.text!=Fe.lastPath&&Krom.sysCommand(n+'"'+e.text+'" > "'+a+'"'),Fe.lastPath=e.text;var o=ut.ofData(Krom.loadBlob(a)).toString().split("\n"),l=e.text.indexOf("/"),h=e.text.indexOf("\\");(-1<l&&e.text.length-1>l||-1<h&&e.text.length-1>h)&&t.button("..",0)&&(e.text=e.text.substring(0,e.text.lastIndexOf(s)),2==e.text.length&&":"==e.text.charAt(1)&&(e.text+=s));for(var u=0;u<o.length;){var c=o[u];++u,""!=c&&"."!=c.charAt(0)&&(t.button(c,0)&&(e.text.charAt(e.text.length-1)!=s&&(e.text+=s),e.text+=c))}return e.text},Fe.colorWheel=function(t,e,i,s,n){null==n&&(n=!1),null==i&&(i=!1),null==s&&(s=t._w),Fe.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),Fe.ar);var r=Fe.ar[0],a=Fe.ar[1],o=Fe.ar[2],l=.00392156862745098*(e.color>>>24),h=t._x,u=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(s-=t.t.SCROLL_W*t.SCALE|0,h+=(t.t.SCROLL_W*t.SCALE|0)/2),t.image(t.ops.color_wheel,k.fromFloats(o,o,o));var c=h+s/2,d=u+(t._y-u)/2,_=.7*s,f=_/2,g=c,p=d+a*f,v=r*(2*Math.PI),m=Math.cos(v)*(g-c)-Math.sin(v)*(p-d)+c,w=Math.sin(v)*(g-c)+Math.cos(v)*(p-d)+d;g=m,p=w,t.g.set_color(-16777216),t.g.fillRect(g-3,p-3,6,6),t.g.set_color(-1),t.g.fillRect(g-2,p-2,4,4),n&&(i?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var b=e.nest(0);b.value=Math.round(100*o)/100,o=t.slider(b,"Value",0,1,!0),i&&(l=t.slider(e.nest(1,{value:Math.round(100*l)/100}),"Alpha",0,1,!0));var S=c+t._windowX,y=d+t._windowY;if(t.inputStarted&&t.getInputInRect(S-f,y-f,_,_)&&(Fe.wheelSelectedHande=e),t.inputReleased&&(Fe.wheelSelectedHande=null),t.inputDown&&Fe.wheelSelectedHande==e){var x=S-t.inputX,E=y-t.inputY;a=Math.min(Math.sqrt(x*x+E*E),f)/f;var C=Math.atan2(t.inputX-S,t.inputY-y);C<0&&(C=Math.PI+(Math.PI-Math.abs(C))),r=(C=2*Math.PI-C)/(2*Math.PI),e.changed=t.changed=!0}return Fe.hsvToRgb(r,a,o,Fe.ar),e.color=k.fromFloats(Fe.ar[0],Fe.ar[1],Fe.ar[2],l),t.text("",2,e.color),e.color},Fe.hsvToRgb=function(t,e,i,s){var n=t+1,r=Math.abs(6*(n-(0|n))-3),a=t+.6666666666666666,o=Math.abs(6*(a-(0|a))-3),l=t+.3333333333333333,h=Math.abs(6*(l-(0|l))-3);s[0]=i*(1-e+Math.min(Math.max(r-1,0),1)*e),s[1]=i*(1-e+Math.min(Math.max(o-1,0),1)*e),s[2]=i*(1-e+Math.min(Math.max(h-1,0),1)*e)},Fe.rgbToHsv=function(t,e,i,s){var n=e<i?0:1,r=i*(1-n)+e*n,a=e<i?0:1,o=e*(1-a)+i*a,l=e<i?0:1,h=e<i?0:1,u=t<r?0:1,c=r*(1-u)+t*u,d=t<r?0:1,_=o*(1-d)+o*d,f=t<r?0:1,g=(.6666666666666666*(1-h)+-.3333333333333333*h)*(1-f)+(-1*(1-l)+0*l)*f,p=t<r?0:1,v=t*(1-p)+r*p,m=c-Math.min(v,_);s[0]=Math.abs(g+(v-_)/(6*m+1e-10)),s[1]=m/(c+1e-10),s[2]=c};var We=function(){};(s["zui.Themes"]=We).__name__=!0;var He=function(t){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.scrollingHandle=null,this.windowEnded=!0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.alwaysRedraw=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=We.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.scaleTexture&&(t.scaleTexture=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),this.bakeElements()};(s["zui.Zui"]=He).__name__=!0,He.prototype={isScrolling:null,isTyping:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,alwaysRedraw:null,imageInvertY:null,scrollEnabled:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputInitialX:null,inputInitialY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,key:null,char:null,cursorX:null,cursorY:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,globalG:null,t:null,SCALE:null,ops:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollingHandle:null,windowHeader:null,textSelectedHandle:null,textSelectedCurrentText:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipTime:null,tabNames:null,tabHandle:null,tabScroll:null,elementsBaked:null,checkSelectImage:null,setScale:function(t){this.ops.scaleFactor=t,this.SCALE=this.ops.scaleFactor*this.ops.scaleTexture,this.fontSize=this.t.FONT_SIZE*this.ops.scaleFactor|0;var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.t.ELEMENT_H*this.SCALE-e)/2,this.arrowOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.ARROW_SIZE*this.SCALE)/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.t.ARROW_SIZE*this.SCALE)/this.SCALE,this.buttonOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.BUTTON_H*this.SCALE)/2,this.checkOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.t.ELEMENT_H*this.SCALE-this.t.CHECK_SIZE*this.SCALE)/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.t.CHECK_SIZE*this.SCALE-this.t.CHECK_SELECT_SIZE*this.SCALE)/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=T.createRenderTarget(this.t.CHECK_SELECT_SIZE*this.SCALE|0,this.t.CHECK_SELECT_SIZE*this.SCALE|0,null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.SCALE),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.SCALE),t.end(),this.elementsBaked=!0},registerInput:function(){ke.get().notifyWindowed(this.ops.khaWindowId,Ge(this,this.onMouseDown),Ge(this,this.onMouseUp),Ge(this,this.onMouseMove),Ge(this,this.onMouseWheel)),Ce.get().notify(Ge(this,this.onKeyDown),Ge(this,this.onKeyUp),Ge(this,this.onKeyPress)),gt.notifyOnCutCopyPaste(Ge(this,this.onCut),Ge(this,this.onCopy),Ge(this,this.onPaste)),this.inputRegistered=!0},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),null!=this.comboSelectedHandle&&this.drawCombo(),t&&this.endInput(),null!=this.tabPressedHandle&&(this.tabPressedHandle=null)},endInput:function(){this.isKeyDown=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,He.textToPaste="",He.isCut=!1},beginLayout:function(t,e,i,s){this.elementsBaked||this.bakeElements(),this.currentWindow=null,this.g=t,this._windowX=0,this._windowY=0,this._windowW=s,this._x=e,this._y=i,this._w=s},endLayout:function(t){null==t&&(t=!0),t&&this.endInput()},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyDown},windowDirty:function(t,e,i,s,n){var r=e+t.dragX,a=i+t.dragY,o=this.getInputInRect(r,a,s,n)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||o},window:function(t,e,i,s,n,r){return null==r&&(r=!1),null!=t.texture&&s==t.texture.get_width()&&n==t.texture.get_height()||this.resize(t,s,n,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=i+t.dragY,this._windowW=s,this._windowH=n,this.windowHeader=0,this.windowDirty(t,e,i,s,n)&&(t.redraws=2),0!=t.redraws&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(s=this.t.ELEMENT_W*this.SCALE|0),this._w=t.scrollEnabled?s-(this.t.SCROLL_W*this.SCALE|0):s,this._h=n,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),(t.dragEnabled=r)&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?t.dragging=!0:this.inputReleased&&(t.dragging=!1),t.dragging&&(t.redraws=2,t.dragX+=0|this.inputDX,t.dragY+=0|this.inputDY),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(0<e.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var i=this._y-e.scrollOffset;if(i<this._windowH||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var s=i-this._windowH,n=-e.scrollOffset/s,r=this._windowH*Math.abs(this._windowH/i);r=Math.max(r,this.t.ELEMENT_H*this.SCALE);var a=this._windowH-r,o=s/a,l=a*n;this.inputStarted&&this.getInputInRect(this._windowX+this._windowW-(this.t.SCROLL_W*this.SCALE|0),l+this._windowY,this.t.SCROLL_W*this.SCALE|0,r)&&(e.scrolling=!0,this.scrollingHandle=e,this.isScrolling=!0),e.scrolling?this.scroll(this.inputDY*o,i):0!=this.inputWheelDelta&&this.scroll(this.inputWheelDelta*(this.t.ELEMENT_H*this.SCALE),i),0<e.scrollOffset?e.scrollOffset=0:i+e.scrollOffset<this._windowH&&(e.scrollOffset=this._windowH-i),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-(this.t.SCROLL_W*this.SCALE|0),this._windowY,this.t.SCROLL_W*this.SCALE|0,this._windowH),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this._windowW-(this.t.SCROLL_W*this.SCALE|0)-this.scrollAlign,l,this.t.SCROLL_W*this.SCALE|0,r)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawScaledImage(e.texture,this._windowX,this._windowY,e.texture.get_width()/this.ops.scaleTexture,e.texture.get_height()/this.ops.scaleTexture),""!=this.tooltipText||null!=this.tooltipImg?(this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=P.time()),P.time()-this.tooltipTime>this.t.TOOLTIP_DELAY&&(""!=this.tooltipText?this.drawTooltip():this.drawTooltipImage())):this.tooltipShown=!1,t&&this.globalG.end()}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},restoreX:null,restoreY:null,tab:function(t,e){null==this.tabNames&&(this.tabNames=[],this.tabHandle=t,this.windowHeader+=this.buttonOffsetY+this.t.BUTTON_H*this.SCALE,this.restoreX=this.inputX,this.restoreY=this.inputY,this.getInputInRect(this._windowX,this._windowY,this._windowW,this.windowHeader)&&(this.inputX=this.inputY=-1)),this.tabNames.push(e);var i=t.position==this.tabNames.length-1;return i&&this.endElement(),i},drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+this.t.BUTTON_H*this.SCALE),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+this.t.BUTTON_H*this.SCALE,this._windowW-2*this.buttonOffsetY,this.t.LINE_STRENGTH*this.SCALE);for(var i=0,s=this.tabNames.length;i<s;){var n=i++;this._x=t,this._w=this.ops.font.width(this.fontSize,this.tabNames[n])+2*this.buttonOffsetY+14*this.SCALE|0;var r=this.getReleased(),a=this.getPushed(),o=this.getHover();if(r){var l=this.tabHandle.nest(this.tabHandle.position);l.scrollOffset=this.currentWindow.scrollOffset,l=this.tabHandle.nest(n),this.tabScroll=l.scrollOffset,this.tabHandle.position=n,this.currentWindow.redraws=3}var h=this.tabHandle.position==n;this.g.set_color(a?this.t.ACCENT_HOVER_COL:o?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),t+=this._w+5;var u=this.g,c=this._x+this.buttonOffsetY,d=this._y+this.buttonOffsetY,_=this._w,f=this.t.BUTTON_H*this.SCALE,g=0;0==g&&(g=this.t.LINE_STRENGTH*this.SCALE),h?u.drawRect(c,d,_,f,g):u.fillRect(c,d,_,f),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,this.tabNames[n],this.t.TEXT_OFFSET,0,0),h&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+this.t.BUTTON_H*this.SCALE,this._w-1,this.t.LINE_STRENGTH*this.SCALE))}this._x=0,this._y=e,this._w=0|(this.currentWindow.scrollEnabled?this._windowW-(this.t.SCROLL_W*this.SCALE|0):this._windowW)}},panel:function(t,e,i,s){return null==s&&(s=!1),null==i&&(i=0),this.isVisible(this.t.ELEMENT_H*this.SCALE)&&(this.getReleased()&&(t.selected=!t.selected),0<i&&(this.g.set_color(this.t.PANEL_BG_COL),this.g.fillRect(this._x,this._y,this._w,this.t.ELEMENT_H*this.SCALE)),s?this.drawTree(t.selected):this.drawArrow(t.selected),this.g.set_color(this.t.PANEL_TEXT_COL),this.g.set_opacity(1),this.drawString(this.g,e,this.titleOffsetX,0)),this.endElement(),t.selected},image:function(t,e,i){null==e&&(e=-1);var s=t.get_width()*this.SCALE,n=t.get_height()*this.SCALE,r=Math.min(s,this._w),a=this._x;if(this.imageScrollAlign&&(r=Math.min(s,this._w-2*this.buttonOffsetY),a+=this.buttonOffsetY,!(null!=this.currentWindow&&this.currentWindow.scrollEnabled))){var o=-1==this.curRatio?1:this.ratios[this.curRatio];r-=(this.t.SCROLL_W*this.SCALE|0)*o,a+=(this.t.SCROLL_W*this.SCALE|0)*o/2}var l=null==i?r/s:i/n;if(null==i?i=n*l:r=s*l,!this.isVisible(i))return this.endElement(i),0;var h=this.getStarted(i),u=this.getPushed(i),c=this.getReleased(i);this.getHover();this.g.set_color(e);var d=i;return this.imageInvertY?this.g.drawScaledImage(t,a,this._y+d,r,-d):this.g.drawScaledImage(t,a,this._y,r,d),this.endElement(i),h?1:c?3:u?2:0},text:function(t,e,i){null==i&&(i=0),null==e&&(e=0),this.isVisible(this.t.ELEMENT_H*this.SCALE)&&(this.getReleased(),0!=i&&(this.g.set_color(i),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e)),this.endElement()},startTextEdit:function(t){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=t,this.textSelectedCurrentText=t.text,this.tabPressed=!1,this.tabPressedHandle=t,this.cursorX=t.text.length,this.cursorY=0,this.highlightAnchor=0,null!=Ce.get()&&Ce.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(t){null==t&&(t=0);var e=this.textSelectedCurrentText;this.isKeyDown&&(37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<e.length&&this.cursorX++:8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(e=st.substr(e,0,this.cursorX-1)+st.substr(e,this.cursorX,e.length),this.cursorX--):this.highlightAnchor<this.cursorX?(e=st.substr(e,0,this.highlightAnchor)+st.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=st.substr(e,0,this.cursorX)+st.substr(e,this.highlightAnchor,e.length):46==this.key?this.highlightAnchor==this.cursorX?e=st.substr(e,0,this.cursorX)+st.substr(e,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(e=st.substr(e,0,this.highlightAnchor)+st.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=st.substr(e,0,this.cursorX)+st.substr(e,this.highlightAnchor,e.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=e.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&null!=this.char&&""!=this.char&&32<=st.cca(this.char,0)&&127!=st.cca(this.char,0)&&(e=st.substr(e,0,this.highlightAnchor)+this.char+st.substr(e,this.cursorX,null),this.cursorX++),this.isShiftDown&&(37==this.key||39==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=He.textToPaste&&(e=st.substr(e,0,this.highlightAnchor)+He.textToPaste+st.substr(e,this.cursorX,null),this.cursorX+=He.textToPaste.length,this.highlightAnchor=this.cursorX,He.textToPaste=""),this.highlightAnchor==this.cursorX?He.textToCopy=e:this.highlightAnchor<this.cursorX?He.textToCopy=e.substring(this.highlightAnchor,this.cursorX):He.textToCopy=e.substring(this.cursorX,this.highlightAnchor),He.isCut&&(this.highlightAnchor==this.cursorX?e="":this.highlightAnchor<this.cursorX?(e=st.substr(e,0,this.highlightAnchor)+st.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=st.substr(e,0,this.cursorX)+st.substr(e,this.highlightAnchor,e.length));var i=this.t.TEXT_OFFSET,s=this.t.ELEMENT_H*this.SCALE,n=s-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var r=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(r=this.highlightAnchor,a=this.cursorX);var o=st.substr(e,r,a-r),l=this.g.get_font().width(this.g.get_fontSize(),o),h=this.g.get_font().width(this.g.get_fontSize(),st.substr(e,0,r)),u=0==t?this._x+h+i:this._x+this._w-l-i;2==t&&(u-=this.g.get_font().width(this.g.get_fontSize(),st.substr(e,a,e.length))),this.g.fillRect(u,this._y+this.cursorY*s+1.5*this.buttonOffsetY,l*this.SCALE,n)}if(P.time()%(2*this.t.FLASH_SPEED)<this.t.FLASH_SPEED){this.g.set_color(this.t.TEXT_COL);var c=0==t?st.substr(e,0,this.cursorX):e.substring(this.cursorX,e.length),d=this.g.get_font().width(this.g.get_fontSize(),c),_=0==t?this._x+d+i:this._x+this._w-d-i;this.g.fillRect(_,this._y+this.cursorY*s+1.5*this.buttonOffsetY,this.SCALE,n)}this.textSelectedCurrentText=e},textInput:function(t,e,i){if(null==i&&(i=0),null==e&&(e=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.text;var s=this.getHover();this.g.set_color(s?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var n=this.g,r=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY,l=this.t.BUTTON_H*this.SCALE,h=0;0==h&&(h=this.t.LINE_STRENGTH*this.SCALE),this.t.FILL_ACCENT_BG?n.fillRect(r,a,o,l):n.drawRect(r,a,o,l,h);var u=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&u&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(i),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var c=2==i?0:2,d=0==c?7:0;this.drawString(this.g,e,d,0,c)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,i):this.drawString(this.g,this.textSelectedCurrentText,null,0,i),this.endElement(),t.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=Ce.get()&&Ce.get().hide(),this.highlightAnchor=this.cursorX},button:function(t,e){if(null==e&&(e=1),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),!1;var i=this.getReleased(),s=this.getPushed(),n=this.getHover();this.g.set_color(s?this.t.BUTTON_PRESSED_COL:n?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL);var r=this.g,a=this._x+this.buttonOffsetY,o=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY,h=this.t.BUTTON_H*this.SCALE,u=0;return 0==u&&(u=this.t.LINE_STRENGTH*this.SCALE),this.t.FILL_BUTTON_BG?r.fillRect(a,o,l,h):r.drawRect(a,o,l,h,u),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.t.TEXT_OFFSET,0,e),this.endElement(),i},check:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawCheck(t.selected,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,i){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position==e;this.getReleased()?(t.position=e,t.changed=this.changed=!0):t.changed=!1;var s=this.getHover();return this.drawRadio(t.position==e,s),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,i,this.titleOffsetX,0),this.endElement(),t.position==e},inlineRadio:function(t,e){if(!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position;this.getReleased()?(++t.position>=e.length&&(t.position=0),t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawInlineRadio(e[t.position],i),this.endElement(),t.position},combo:function(t,e,i,s,n){if(null==n&&(n=0),null==s&&(s=!1),null==i&&(i=""),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.position;if(this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=n,this.comboSelectedTexts=e,this.comboSelectedLabel=i,this.comboSelectedX=this._x+this._windowX|0,this.comboSelectedY=this._y+this._windowY+this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE|0,this.comboSelectedW=0|this._w),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,this.getHover()){this.g.set_color(this.t.ACCENT_HOVER_COL);var r=this.g,a=this._x+this.buttonOffsetY,o=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY,h=this.t.BUTTON_H*this.SCALE,u=0;0==u&&(u=this.t.LINE_STRENGTH*this.SCALE),this.t.FILL_ACCENT_BG?r.fillRect(a,o,l,h):r.drawRect(a,o,l,h,u)}else{this.g.set_color(this.t.ACCENT_COL);var c=this.g,d=this._x+this.buttonOffsetY,_=this._y+this.buttonOffsetY,f=this._w-2*this.buttonOffsetY,g=this.t.BUTTON_H*this.SCALE,p=0;0==p&&(p=this.t.LINE_STRENGTH*this.SCALE),this.t.FILL_ACCENT_BG?c.fillRect(d,_,f,g):c.drawRect(d,_,f,g,p)}var v=this._x+this._w-this.arrowOffsetX-8,m=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(v,m,v+this.t.ARROW_SIZE*this.SCALE,m,v+this.t.ARROW_SIZE*this.SCALE/2,m+this.t.ARROW_SIZE*this.SCALE/2),this.g.set_color(this.t.TEXT_COL),s&&""!=i&&(0==n&&(this._x-=15),this.drawString(this.g,i,null,0,0==n?2:0),0==n&&(this._x+=15)),2==n&&(this._x-=15),this.drawString(this.g,e[t.position],null,0,n),2==n&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,i,s,n,r,a,o,l){if(null==l&&(l=!0),null==o&&(o=2),null==a&&(a=!0),null==r&&(r=100),null==n&&(n=!1),null==s&&(s=1),null==i&&(i=0),!this.isVisible(this.t.ELEMENT_H*this.SCALE))return this.endElement(),t.value;if(this.getStarted()&&(t.scrolling=!0,this.scrollingHandle=t,this.isScrolling=!0),t.changed=!1,t.scrolling){var h=s-i,u=this._x+this._windowX+this.buttonOffsetY,c=h/(this._w-2*this.buttonOffsetY),d=i+(this.inputX-u)*c;t.value=Math.round(d*r)/r,t.value<i?t.value=i:t.value>s&&(t.value=s),t.changed=this.changed=!0}var _=this.getHover();this.drawSlider(t.value,i,s,n,_),(this.getReleased()||this.tabPressed)&&l&&(t.text=t.value+"",this.startTextEdit(t));var f=0==o?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(f),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=parseFloat(t.text)),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,o),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,f):this.drawString(this.g,this.textSelectedCurrentText,null,0,f)),this.endElement(),t.value},drawArrow:function(t){var e=this._x+this.arrowOffsetX,i=this._y+this.arrowOffsetY;this.g.set_color(this.t.ARROW_COL),t?this.g.fillTriangle(e,i,e+this.t.ARROW_SIZE*this.SCALE,i,e+this.t.ARROW_SIZE*this.SCALE/2,i+this.t.ARROW_SIZE*this.SCALE):this.g.fillTriangle(e,i,e,i+this.t.ARROW_SIZE*this.SCALE,e+this.t.ARROW_SIZE*this.SCALE,i+this.t.ARROW_SIZE*this.SCALE/2)},drawTree:function(t){var e=this._x+this.arrowOffsetX+1,i=this._y+this.arrowOffsetY+1;this.g.set_color(this.t.ARROW_COL),t?this.g.fillRect(e,i+3.5-1,7,7/8):(this.g.fillRect(e,i+3.5-1,7,7/8),this.g.fillRect(e+3.5-1,i,7/8,7))},drawCheck:function(t,e){var i=this._x+this.checkOffsetX,s=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var n=this.g,r=this.t.CHECK_SIZE*this.SCALE,a=this.t.CHECK_SIZE*this.SCALE,o=0;0==o&&(o=this.t.LINE_STRENGTH*this.SCALE),this.t.FILL_ACCENT_BG?n.fillRect(i,s,r,a):n.drawRect(i,s,r,a,o),t&&(this.g.set_color(-1),this.g.drawImage(this.checkSelectImage,i+this.checkSelectOffsetX,s+this.checkSelectOffsetY))},drawRadio:function(t,e){var i=this._x+this.radioOffsetX,s=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var n=this.g,r=this.t.CHECK_SIZE*this.SCALE,a=this.t.CHECK_SIZE*this.SCALE,o=0;0==o&&(o=this.t.LINE_STRENGTH*this.SCALE),this.t.FILL_ACCENT_BG?n.fillRect(i,s,r,a):n.drawRect(i,s,r,a,o),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(i+this.radioSelectOffsetX,s+this.radioSelectOffsetY,this.t.CHECK_SELECT_SIZE*this.SCALE,this.t.CHECK_SELECT_SIZE*this.SCALE))},drawInlineRadio:function(t,e){e?(this.g.set_color(this.t.ACCENT_HOVER_COL),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)):(this.g.set_color(this.t.ACCENT_COL),this.g.drawRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.t.BUTTON_H*this.SCALE)),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.titleOffsetX,0,1)},drawSlider:function(t,e,i,s,n){var r=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY;this.g.set_color(n?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var l=this.g,h=this.t.BUTTON_H*this.SCALE,u=0;0==u&&(u=this.t.LINE_STRENGTH*this.SCALE),this.t.FILL_ACCENT_BG?l.fillRect(r,a,o,h):l.drawRect(r,a,o,h,u),this.g.set_color(n?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var c=(t-e)/(i-e),d=8*this.SCALE,_=s?r:r+(o-d)*c,f=s?o*c:d;f=Math.min(f,o),this.g.fillRect(_,a,f,this.t.BUTTON_H*this.SCALE)},drawCombo:function(){var t=this.g;this.globalG.set_color(-14540254);var e=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE;this.globalG.begin(!1),this.globalG.fillRect(this.comboSelectedX,this.comboSelectedY,this.comboSelectedW,(this.comboSelectedTexts.length+1)*e),this.beginLayout(this.globalG,this.comboSelectedX,this.comboSelectedY,this.comboSelectedW),this.inputEnabled=!0;for(var i=0,s=this.comboSelectedTexts.length;i<s;){var n=i++;if(this.button(this.comboSelectedTexts[n],this.comboSelectedAlign)){this.comboToSubmit=n,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.text(this.comboSelectedLabel),this.inputReleased&&!He.comboFirst?(this.comboSelectedHandle=null,He.comboFirst=!0):He.comboFirst=!1,this.inputEnabled=null==this.comboSelectedHandle,this.endLayout(!1),this.globalG.end(),this.g=t},drawTooltip:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,i=0;i<t.length;){var s=t[i];++i;var n=this.ops.font.width(this.fontSize,s);e<n&&(e=n)}this.tooltipX=Math.min(this.tooltipX,gt.windowWidth()-e-20),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.t.ELEMENT_H*this.SCALE*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var r=0,a=t.length;r<a;){var o=r++;this.globalG.drawString(t[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}},drawTooltipImage:function(){this.tooltipX=Math.min(this.tooltipX,gt.windowWidth()-this.tooltipImg.get_width()-20),this.globalG.set_color(-16777216),this.globalG.fillRect(this.tooltipX,this.tooltipY,this.tooltipImg.get_width(),this.tooltipImg.get_height()),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+this.tooltipImg.get_height(),this.tooltipImg.get_width(),-this.tooltipImg.get_height()):this.globalG.drawImage(this.tooltipImg,this.tooltipX,this.tooltipY)},drawString:function(t,e,i,s,n){null==n&&(n=0),null==s&&(s=0);var r=this._w/(this.fontSize/2|0)|0;e.length>r&&(e=e.substring(0,r)+".."),null==i&&(i=this.t.TEXT_OFFSET),i*=this.SCALE,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==n?i=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==n&&(i=this._w-this.ops.font.width(this.fontSize,e)-this.t.TEXT_OFFSET),t.drawString(e,this._x+i,this._y+this.fontOffsetY+s)},endElement:function(t){null!=this.currentWindow?0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(null==t&&(t=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE),this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=this.wBeforeSplit*this.ratios[this.curRatio]|0):this._x+=this._w+this.t.ELEMENT_OFFSET*this.SCALE:this._y+=this.t.ELEMENT_H*this.SCALE+this.t.ELEMENT_OFFSET*this.SCALE},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=this._w*t[this.curRatio]|0},indent:function(){this._x+=this.t.TAB_W*this.SCALE|0,this._w-=this.t.TAB_W*this.SCALE|0},unindent:function(){this._x-=this.t.TAB_W*this.SCALE|0,this._w+=this.t.TAB_W*this.SCALE|0},isVisible:function(t){return null==this.currentWindow||0<this._y+t&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.SCALE),!!(this.inputEnabled&&this.inputInitialX>=this._windowX+this._x&&this.inputInitialX<this._windowX+this._x+this._w&&this.inputInitialY>=this._windowY+this._y)&&this.inputInitialY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.t.ELEMENT_H*this.SCALE),this.isHovered=this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,i,s,n){return null==n&&(n=1),!!(this.inputEnabled&&this.inputX>=t*n&&this.inputX<(t+i)*n&&this.inputY>=e*n)&&this.inputY<(e+s)*n},onMouseDown:function(t,e,i){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0;var s=e*this.ops.scaleTexture|0,n=i*this.ops.scaleTexture|0;this.setInputPosition(s,n),this.inputInitialX=s,this.inputInitialY=n},onMouseUp:function(t,e,i){0==t?this.isScrolling?(this.isScrolling=!1,null!=this.scrollingHandle&&(this.scrollingHandle.scrolling=!1),e==this.inputInitialX&&i==this.inputInitialY&&(this.inputReleased=!0)):this.inputReleased=!0:1==t&&(this.inputReleasedR=!0),0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(e*this.ops.scaleTexture|0,i*this.ops.scaleTexture|0),this.deselectText()},onMouseMove:function(t,e,i,s){this.setInputPosition(t*this.ops.scaleTexture|0,e*this.ops.scaleTexture|0)},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyDown=!0,t){case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 32:this.char=" "}},onKeyUp:function(t){switch(t){case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1}},onKeyPress:function(t){this.char=t,this.isKeyDown=!0},onCut:function(){return He.isCut=!0,this.onCopy()},onCopy:function(){return He.textToCopy},onPaste:function(t){He.textToPaste=t},resize:function(t,e,i,s){null==s&&(s=0),t.redraws=2,null!=t.texture&&t.texture.unload(),t.texture=T.createRenderTarget(e,i,0,0,1,s),t.texture.get_g2().set_imageScaleQuality(Wt.High)},__class__:He};var Ue=0;function Ge(t,e){return null==e?null:(null==e.__id__&&(e.__id__=Ue++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=e.bind(t),t.hx__closures__[e.__id__]=i),i);var i}s.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=s.String=String,String.__name__=!0,s.Array=Array,Array.__name__=!0,Date.prototype.__class__=s.Date=Date,Date.__name__="Date";var Xe={},Ye={},ze=Number,Ze=Boolean,Ke={},je={};et.count=0;var Je={};Object.defineProperty(zt.prototype,"message",{get:function(){return String(this.val)}}),null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=p.sliceImpl),it.windowW=it.defaultWindowW=240,it.coffX=70,it.coffY=50,it.modalW=625,it.modalH=545,it.modalHeaderH=66,it.modalRectW=625,it.modalRectH=545,it.path="/",nt.cwd="",q.DEFAULT_RESOLVER=new o,q.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",f.helper=new DataView(new ArrayBuffer(8)),y.__toStr={}.toString,ft.images=new J,ft.sounds=new Q,ft.blobs=new lt,ft.fonts=new ht,ft.videos=new _t,k.Black=-16777216,k.White=-1,k.Red=-65536,k.Blue=-16776961,k.Green=-16711936,k.Magenta=-65281,k.Yellow=-256,k.Cyan=-16711681,k.Purple=-8388480,k.Pink=-16181,k.Orange=-23296,k.Transparent=0,k.invMaxChannelValue=.00392156862745098,m.displays=[],P.DIF_COUNT=3,P.maxframetime=.5,P.startTime=0,V.painter_colored_fragData0="s274:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IGZyYWdtZW50Q29sb3I7Cn0KCg",V.painter_colored_vertData0="s439:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",V.painter_image_fragData0="s506:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgppbiB2ZWMyIHRleENvb3JkOwppbiB2ZWM0IGNvbG9yOwpvdXQgdmVjNCBGcmFnQ29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZSh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgRnJhZ0NvbG9yID0gdGV4Y29sb3I7Cn0KCg",V.painter_image_vertData0="s508:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",V.painter_text_fragData0="s402:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgpvdXQgdmVjNCBGcmFnQ29sb3I7CmluIHZlYzQgZnJhZ21lbnRDb2xvcjsKaW4gdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIEZyYWdDb2xvciA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUodGV4LCB0ZXhDb29yZCkueCAqIGZyYWdtZW50Q29sb3Iudyk7Cn0KCg",V.painter_text_vertData0="s530:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",V.painter_video_fragData0="s506:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXg7CgppbiB2ZWMyIHRleENvb3JkOwppbiB2ZWM0IGNvbG9yOwpvdXQgdmVjNCBGcmFnQ29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZSh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgRnJhZ0NvbG9yID0gdGV4Y29sb3I7Cn0KCg",V.painter_video_vertData0="s508:I3ZlcnNpb24gMzMwCiNpZmRlZiBHTF9BUkJfc2hhZGluZ19sYW5ndWFnZV80MjBwYWNrCiNleHRlbnNpb24gR0xfQVJCX3NoYWRpbmdfbGFuZ3VhZ2VfNDIwcGFjayA6IHJlcXVpcmUKI2VuZGlmCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",gt.renderListeners=[],gt.dropFilesListeners=[],M.maxGamepads=4,M.mouseLockListeners=[],W.windows=[],yt.INVERSE_DB_TABLE=[1.0649863e-7,1.1341951e-7,1.2079015e-7,1.2863978e-7,1.3699951e-7,1.4590251e-7,1.5538408e-7,1.6548181e-7,1.7623575e-7,1.8768855e-7,1.9988561e-7,2.128753e-7,2.2670913e-7,2.4144197e-7,2.5713223e-7,2.7384213e-7,2.9163793e-7,3.1059021e-7,3.3077411e-7,3.5226968e-7,3.7516214e-7,3.9954229e-7,4.255068e-7,4.5315863e-7,4.8260743e-7,5.1396998e-7,5.4737065e-7,5.8294187e-7,6.2082472e-7,6.6116941e-7,7.0413592e-7,7.4989464e-7,7.9862701e-7,8.505263e-7,9.0579828e-7,9.6466216e-7,10273513e-13,10941144e-13,11652161e-13,12409384e-13,13215816e-13,14074654e-13,14989305e-13,15963394e-13,17000785e-13,18105592e-13,19282195e-13,20535261e-13,21869758e-13,23290978e-13,24804557e-13,26416497e-13,2813319e-12,29961443e-13,31908506e-13,33982101e-13,36190449e-13,38542308e-13,41047004e-13,4371447e-12,46555282e-13,49580707e-13,5280274e-12,5623416e-12,59888572e-13,63780469e-13,67925283e-13,72339451e-13,77040476e-13,82047e-10,87378876e-13,93057248e-13,99104632e-13,10554501e-12,11240392e-12,11970856e-12,12748789e-12,13577278e-12,14459606e-12,15399272e-12,16400004e-12,17465768e-12,18600792e-12,19809576e-12,21096914e-12,22467911e-12,23928002e-12,25482978e-12,27139006e-12,28902651e-12,30780908e-12,32781225e-12,34911534e-12,37180282e-12,39596466e-12,42169667e-12,4491009e-11,47828601e-12,50936773e-12,54246931e-12,57772202e-12,61526565e-12,65524908e-12,69783085e-12,74317983e-12,79147585e-12,8429104e-11,89768747e-12,95602426e-12,.00010181521,.00010843174,.00011547824,.00012298267,.00013097477,.00013948625,.00014855085,.00015820453,.00016848555,.00017943469,.00019109536,.00020351382,.00021673929,.00023082423,.00024582449,.00026179955,.00027881276,.00029693158,.00031622787,.00033677814,.00035866388,.00038197188,.00040679456,.00043323036,.00046138411,.00049136745,.00052329927,.00055730621,.00059352311,.00063209358,.00067317058,716917e-9,.0007635063,.00081312324,.00086596457,.00092223983,.00098217216,.0010459992,.0011139742,.0011863665,.0012634633,.0013455702,.0014330129,.0015261382,.0016253153,.0017309374,.0018434235,.0019632195,.0020908006,.0022266726,.0023713743,.0025254795,.0026895994,.0028643847,.0030505286,.0032487691,.0034598925,.0036847358,.0039241906,.0041792066,.004450795,.0047400328,.0050480668,.0053761186,.0057254891,.0060975636,.0064938176,.0069158225,.0073652516,.0078438871,.0083536271,.0088964928,.009474637,.010090352,.01074608,.011444421,.012188144,.012980198,.013823725,.014722068,.015678791,.016697687,.017782797,.018938423,.020169149,.021479854,.022875735,.02436233,.025945531,.027631618,.029427276,.031339626,.033376252,.035545228,.037855157,.040315199,.042935108,.045725273,.048696758,.051861348,.055231591,.05882085,.062643361,.066714279,.071049749,.075666962,.080584227,.085821044,.091398179,.097337747,.1036633,.11039993,.11757434,.12521498,.13335215,.14201813,.15124727,.16107617,.1715438,.18269168,.19456402,.20720788,.22067342,.23501402,.25028656,.26655159,.28387361,.30232132,.32196786,.34289114,.36517414,.38890521,.41417847,.44109412,.4697589,.50028648,.53279791,.56742212,.6042964,.64356699,.68538959,.72993007,.77736504,.8278826,.88168307,.9389798,1],Mt.fontGlyphs=function(t){for(var e=[],i=32;i<256;){var s=i++;e.push(s)}return e}(),xe.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},xe.instances=[],xe.connectListeners=[],xe.disconnectListeners=[],Ce.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},ke.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},Ne.mat=new Float32Array(16),Ve.nextId=0,Oe.global=new Oe,Me.assetMap=new $,Me.events=[],Me.screenW=-1,Me.screenH=-1,Me.h=new Oe,Me.elemId=-1,Me.assetId=-1,Fe.lastPath="",Fe.ar=[0,0,0],We.dark={FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:22,ELEMENT_OFFSET:2,ARROW_SIZE:5,BUTTON_H:17,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:8,TEXT_OFFSET:8,TAB_W:12,LINE_STRENGTH:1,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-14671840,WINDOW_TINT_COL:-1,ACCENT_COL:-12566464,ACCENT_HOVER_COL:-11513776,ACCENT_SELECT_COL:-10066330,PANEL_BG_COL:-16777216,PANEL_TEXT_COL:-1118482,BUTTON_COL:-13948117,BUTTON_TEXT_COL:-3487289,BUTTON_HOVER_COL:-12895429,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-3487289,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-14277082},We.light={FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:44,ELEMENT_OFFSET:4,ARROW_SIZE:10,BUTTON_H:34,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:16,TEXT_OFFSET:16,TAB_W:24,LINE_STRENGTH:2,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,PANEL_BG_COL:-1,PANEL_TEXT_COL:-14540254,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-6710887},He.textToPaste="",He.textToCopy="",He.isCut=!1,He.comboFirst=!0,nt.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);